/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/data/oldhome/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Namespace(mode='fast_slow_classify', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/dog120_all.yml', num_per_category='3', knowledge_base_dir='./knowledge_base', query_image=None, test_data_dir=None, results_out='./results.json', use_slow_thinking=None, confidence_threshold=0.8, similarity_threshold=0.7, enable_mllm_intermediate_judge=False, infer_dir='./experiments/dog120/infer', classify_dir='./experiments/dog120/classify')
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'dog', 'num_classes': 120, 'num_base': 60, 'num_novel': 60, 'seed': 1, 'batch_size': 256, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'OPT6.7B-COCO', 'model_size_mllm': 'Qwen2.5-VL-7B', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'xiao', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/dogs_120', 'expt_dir': './experiments/dog120', 'expt_dir_describe': './experiments/dog120/describe', 'path_vqa_questions': './experiments/dog120/describe/dog_vqa_questions_ours', 'path_vqa_answers': './experiments/dog120/describe/dog_attributes_pairs', 'path_llm_prompts': './experiments/dog120/describe/dog_llm_prompts', 'path_identify_answers': './experiments/dog120/identify', 'expt_dir_guess': './experiments/dog120/guess', 'path_llm_replies_raw': './experiments/dog120/guess/dog_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/dog120/guess/dog_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/dog120/guess/dog_llm_gussed_names', 'expt_dir_gallery': './experiments/dog120/gallery', 'path_references': './experiments/dog120/gallery/dog_image_references', 'path_regions': './experiments/dog120/gallery/dog_image_regions', 'path_descriptions': './experiments/dog120/gallery/dog_image_descriptions_attn', 'expt_dir_grouping': './experiments/dog120/grouping'}
ä»ç›®å½•åŠ è½½æ¨ç†ç»“æœ: ./experiments/dog120/infer
åˆ†ç±»ç»“æœå°†ä¿å­˜åˆ°: ./experiments/dog120/classify
åˆå§‹åŒ–çŸ¥è¯†åº“æ„å»ºå™¨...
ğŸš€ èåˆæ–¹æ³•ä¸º 'weighted'ï¼Œè·³è¿‡BLIPæ¨¡å‹åŠ è½½ä»¥èŠ‚çœæ˜¾å­˜
è·å–MLLMæ¨¡å‹å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰...
ğŸš€ åˆå§‹åŒ–MLLMæ¨¡å‹: Qwen2.5-VL-7B on cuda
ğŸ“Š å½“å‰æ˜¾å­˜: 0.56GB / 47.40GB
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [00:07<00:31,  7.98s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:15<00:23,  7.90s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:24<00:16,  8.05s/it]Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:15<00:49, 49.04s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:48<00:00, 43.25s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [02:48<00:00, 33.78s/it]
local_model_path: /home/Dataset/Models/Qwen/Qwen2.5-VL-7B-Instruct
âœ… MLLMæ¨¡å‹åˆå§‹åŒ–å®Œæˆ
ğŸ“Š åŠ è½½åæ˜¾å­˜: 31.59GB / 47.40GB
åˆå§‹åŒ–å¿«æ€è€ƒæ¨¡å—...
å·²åŠ è½½å†å²ç»Ÿè®¡é‡: 879 æ¬¡é¢„æµ‹
åˆå§‹åŒ–æ…¢æ€è€ƒæ¨¡å—...
å¿«æ…¢æ€è€ƒç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ!
ä» ./experiments/dog120/knowledge_base åŠ è½½çŸ¥è¯†åº“...
çŸ¥è¯†åº“å·²ä» ./experiments/dog120/knowledge_base åŠ è½½
çŸ¥è¯†åº“åŠ è½½å®Œæˆ!
å·²åŠ è½½çŸ¥è¯†åº“: ./experiments/dog120/knowledge_base
æ‰¾åˆ° 120 ä¸ªæ¨ç†ç»“æœæ–‡ä»¶
Processing classification:   0%|          | 0/120 [00:00<?, ?it/s]Processing classification:   1%|          | 1/120 [00:12<24:07, 12.17s/it]Processing classification:   2%|â–         | 2/120 [00:21<21:04, 10.71s/it]Processing classification:   3%|â–         | 4/120 [00:32<14:04,  7.28s/it]Processing classification:   8%|â–Š         | 9/120 [00:44<07:11,  3.89s/it]Processing classification:   9%|â–‰         | 11/120 [00:54<07:45,  4.27s/it]Processing classification:  10%|â–ˆ         | 12/120 [01:04<09:26,  5.24s/it]Processing classification:  12%|â–ˆâ–        | 14/120 [01:15<09:17,  5.26s/it]Processing classification:  12%|â–ˆâ–        | 15/120 [01:24<10:31,  6.01s/it]Processing classification:  13%|â–ˆâ–        | 16/120 [01:34<11:50,  6.83s/it]Processing classification:  14%|â–ˆâ–        | 17/120 [01:43<12:37,  7.36s/it]Processing classification:  15%|â–ˆâ–Œ        | 18/120 [01:53<13:48,  8.12s/it]Processing classification:  16%|â–ˆâ–Œ        | 19/120 [02:02<13:56,  8.28s/it]Processing classification:  17%|â–ˆâ–‹        | 20/120 [02:12<14:42,  8.83s/it]Processing classification:  18%|â–ˆâ–Š        | 21/120 [02:24<15:37,  9.47s/it]Processing classification:  18%|â–ˆâ–Š        | 22/120 [02:34<15:48,  9.68s/it]Processing classification:  19%|â–ˆâ–‰        | 23/120 [02:43<15:22,  9.51s/it]Processing classification:  22%|â–ˆâ–ˆâ–       | 26/120 [02:53<09:29,  6.06s/it]Processing classification:  23%|â–ˆâ–ˆâ–       | 28/120 [03:02<08:36,  5.61s/it]/tmp/run_discovery_dog_3879790.sh: line 2: 3879882 Killed                  python discovering.py --mode=fast_slow_classify --config_file_env=./configs/env_machine.yml --config_file_expt=./configs/expts/dog120_all.yml --infer_dir=./experiments/dog120/infer --classify_dir=./experiments/dog120/classify
