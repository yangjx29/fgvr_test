/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/data/oldhome/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Namespace(mode='terminal_decision', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/car196_all.yml', num_per_category='3', knowledge_base_dir='./knowledge_base', query_image=None, test_data_dir=None, results_out='./results.json', use_slow_thinking=None, confidence_threshold=0.8, similarity_threshold=0.7, enable_mllm_intermediate_judge=False, infer_dir='./experiments/car196/infer', classify_dir='./experiments/car196/classify')
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'car', 'num_classes': 196, 'num_base': 98, 'num_novel': 98, 'seed': 1, 'batch_size': 32, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'FlanT5-XXL', 'model_size_mllm': 'Qwen2.5-VL-7B', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'xiao', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/car_196', 'expt_dir': './experiments/car196', 'expt_dir_describe': './experiments/car196/describe', 'path_vqa_questions': './experiments/car196/describe/car_vqa_questions_ours', 'path_vqa_answers': './experiments/car196/describe/car_attributes_pairs', 'path_llm_prompts': './experiments/car196/describe/car_llm_prompts', 'path_identify_answers': './experiments/car196/identify', 'expt_dir_guess': './experiments/car196/guess', 'path_llm_replies_raw': './experiments/car196/guess/car_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/car196/guess/car_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/car196/guess/car_llm_gussed_names', 'expt_dir_gallery': './experiments/car196/gallery', 'path_references': './experiments/car196/gallery/car_image_references', 'path_regions': './experiments/car196/gallery/car_image_regions', 'path_descriptions': './experiments/car196/gallery/car_image_descriptions_attn', 'expt_dir_grouping': './experiments/car196/grouping'}
ä»ç›®å½•åŠ è½½æ¨ç†ç»“æœ: ./experiments/car196/infer
ç»ˆç«¯å†³ç­–ç»“æœå°†ä¿å­˜åˆ°: ./experiments/car196/classify
åŠ è½½äº† 87 ä¸ªå¿«æ€è€ƒåˆ†ç±»ç»“æœ
åŠ è½½äº† 109 ä¸ªæ…¢æ€è€ƒåˆ†ç±»ç»“æœ
å‘ç° 22 ä¸ªéœ€è¦ç»ˆç«¯å†³ç­–çš„æ ·æœ¬ï¼Œåˆå§‹åŒ–ç³»ç»Ÿ...
åˆå§‹åŒ–çŸ¥è¯†åº“æ„å»ºå™¨...
ğŸš€ èåˆæ–¹æ³•ä¸º 'weighted'ï¼Œè·³è¿‡BLIPæ¨¡å‹åŠ è½½ä»¥èŠ‚çœæ˜¾å­˜
è·å–MLLMæ¨¡å‹å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰...
ğŸš€ åˆå§‹åŒ–MLLMæ¨¡å‹: Qwen2.5-VL-7B on cuda
ğŸ“Š å½“å‰æ˜¾å­˜: 0.56GB / 79.25GB
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [00:02<00:09,  2.27s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:04<00:06,  2.30s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:07<00:04,  2.35s/it]Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:09<00:02,  2.36s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:10<00:00,  1.79s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:10<00:00,  2.03s/it]
local_model_path: ./models/Qwen/Qwen2.5-VL-7B-Instruct
âœ… MLLMæ¨¡å‹åˆå§‹åŒ–å®Œæˆ
ğŸ“Š åŠ è½½åæ˜¾å­˜: 31.59GB / 79.25GB
åˆå§‹åŒ–å¿«æ€è€ƒæ¨¡å—...
æœªæ‰¾åˆ°å†å²ç»Ÿè®¡é‡æ–‡ä»¶ï¼Œå°†ä»å¤´å¼€å§‹
åˆå§‹åŒ–æ…¢æ€è€ƒæ¨¡å—...
å¿«æ…¢æ€è€ƒç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ!
ä» ./experiments/car196/knowledge_base åŠ è½½çŸ¥è¯†åº“...
ç±»åˆ«å›¾åƒè·¯å¾„å·²ä» ./experiments/car196/knowledge_base/category_image_paths.json åŠ è½½
åŠ è½½äº† 255 ä¸ªç±»åˆ«çš„å›¾åƒè·¯å¾„
çŸ¥è¯†åº“å·²ä» ./experiments/car196/knowledge_base åŠ è½½
çŸ¥è¯†åº“åŠ è½½å®Œæˆ!
å·²åŠ è½½çŸ¥è¯†åº“: ./experiments/car196/knowledge_base
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/164.Mercedes-Benz_E-Class_Sedan_2012/164.Mercedes-Benz_E-Class_Sedan_2012_01820.jpg -> Mercedes-Benz E-Class Sedan 2012 (ç½®ä¿¡åº¦: 0.9000) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/123.Geo_Metro_Convertible_1993/123.Geo_Metro_Convertible_1993_00596.jpg -> Geo Metro Convertible 1993 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/163.Mercedes-Benz_SL-Class_Coupe_2009/163.Mercedes-Benz_SL-Class_Coupe_2009_02723.jpg -> Mercedes-Benz SL-Class Coupe 2009 (ç½®ä¿¡åº¦: 0.9000) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/058.Chevrolet_Traverse_SUV_2012/058.Chevrolet_Traverse_SUV_2012_00692.jpg -> Chevrolet Traverse SUV 2012 (ç½®ä¿¡åº¦: 0.9000) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/134.Hyundai_Sonata_Hybrid_Sedan_2012/134.Hyundai_Sonata_Hybrid_Sedan_2012_04907.jpg -> Hyundai Sonata Hybrid Sedan 2012 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/045.Bugatti_Veyron_16.4_Convertible_2009/045.Bugatti_Veyron_16.4_Convertible_2009_04334.jpg -> Bugatti Veyron 16 (ç½®ä¿¡åº¦: 0.9000) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/024.Audi_S4_Sedan_2007/024.Audi_S4_Sedan_2007_03892.jpg -> Audi S4 Sedan 2007 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/119.GMC_Savana_Van_2012/119.GMC_Savana_Van_2012_04214.jpg -> GMC Savana Van 2012 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/174.Ram_C_V_Cargo_Van_Minivan_2012/174.Ram_C_V_Cargo_Van_Minivan_2012_03611.jpg -> Chrysler Town and Country Minivan 2012 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/144.Jaguar_XK_XKR_2012/144.Jaguar_XK_XKR_2012_06238.jpg -> Jaguar XK XKR 2012 (ç½®ä¿¡åº¦: 0.9000) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/069.Chevrolet_Silverado_2500HD_Regular_Cab_2012/069.Chevrolet_Silverado_2500HD_Regular_Cab_2012_01736.jpg -> Chevrolet Silverado 2500HD Regular Cab 2012 (ç½®ä¿¡åº¦: 0.9000) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/062.Chevrolet_Tahoe_Hybrid_SUV_2012/062.Chevrolet_Tahoe_Hybrid_SUV_2012_00823.jpg -> Chevrolet Tahoe Hybrid SUV 2012 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/072.Chevrolet_Monte_Carlo_Coupe_2007/072.Chevrolet_Monte_Carlo_Coupe_2007_02459.jpg -> Chevrolet Monte Carlo Coupe 2007 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/092.Dodge_Magnum_Wagon_2008/092.Dodge_Magnum_Wagon_2008_07869.jpg -> Dodge Magnum Wagon 2008 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/004.Acura_TL_Type-S_2008/004.Acura_TL_Type-S_2008_02240.jpg -> Acura TL Type-S 2008 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: False
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/143.Isuzu_Ascender_SUV_2008/143.Isuzu_Ascender_SUV_2008_03587.jpg -> Isuzu Ascender SUV 2008 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/060.Chevrolet_HHR_SS_2010/060.Chevrolet_HHR_SS_2010_06779.jpg -> Chevrolet HHR SS 2010 (ç½®ä¿¡åº¦: 0.9500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/061.Chevrolet_Impala_Sedan_2007/061.Chevrolet_Impala_Sedan_2007_00676.jpg -> Chevrolet Impala Sedan 2007 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/176.Rolls-Royce_Ghost_Sedan_2012/176.Rolls-Royce_Ghost_Sedan_2012_03914.jpg -> Rolls-Royce Ghost Sedan 2012 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/155.Land_Rover_LR2_SUV_2012/155.Land_Rover_LR2_SUV_2012_03494.jpg -> Land Rover LR2 SUV 2012 (ç½®ä¿¡åº¦: 0.9500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/091.Dodge_Dakota_Club_Cab_2007/091.Dodge_Dakota_Club_Cab_2007_00287.jpg -> Dodge Dakota Club Cab 2007 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
ç»ˆç«¯å†³ç­–: ./datasets/car_196/images_discovery_all_1/159.Mazda_Tribute_SUV_2011/159.Mazda_Tribute_SUV_2011_04866.jpg -> Mazda Tribute SUV 2011 (ç½®ä¿¡åº¦: 0.8500) æ­£ç¡®: True
âœ… æ€»æ­£ç¡®é¢„æµ‹æ•°: 193
  - å…¶ä¸­ä»…å¿«æ€è€ƒæ­£ç¡®: 85
  - å…¶ä¸­æ…¢æ€è€ƒè§¦å‘ä¸”æ­£ç¡®: 108
âŒ æ€»é”™è¯¯é¢„æµ‹æ•°: 3
ğŸ“Š æ…¢æ€è€ƒè§¦å‘æ•°é‡: 109
[terminal_decision] æ€»ä½“å‡†ç¡®ç‡: 0.9847 (193/196)
[terminal_decision] å¿«æ€è€ƒå‡†ç¡®ç‡: 0.9770
[terminal_decision] æ…¢æ€è€ƒè§¦å‘æ¯”ä¾‹: 0.5561
[terminal_decision] æ…¢æ€è€ƒå‡†ç¡®ç‡: 0.9908
ç»ˆç«¯å†³ç­–ç»“æœå·²ä¿å­˜åˆ°: ./experiments/car196/classify/terminal_decision_results.json
æ€»è€—æ—¶: 00:05:34
