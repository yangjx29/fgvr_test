/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/data/oldhome/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Namespace(mode='fast_slow_classify', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/bird200_all.yml', num_per_category='3', knowledge_base_dir='./knowledge_base', query_image=None, test_data_dir=None, results_out='./results.json', use_slow_thinking=None, confidence_threshold=0.8, similarity_threshold=0.7, enable_mllm_intermediate_judge=False, infer_dir='./experiments/bird200/infer', classify_dir='./experiments/bird200/classify')
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'bird', 'num_classes': 200, 'num_base': 100, 'num_novel': 100, 'seed': 1, 'batch_size': 256, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'FlanT5-XXL', 'model_size_mllm': 'Qwen2.5-VL-7B', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'xiao', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/CUB_200_2011/CUB_200_2011/', 'expt_dir': './experiments/bird200', 'expt_dir_describe': './experiments/bird200/describe', 'path_vqa_questions': './experiments/bird200/describe/bird_vqa_questions_ours', 'path_vqa_answers': './experiments/bird200/describe/bird_attributes_pairs', 'path_llm_prompts': './experiments/bird200/describe/bird_llm_prompts', 'path_identify_answers': './experiments/bird200/identify', 'expt_dir_guess': './experiments/bird200/guess', 'path_llm_replies_raw': './experiments/bird200/guess/bird_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/bird200/guess/bird_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/bird200/guess/bird_llm_gussed_names', 'expt_dir_gallery': './experiments/bird200/gallery', 'path_references': './experiments/bird200/gallery/bird_image_references', 'path_regions': './experiments/bird200/gallery/bird_image_regions', 'path_descriptions': './experiments/bird200/gallery/bird_image_descriptions_attn', 'expt_dir_grouping': './experiments/bird200/grouping'}
å½“å‰æ—¶é—´ä¸ºï¼š 2025-11-01 10:23:53
ä»ç›®å½•åŠ è½½æ¨ç†ç»“æœ: ./experiments/bird200/infer
åˆ†ç±»ç»“æœå°†ä¿å­˜åˆ°: ./experiments/bird200/classify
åˆå§‹åŒ–çŸ¥è¯†åº“æ„å»ºå™¨...
ğŸš€ èåˆæ–¹æ³•ä¸º 'weighted'ï¼Œè·³è¿‡BLIPæ¨¡å‹åŠ è½½ä»¥èŠ‚çœæ˜¾å­˜
è·å–MLLMæ¨¡å‹å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰...
ğŸš€ åˆå§‹åŒ–MLLMæ¨¡å‹: Qwen2.5-VL-7B on cuda
ğŸ“Š å½“å‰æ˜¾å­˜: 0.56GB / 79.25GB
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [00:01<00:07,  1.99s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:04<00:06,  2.16s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:06<00:04,  2.21s/it]Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:08<00:02,  2.23s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:09<00:00,  1.70s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:09<00:00,  1.91s/it]
local_model_path: ./models/Qwen/Qwen2.5-VL-7B-Instruct
âœ… MLLMæ¨¡å‹åˆå§‹åŒ–å®Œæˆ
ğŸ“Š åŠ è½½åæ˜¾å­˜: 31.59GB / 79.25GB
åˆå§‹åŒ–å¿«æ€è€ƒæ¨¡å—...
æœªæ‰¾åˆ°å†å²ç»Ÿè®¡é‡æ–‡ä»¶ï¼Œå°†ä»å¤´å¼€å§‹
åˆå§‹åŒ–æ…¢æ€è€ƒæ¨¡å—...
å¿«æ…¢æ€è€ƒç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ!
ä» ./experiments/bird200/knowledge_base åŠ è½½çŸ¥è¯†åº“...
ç±»åˆ«å›¾åƒè·¯å¾„å·²ä» ./experiments/bird200/knowledge_base/category_image_paths.json åŠ è½½
åŠ è½½äº† 200 ä¸ªç±»åˆ«çš„å›¾åƒè·¯å¾„
çŸ¥è¯†åº“å·²ä» ./experiments/bird200/knowledge_base åŠ è½½
çŸ¥è¯†åº“åŠ è½½å®Œæˆ!
å·²åŠ è½½çŸ¥è¯†åº“: ./experiments/bird200/knowledge_base
æ‰¾åˆ° 200 ä¸ªæ¨ç†ç»“æœæ–‡ä»¶
Processing classification:   0%|          | 0/200 [00:00<?, ?it/s]Processing classification:   4%|â–         | 7/200 [00:05<02:44,  1.17it/s]Processing classification:   4%|â–         | 8/200 [00:11<05:28,  1.71s/it]Processing classification:   6%|â–Œ         | 11/200 [00:17<05:34,  1.77s/it]Processing classification:   6%|â–‹         | 13/200 [00:23<06:38,  2.13s/it]Processing classification:  10%|â–‰         | 19/200 [00:29<04:35,  1.52s/it]Processing classification:  12%|â–ˆâ–        | 23/200 [00:35<04:19,  1.47s/it]Processing classification:  12%|â–ˆâ–        | 24/200 [00:40<05:37,  1.92s/it]Processing classification:  14%|â–ˆâ–        | 28/200 [00:46<05:00,  1.75s/it]Processing classification:  20%|â–ˆâ–‰        | 39/200 [00:52<02:40,  1.00it/s]Processing classification:  22%|â–ˆâ–ˆâ–       | 44/200 [00:58<02:45,  1.06s/it]Processing classification:  22%|â–ˆâ–ˆâ–       | 45/200 [01:04<03:47,  1.47s/it]Processing classification:  24%|â–ˆâ–ˆâ–       | 49/200 [01:11<03:47,  1.51s/it]Processing classification:  25%|â–ˆâ–ˆâ–Œ       | 50/200 [01:17<04:57,  1.99s/it]Processing classification:  26%|â–ˆâ–ˆâ–‹       | 53/200 [01:23<04:57,  2.03s/it]Processing classification:  29%|â–ˆâ–ˆâ–‰       | 58/200 [01:30<04:07,  1.75s/it]Processing classification:  30%|â–ˆâ–ˆâ–‰       | 59/200 [01:37<05:15,  2.24s/it]Processing classification:  34%|â–ˆâ–ˆâ–ˆâ–      | 67/200 [01:44<03:18,  1.49s/it]Processing classification:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 70/200 [01:49<03:26,  1.59s/it]Processing classification:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 76/200 [01:55<02:48,  1.36s/it]Processing classification:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 80/200 [02:01<02:47,  1.40s/it]Processing classification:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 82/200 [02:08<03:20,  1.70s/it]Processing classification:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 83/200 [02:14<04:11,  2.15s/it]Processing classification:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 84/200 [02:20<05:08,  2.66s/it]Processing classification:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 92/200 [02:26<02:44,  1.53s/it]Processing classification:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 93/200 [02:32<03:28,  1.94s/it]Processing classification:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 100/200 [02:37<02:16,  1.37s/it]Processing classification:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 102/200 [02:43<02:41,  1.65s/it]Processing classification:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 103/200 [02:49<03:21,  2.08s/it]Processing classification:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 105/200 [02:55<03:39,  2.31s/it]Processing classification:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 106/200 [03:01<04:23,  2.80s/it]Processing classification:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 111/200 [03:07<02:58,  2.00s/it]Processing classification:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 112/200 [03:13<03:42,  2.53s/it]Processing classification:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 130/200 [03:19<00:58,  1.19it/s]Processing classification:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 134/200 [03:25<01:02,  1.05it/s]Processing classification:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 145/200 [03:30<00:41,  1.31it/s]Processing classification:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 147/200 [03:37<00:54,  1.02s/it]Processing classification:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 154/200 [03:43<00:43,  1.06it/s]Processing classification:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 158/200 [03:49<00:45,  1.08s/it]Processing classification:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 165/200 [03:56<00:36,  1.04s/it]Processing classification:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 167/200 [04:01<00:41,  1.26s/it]Processing classification:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 168/200 [04:07<00:52,  1.64s/it]Processing classification:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 170/200 [04:13<00:56,  1.89s/it]Processing classification:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 175/200 [04:19<00:40,  1.63s/it]Processing classification:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 181/200 [04:26<00:26,  1.41s/it]Processing classification:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 189/200 [04:32<00:12,  1.13s/it]Processing classification:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 190/200 [04:39<00:15,  1.52s/it]Processing classification:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 194/200 [04:45<00:09,  1.55s/it]Processing classification: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 200/200 [04:45<00:00,  1.43s/it]
å¿«æ…¢ä¸ä¸€è‡´: fast=Least Auklet, slow=Pelagic Cormorant, è£å†³ç»“æœ=Rhinoceros Auklet
å¿«æ…¢ä¸ä¸€è‡´: fast=Mourning Warbler, slow=White-eyed Vireo, è£å†³ç»“æœ=White-eyed Vireo
å¿«æ…¢ä¸ä¸€è‡´: fast=Forsters Tern, slow=Common Tern (Sterna hirundo), è£å†³ç»“æœ=Common Tern (Sterna hirundo)
å¿«æ…¢ä¸ä¸€è‡´: fast=Mockingbird, slow=Loggerhead Shrike, è£å†³ç»“æœ=Loggerhead Shrike
å¿«æ…¢ä¸ä¸€è‡´: fast=Common Yellowthroat, slow=Kentucky Warbler, è£å†³ç»“æœ=Palm Warbler
å¿«æ…¢ä¸ä¸€è‡´: fast=Hooded Oriole, slow=Cedar Waxwing, è£å†³ç»“æœ=Cedar Waxwing
å¿«æ…¢ä¸ä¸€è‡´: fast=Least Flycatcher, slow=Swainson Warbler, è£å†³ç»“æœ=Least Flycatcher
å¿«æ…¢ä¸ä¸€è‡´: fast=Western Gull, slow=Pomarine Jaeger, è£å†³ç»“æœ=Pomarine Jaeger
å¿«æ…¢ä¸ä¸€è‡´: fast=Purple Finch, slow=Pine Grosbeak, è£å†³ç»“æœ=Pine Grosbeak
å¿«æ…¢ä¸ä¸€è‡´: fast=Western Grebe, slow=Western Grebe (Aechmophorus occidentalis), è£å†³ç»“æœ=Western Grebe (Aechmophorus occidentalis)
å¿«æ…¢ä¸ä¸€è‡´: fast=Mockingbird, slow=Sayornis, è£å†³ç»“æœ=Sayornis
å¿«æ…¢ä¸ä¸€è‡´: fast=Artic Tern, slow=Common Tern (Sterna hirundo), è£å†³ç»“æœ=Common Tern (Sterna hirundo)
å¿«æ…¢ä¸ä¸€è‡´: fast=Least Flycatcher, slow=Warbling Vireo, è£å†³ç»“æœ=Warbling Vireo
å¿«æ…¢ä¸ä¸€è‡´: fast=California Gull, slow=Heermann's Gull, è£å†³ç»“æœ=Heermann Gull
å¿«æ…¢ä¸ä¸€è‡´: fast=Bobolink, slow=Le-Conte Sparrow, è£å†³ç»“æœ=Baird Sparrow
å¿«æ…¢ä¸ä¸€è‡´: fast=Horned Lark, slow=Horned Lark (Eremophila alpestris), è£å†³ç»“æœ=Horned Lark
å¿«æ…¢ä¸ä¸€è‡´: fast=California Gull, slow=Herring Gull (Larus argentatus), è£å†³ç»“æœ=Herring Gull (Larus argentatus)
å¿«æ…¢ä¸ä¸€è‡´: fast=Spotted Catbird, slow=Brown Thrasher, è£å†³ç»“æœ=Brown Thrasher
å¿«æ…¢ä¸ä¸€è‡´: fast=Common Raven, slow=Fish Crow, è£å†³ç»“æœ=Common Raven
å¿«æ…¢ä¸ä¸€è‡´: fast=Western Gull, slow=Long-tailed Jaeger, è£å†³ç»“æœ=Long-tailed Jaeger
å¿«æ…¢ä¸ä¸€è‡´: fast=Mockingbird, slow=Loggerhead Shrike, è£å†³ç»“æœ=Great-Grey Shrike
å¿«æ…¢ä¸ä¸€è‡´: fast=Marsh Wren, slow=Cape Sable Seaside Sparrow, è£å†³ç»“æœ=Cape Sable Seaside Sparrow
å¿«æ…¢ä¸ä¸€è‡´: fast=Hooded Oriole, slow=Black-and-Yellow Oriole (Icterus chrysater), è£å†³ç»“æœ=Hooded Oriole
å¿«æ…¢ä¸ä¸€è‡´: fast=Spotted Catbird, slow=Philadelphia Vireo, è£å†³ç»“æœ=Least Flycatcher
å¿«æ…¢ä¸ä¸€è‡´: fast=Least Flycatcher, slow=Warbling Vireo, è£å†³ç»“æœ=Warbling Vireo
å¿«æ…¢ä¸ä¸€è‡´: fast=Pacific Loon, slow=Hooded Merganser, è£å†³ç»“æœ=Hooded Merganser
å¿«æ…¢ä¸ä¸€è‡´: fast=Black-footed Albatross, slow=Brandt Cormorant, è£å†³ç»“æœ=Brandt Cormorant
å¿«æ…¢ä¸ä¸€è‡´: fast=Ivory Gull, slow=Red-legged Kittiwake, è£å†³ç»“æœ=California Gull
å¿«æ…¢ä¸ä¸€è‡´: fast=Brewer Blackbird, slow=Black Tern, è£å†³ç»“æœ=Black Tern
å¿«æ…¢ä¸ä¸€è‡´: fast=Bobolink, slow=Rusty Blackbird, è£å†³ç»“æœ=Bobolink
å¿«æ…¢ä¸ä¸€è‡´: fast=Fox Sparrow, slow=Gray-crowned Rosy Finch, è£å†³ç»“æœ=Gray-crowned Rosy Finch
å¿«æ…¢ä¸ä¸€è‡´: fast=Cerulean Warbler, slow=White-breasted Nuthatch, è£å†³ç»“æœ=White-breasted Nuthatch
å¿«æ…¢ä¸ä¸€è‡´: fast=Mockingbird, slow=Bank Swallow (Riparia riparia), è£å†³ç»“æœ=Bank Swallow
å¿«æ…¢ä¸ä¸€è‡´: fast=Caspian Tern, slow=Common Tern (Sterna hirundo), è£å†³ç»“æœ=Common Tern (Sterna hirundo)
å¿«æ…¢ä¸ä¸€è‡´: fast=American Crow, slow=White-necked Raven, è£å†³ç»“æœ=White-necked Raven
å¿«æ…¢ä¸ä¸€è‡´: fast=Red-winged Blackbird, slow=Red-faced Cormorant, è£å†³ç»“æœ=Red-faced Cormorant
å¿«æ…¢ä¸ä¸€è‡´: fast=Olive-sided Flycatcher, slow=Western Wood Pewee, è£å†³ç»“æœ=Olive-sided Flycatcher
å¿«æ…¢ä¸ä¸€è‡´: fast=Field Sparrow, slow=Chipping Sparrow (Spizella passerina), è£å†³ç»“æœ=Chipping Sparrow (Spizella passerina)
å¿«æ…¢ä¸ä¸€è‡´: fast=Orchard Oriole, slow=American Redstart, è£å†³ç»“æœ=American Redstart
å¿«æ…¢ä¸ä¸€è‡´: fast=Least Flycatcher, slow=Warbling Vireo, è£å†³ç»“æœ=Least Flycatcher
å¿«æ…¢ä¸ä¸€è‡´: fast=White-throated Sparrow, slow=Chestnut-sided Warbler, è£å†³ç»“æœ=Chestnut-sided Warbler
å¿«æ…¢ä¸ä¸€è‡´: fast=Common Yellowthroat, slow=Golden-winged Warbler, è£å†³ç»“æœ=Golden-winged Warbler
å¿«æ…¢ä¸ä¸€è‡´: fast=Black-footed Albatross, slow=Northern Fulmar, è£å†³ç»“æœ=Northern Fulmar
å¿«æ…¢ä¸ä¸€è‡´: fast=Common Raven, slow=Groove-billed Ani, è£å†³ç»“æœ=Groove-billed Ani
å¿«æ…¢ä¸ä¸€è‡´: fast=Least Flycatcher, slow=Bay-breasted Warbler, è£å†³ç»“æœ=Bay-breasted Warbler
å¿«æ…¢ä¸ä¸€è‡´: fast=Least Flycatcher, slow=Western Wood Pewee (Contopus sordidulus), è£å†³ç»“æœ=Western Wood Pewee (Contopus sordidulus)
å¿«æ…¢ä¸ä¸€è‡´: fast=Orchard Oriole, slow=Evening Grosbeak (Coccothraustes vespertinus), è£å†³ç»“æœ=Evening Grosbeak
âœ… æ­£ç¡®é¢„æµ‹æ€»æ•°: 179
  - å…¶ä¸­ä»…å¿«æ€è€ƒæ­£ç¡®: 61
  - å…¶ä¸­æ…¢æ€è€ƒè§¦å‘ä¸”æ­£ç¡®: 118
âŒ é”™è¯¯é¢„æµ‹æ€»æ•°: 21
ğŸ“Š æ…¢æ€è€ƒè§¦å‘æ•°é‡: 135
[fast_slow_classify] æ€»ä½“å‡†ç¡®ç‡: 0.8950 (179/200)
[fast_slow_classify] å¿«æ€è€ƒå‡†ç¡®ç‡: 0.9385
[fast_slow_classify] æ…¢æ€è€ƒè§¦å‘æ¯”ä¾‹: 0.6750
[fast_slow_classify] æ…¢æ€è€ƒå‡†ç¡®ç‡: 0.8741
åˆ†ç±»ç»“æœå·²ä¿å­˜åˆ°: ./experiments/bird200/classify/classification_results.json
å½“å‰æ—¶é—´ä¸ºï¼š 2025-11-01 10:28:50
æ€»è€—æ—¶: 00:04:56
