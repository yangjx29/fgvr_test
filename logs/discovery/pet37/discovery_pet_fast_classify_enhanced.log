/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/data/oldhome/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Namespace(mode='fast_classify_enhanced', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/pet37_all.yml', num_per_category='3', knowledge_base_dir='./knowledge_base', query_image=None, test_data_dir=None, results_out='./results.json', use_slow_thinking=None, confidence_threshold=0.8, similarity_threshold=0.7, enable_mllm_intermediate_judge=False, infer_dir='./experiments/pet37/infer', classify_dir='./experiments/pet37/classify')
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'pet', 'num_classes': 37, 'num_base': 19, 'num_novel': 18, 'seed': 1, 'batch_size': 32, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'FlanT5-XXL', 'model_size_mllm': 'Qwen2.5-VL-7B', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'xiao', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/pet_37', 'expt_dir': './experiments/pet37', 'expt_dir_describe': './experiments/pet37/describe', 'path_vqa_questions': './experiments/pet37/describe/pet_vqa_questions_ours', 'path_vqa_answers': './experiments/pet37/describe/pet_attributes_pairs', 'path_llm_prompts': './experiments/pet37/describe/pet_llm_prompts', 'path_identify_answers': './experiments/pet37/identify', 'expt_dir_guess': './experiments/pet37/guess', 'path_llm_replies_raw': './experiments/pet37/guess/pet_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/pet37/guess/pet_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/pet37/guess/pet_llm_gussed_names', 'expt_dir_gallery': './experiments/pet37/gallery', 'path_references': './experiments/pet37/gallery/pet_image_references', 'path_regions': './experiments/pet37/gallery/pet_image_regions', 'path_descriptions': './experiments/pet37/gallery/pet_image_descriptions_attn', 'expt_dir_grouping': './experiments/pet37/grouping'}
ä»ç›®å½•åŠ è½½æ¨ç†ç»“æœ: ./experiments/pet37/infer
å¢å¼ºå¿«æ€è€ƒåˆ†ç±»ç»“æœå°†ä¿å­˜åˆ°: ./experiments/pet37/classify
æ‰¾åˆ° 37 ä¸ªæ¨ç†ç»“æœæ–‡ä»¶
æ”¶é›†å¿«æ€è€ƒæ ·æœ¬...
Collecting fast samples:   0%|          | 0/37 [00:00<?, ?it/s]Collecting fast samples: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:00<00:00, 9971.68it/s]
ğŸ“Š æ”¶é›†åˆ° 32 ä¸ªå¿«æ€è€ƒæ ·æœ¬
ğŸ“Š éœ€è¦æ£€ç´¢ 37 ä¸ªç±»åˆ«
å‡†å¤‡æµ‹è¯•å›¾åƒ...
Copying test images:   0%|          | 0/32 [00:00<?, ?it/s]Copying test images: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:00<00:00, 170760.47it/s]
å‡†å¤‡æ£€ç´¢å›¾åƒ...
Preparing retrieved images:   0%|          | 0/37 [00:00<?, ?it/s]Preparing retrieved images: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:00<00:00, 897047.68it/s]
ğŸ“ ä¿å­˜æè¿°æ–‡ä»¶åˆ°: ./Multimodal_Enhanced_Classification/descriptions/pet37_fast_test_descriptions.json
ğŸ“ ä¿å­˜æè¿°æ–‡ä»¶åˆ°: ./Multimodal_Enhanced_Classification/descriptions/pet37_fast_retrieved_descriptions.json
ğŸš€ è°ƒç”¨MECå®Œæ•´æµæ°´çº¿...
ğŸš€ MECæ­¥éª¤1: é¢„æå–ç‰¹å¾...
âŒ MECæµæ°´çº¿å¤±è´¥: ç‰¹å¾æå–å¤±è´¥: /home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/data/oldhome/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Traceback (most recent call last):
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/urllib/request.py", line 1346, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/http/client.py", line 1285, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/http/client.py", line 1331, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/http/client.py", line 1280, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/http/client.py", line 1040, in _send_output
    self.send(msg)
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/http/client.py", line 980, in send
    self.connect()
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/http/client.py", line 1454, in connect
    self.sock = self._context.wrap_socket(self.sock,
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/ssl.py", line 501, in wrap_socket
    return self.sslsocket_class._create(
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/ssl.py", line 1041, in _create
    self.do_handshake()
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/ssl.py", line 1310, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLCertVerificationError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: self-signed certificate in certificate chain (_ssl.c:1129)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/oldhome/hdl/project/fgvr_test/Multimodal_Enhanced_Classification/pre_extract.py", line 252, in <module>
    main_worker(args)
  File "/data/oldhome/hdl/project/fgvr_test/Multimodal_Enhanced_Classification/pre_extract.py", line 185, in main_worker
    clip_model = load_clip_to_cpu(args.arch)
  File "/data/oldhome/hdl/project/fgvr_test/Multimodal_Enhanced_Classification/pre_extract.py", line 45, in load_clip_to_cpu
    model_path = clip._download(url)
  File "/data/oldhome/hdl/project/fgvr_test/Multimodal_Enhanced_Classification/clip/clip.py", line 51, in _download
    with urllib.request.urlopen(url) as source, open(download_target, "wb") as output:
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/urllib/request.py", line 214, in urlopen
    return opener.open(url, data, timeout)
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/urllib/request.py", line 517, in open
    response = self._open(req, data)
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/urllib/request.py", line 534, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/urllib/request.py", line 494, in _call_chain
    result = func(*args)
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/urllib/request.py", line 1389, in https_open
    return self.do_open(http.client.HTTPSConnection, req,
  File "/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/urllib/request.py", line 1349, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: self-signed certificate in certificate chain (_ssl.c:1129)>

å¤„ç†å¢å¼ºç»“æœ...
Processing enhanced results:   0%|          | 0/32 [00:00<?, ?it/s]Processing enhanced results: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 32/32 [00:00<00:00, 7762.29it/s]
âœ… å·²æ¸…ç†MECä¸´æ—¶æ–‡ä»¶: pet37_fast
âœ… å¿«æ€è€ƒå¢å¼ºåˆ†ç±»å®Œæˆ
ğŸ“Š æ€»æ ·æœ¬æ•°: 32
ğŸ¯ åŸå§‹å‡†ç¡®ç‡: 1.0000 (32/32)
ğŸš€ å¢å¼ºå‡†ç¡®ç‡: 1.0000 (32/32)
ğŸ“ˆ å¢å¼ºæå‡ç‡: 0.0000
ğŸ”§ MECæ‰§è¡ŒçŠ¶æ€: å¤±è´¥
ğŸ’¾ å¢å¼ºå¿«æ€è€ƒåˆ†ç±»ç»“æœå·²ä¿å­˜åˆ°: ./experiments/pet37/classify/fast_classification_results_enhanced.json
