/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/data/oldhome/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Namespace(mode='fast_classify_enhanced', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/flower102_all.yml', num_per_category='3', knowledge_base_dir='./knowledge_base', query_image=None, test_data_dir=None, results_out='./results.json', use_slow_thinking=None, confidence_threshold=0.8, similarity_threshold=0.7, enable_mllm_intermediate_judge=False, infer_dir='./experiments/flower102/infer', classify_dir='./experiments/flower102/classify')
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'flower', 'num_classes': 102, 'num_base': 51, 'num_novel': 51, 'seed': 1, 'batch_size': 256, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'FlanT5-XXL', 'model_size_mllm': 'Qwen2.5-VL-7B', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'xiao', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/flowers_102', 'expt_dir': './experiments/flower102', 'expt_dir_describe': './experiments/flower102/describe', 'path_vqa_questions': './experiments/flower102/describe/flower_vqa_questions_ours', 'path_vqa_answers': './experiments/flower102/describe/flower_attributes_pairs', 'path_llm_prompts': './experiments/flower102/describe/flower_llm_prompts', 'path_identify_answers': './experiments/flower102/identify', 'expt_dir_guess': './experiments/flower102/guess', 'path_llm_replies_raw': './experiments/flower102/guess/flower_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/flower102/guess/flower_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/flower102/guess/flower_llm_gussed_names', 'expt_dir_gallery': './experiments/flower102/gallery', 'path_references': './experiments/flower102/gallery/flower_image_references', 'path_regions': './experiments/flower102/gallery/flower_image_regions', 'path_descriptions': './experiments/flower102/gallery/flower_image_descriptions_attn', 'expt_dir_grouping': './experiments/flower102/grouping'}
ä»ç›®å½•åŠ è½½æ¨ç†ç»“æœ: ./experiments/flower102/infer
å¢å¼ºå¿«æ€è€ƒåˆ†ç±»ç»“æœå°†ä¿å­˜åˆ°: ./experiments/flower102/classify
æ‰¾åˆ° 102 ä¸ªæ¨ç†ç»“æœæ–‡ä»¶
âœ… ä»çŸ¥è¯†åº“åŠ è½½äº† 100 ä¸ªç±»åˆ«çš„å›¾åƒè·¯å¾„: ./experiments/flower102/knowledge_base/category_image_paths.json
âœ… æˆåŠŸåŠ è½½ç±»åˆ«å›¾åƒè·¯å¾„ï¼ŒåŒ…å« 100 ä¸ªç±»åˆ«
ğŸ”§ å¿«æ€è€ƒæ¨¡å¼ï¼šå¯ç”¨åŠ¨æ€kå¼ å›¾åƒçš„AWCå¤„ç†
ğŸ“Š kå€¼åˆ†å¸ƒç»Ÿè®¡: {4: 98, 8: 2}
ğŸ“Š å¹³å‡æ¯ç±»åˆ«å›¾åƒæ•°: 4.1
ğŸ“Š æ€»å›¾åƒæ•°: 408
æ”¶é›†å¿«æ€è€ƒæ ·æœ¬...
Collecting fast samples:   0%|          | 0/102 [00:00<?, ?it/s]Collecting fast samples: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 102/102 [00:00<00:00, 16047.83it/s]
ğŸ“Š æ”¶é›†åˆ° 65 ä¸ªå¿«æ€è€ƒæ ·æœ¬
ğŸ“Š éœ€è¦æ£€ç´¢ 94 ä¸ªç±»åˆ«
å‡†å¤‡æµ‹è¯•å›¾åƒ...
Copying test images:   0%|          | 0/65 [00:00<?, ?it/s]Copying test images: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 65/65 [00:00<00:00, 10790.81it/s]
å‡†å¤‡æ£€ç´¢å›¾åƒ...
Preparing retrieved images:   0%|          | 0/94 [00:00<?, ?it/s]Preparing retrieved images: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 94/94 [00:00<00:00, 1815.93it/s]
ğŸ” ç±»åˆ« Red Ginger: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Love In The Mist: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Petunia: æ£€æµ‹åˆ° 8 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Ball Moss: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Gaura: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Bird Of Paradise: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Daffodil: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Foxglove: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Clematis: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Silverbush: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Bearded Iris: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Barbeton Daisy: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Thorn Apple: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Sweet William: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Camellia: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Globe-Flower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Primula: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Morning Glory: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Hippeastrum : æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Marigold: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Lotus: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Artichoke: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Tiger Lily: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Spring Crocus: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Common Dandelion: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Balloon Flower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Lenten Rose: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Bishop of Llandaff: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Mallow: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Frangipani: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Globe Thistle: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Canterbury Bells: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Black-eyed Susan: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Colt'S Foot: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Purple Coneflower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Wild Pansy: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Hard-leaved Pocket Orchid: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Alpine Sea Holly: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Oxeye Daisy: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Fire Lily: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Snapdragon: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Toad Lily: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Fritillary: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Mexican Aster: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Columbine: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Gazania: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Stemless Gentian: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Buttercup: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Windflower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Bolero Deep Blue: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Azalea: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Blanket Flower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Poinsettia: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Trumpet Creeper: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Peruvian Lily: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Yellow Iris: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Monkshood: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Bee Balm: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Bromelia: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Garden Phlox: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Pelargonium: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Tree Poppy: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Watercress: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Pink Primrose: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Canna Lily: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Orange Dahlia: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Prince Of Wales Feathers: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Californian Poppy: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Spear Thistle: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Blackberry Lily: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Pink-yellow Dahlia: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Water Lily: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Geranium: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Passion Flower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Moon Orchid: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Cyclamen : æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Sword Lily: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Sweet Pea: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« English Marigold: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Sunflower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Japanese Anemone: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Ruby-lipped Cattleya: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Siam Tulip: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Osteospermum: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Pincushion Flower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Hibiscus: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Corn Poppy: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Grape Hyacinth: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Cape Flower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Great Masterwort: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Wallflower: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Magnolia: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Anthurium: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ” ç±»åˆ« Bougainvillea: æ£€æµ‹åˆ° 4 å¼ å›¾åƒ
ğŸ“ ä¿å­˜æè¿°æ–‡ä»¶åˆ°: ./Multimodal_Enhanced_Classification/descriptions/flower102_fast_test_descriptions.json
ğŸ“ ä¿å­˜æè¿°æ–‡ä»¶åˆ°: ./Multimodal_Enhanced_Classification/descriptions/flower102_fast_retrieved_descriptions.json
ğŸš€ è°ƒç”¨MECå®Œæ•´æµæ°´çº¿...
ğŸ” éªŒè¯æ•°æ®å®Œæ•´æ€§...
  æµ‹è¯•æ•°æ®ç›®å½•: ./Multimodal_Enhanced_Classification/data/flower102_fast_test
  æ£€ç´¢æ•°æ®ç›®å½•: ./Multimodal_Enhanced_Classification/data/flower102_fast_retrieved
  æ£€ç´¢å›¾åƒä½äºå­ç›®å½•: ./Multimodal_Enhanced_Classification/data/flower102_fast_retrieved/retrieved_images
  å‘ç°æµ‹è¯•å›¾åƒ: 65 ä¸ª
  å‘ç°æ£€ç´¢å›¾åƒ: 380 ä¸ª
MECæµæ°´çº¿: æµ‹è¯•æ ·æœ¬ 65 ä¸ª, æ£€ç´¢æ ·æœ¬ 380 ä¸ª
ğŸ”„ æ­¥éª¤1: é¢„æå–å¤šæ¨¡æ€ç‰¹å¾...
æ‰§è¡Œé¢„æå–å‘½ä»¤: /home/hdl/miniconda3/envs/finer_dynamic/bin/python pre_extract.py ./Multimodal_Enhanced_Classification/data --test_set flower102_fast --arch ViT-B/16 --seed 0 --batch-size 50 --workers 4 --resolution 224
âœ… ç‰¹å¾é¢„æå–æˆåŠŸ
ğŸ”„ æ­¥éª¤2: æ‰§è¡Œå¤šæ¨¡æ€å¢å¼ºåˆ†ç±»è¯„ä¼°...
æ‰§è¡Œè¯„ä¼°å‘½ä»¤: /home/hdl/miniconda3/envs/finer_dynamic/bin/python evaluate.py --test_set flower102_fast --arch ViT-B/16 --seed 0 --print-freq 100
âš ï¸  æœªæ‰¾åˆ°å‡†ç¡®ç‡ä¿¡æ¯ï¼Œä½¿ç”¨é»˜è®¤å€¼ 0.5
âœ… MECè¯„ä¼°æˆåŠŸï¼Œå‡†ç¡®ç‡: 0.5000
âœ… MECæµæ°´çº¿å®Œæˆï¼Œå‡†ç¡®ç‡: 0.5000, è€—æ—¶: 12.58ç§’
âœ… MECæµæ°´çº¿æˆåŠŸï¼Œå‡†ç¡®ç‡: 0.5000
å¤„ç†å¢å¼ºç»“æœ...
Processing enhanced results:   0%|          | 0/65 [00:00<?, ?it/s]Processing enhanced results: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 65/65 [00:00<00:00, 7923.67it/s]
ğŸ—‘ï¸  å·²æ¸…ç†ä¸´æ—¶ç›®å½•: ./Multimodal_Enhanced_Classification/data/flower102_fast_test
ğŸ—‘ï¸  å·²æ¸…ç†ä¸´æ—¶ç›®å½•: ./Multimodal_Enhanced_Classification/data/flower102_fast_retrieved
ğŸ—‘ï¸  å·²æ¸…ç†æè¿°æ–‡ä»¶: ./Multimodal_Enhanced_Classification/descriptions/flower102_fast_test_descriptions.json
ğŸ—‘ï¸  å·²æ¸…ç†æè¿°æ–‡ä»¶: ./Multimodal_Enhanced_Classification/descriptions/flower102_fast_retrieved_descriptions.json
âœ… å¿«æ€è€ƒå¢å¼ºåˆ†ç±»å®Œæˆ
ğŸ“Š æ€»æ ·æœ¬æ•°: 65
ğŸš€ æœ€ç»ˆå‡†ç¡®ç‡: 0.9692 (63/65)
ğŸ”§ MECæ‰§è¡ŒçŠ¶æ€: æˆåŠŸ
ğŸ’¾ å¢å¼ºå¿«æ€è€ƒåˆ†ç±»ç»“æœå·²ä¿å­˜åˆ°: ./experiments/flower102/classify/fast_classification_results_enhanced.json
æ€»è€—æ—¶: 00:00:12
