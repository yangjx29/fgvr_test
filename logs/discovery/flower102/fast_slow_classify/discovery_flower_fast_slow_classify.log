/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/data/oldhome/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Namespace(mode='fast_slow_classify', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/flower102_all.yml', num_per_category='3', knowledge_base_dir='./knowledge_base', query_image=None, test_data_dir=None, results_out='./results.json', use_slow_thinking=None, confidence_threshold=0.8, similarity_threshold=0.7, enable_mllm_intermediate_judge=False, infer_dir='./experiments/flower102/infer', classify_dir='./experiments/flower102/classify')
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'flower', 'num_classes': 102, 'num_base': 51, 'num_novel': 51, 'seed': 1, 'batch_size': 256, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'FlanT5-XXL', 'model_size_mllm': 'Qwen2.5-VL-7B', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'xiao', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/flowers_102', 'expt_dir': './experiments/flower102', 'expt_dir_describe': './experiments/flower102/describe', 'path_vqa_questions': './experiments/flower102/describe/flower_vqa_questions_ours', 'path_vqa_answers': './experiments/flower102/describe/flower_attributes_pairs', 'path_llm_prompts': './experiments/flower102/describe/flower_llm_prompts', 'path_identify_answers': './experiments/flower102/identify', 'expt_dir_guess': './experiments/flower102/guess', 'path_llm_replies_raw': './experiments/flower102/guess/flower_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/flower102/guess/flower_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/flower102/guess/flower_llm_gussed_names', 'expt_dir_gallery': './experiments/flower102/gallery', 'path_references': './experiments/flower102/gallery/flower_image_references', 'path_regions': './experiments/flower102/gallery/flower_image_regions', 'path_descriptions': './experiments/flower102/gallery/flower_image_descriptions_attn', 'expt_dir_grouping': './experiments/flower102/grouping'}
ä»ç›®å½•åŠ è½½æ¨ç†ç»“æœ: ./experiments/flower102/infer
åˆ†ç±»ç»“æœå°†ä¿å­˜åˆ°: ./experiments/flower102/classify
åˆå§‹åŒ–çŸ¥è¯†åº“æ„å»ºå™¨...
ğŸš€ èåˆæ–¹æ³•ä¸º 'weighted'ï¼Œè·³è¿‡BLIPæ¨¡å‹åŠ è½½ä»¥èŠ‚çœæ˜¾å­˜
è·å–MLLMæ¨¡å‹å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰...
ğŸš€ åˆå§‹åŒ–MLLMæ¨¡å‹: Qwen2.5-VL-7B on cuda
ğŸ“Š å½“å‰æ˜¾å­˜: 0.56GB / 79.25GB
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [00:01<00:07,  1.87s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:04<00:06,  2.02s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:06<00:04,  2.07s/it]Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:08<00:02,  2.10s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:09<00:00,  1.61s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:09<00:00,  1.80s/it]
local_model_path: ./models/Qwen/Qwen2.5-VL-7B-Instruct
âœ… MLLMæ¨¡å‹åˆå§‹åŒ–å®Œæˆ
ğŸ“Š åŠ è½½åæ˜¾å­˜: 31.59GB / 79.25GB
åˆå§‹åŒ–å¿«æ€è€ƒæ¨¡å—...
æœªæ‰¾åˆ°å†å²ç»Ÿè®¡é‡æ–‡ä»¶ï¼Œå°†ä»å¤´å¼€å§‹
åˆå§‹åŒ–æ…¢æ€è€ƒæ¨¡å—...
å¿«æ…¢æ€è€ƒç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ!
ä» ./experiments/flower102/knowledge_base åŠ è½½çŸ¥è¯†åº“...
ç±»åˆ«å›¾åƒè·¯å¾„æ–‡ä»¶ä¸å­˜åœ¨: ./experiments/flower102/knowledge_base/category_image_paths.json
çŸ¥è¯†åº“å·²ä» ./experiments/flower102/knowledge_base åŠ è½½
çŸ¥è¯†åº“åŠ è½½å®Œæˆ!
å·²åŠ è½½çŸ¥è¯†åº“: ./experiments/flower102/knowledge_base
æ‰¾åˆ° 102 ä¸ªæ¨ç†ç»“æœæ–‡ä»¶
Processing classification:   0%|          | 0/102 [00:00<?, ?it/s]Processing classification:  11%|â–ˆ         | 11/102 [00:07<01:02,  1.44it/s]Processing classification:  12%|â–ˆâ–        | 12/102 [00:13<01:55,  1.28s/it]Processing classification:  17%|â–ˆâ–‹        | 17/102 [00:19<01:49,  1.29s/it]Processing classification:  18%|â–ˆâ–Š        | 18/102 [00:27<02:44,  1.95s/it]Processing classification:  28%|â–ˆâ–ˆâ–Š       | 29/102 [00:34<01:20,  1.11s/it]Processing classification:  30%|â–ˆâ–ˆâ–ˆ       | 31/102 [00:39<01:34,  1.33s/it]Processing classification:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 45/102 [00:46<00:47,  1.19it/s]Processing classification:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 61/102 [00:52<00:25,  1.60it/s]Processing classification:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 67/102 [00:59<00:25,  1.39it/s]Processing classification:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 72/102 [01:04<00:24,  1.25it/s]Processing classification:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 74/102 [01:11<00:29,  1.04s/it]Processing classification:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 75/102 [01:17<00:37,  1.40s/it]Processing classification:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 79/102 [01:24<00:34,  1.52s/it]Processing classification:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 80/102 [01:32<00:45,  2.08s/it]Processing classification:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 86/102 [01:39<00:26,  1.66s/it]Processing classification:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 98/102 [01:45<00:04,  1.02s/it]Processing classification:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 99/102 [01:51<00:03,  1.32s/it]Processing classification: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 102/102 [01:51<00:00,  1.09s/it]
å¿«æ…¢ä¸ä¸€è‡´: fast=Tree Mallow, slow=Mexican Aster, è£å†³ç»“æœ=Mexican Aster
å¿«æ…¢ä¸ä¸€è‡´: fast=Orange Dahlia, slow=Gazania, è£å†³ç»“æœ=English Marigold
å¿«æ…¢ä¸ä¸€è‡´: fast=Colt'S Foot, slow=Common Dandelion, è£å†³ç»“æœ=Common Dandelion
å¿«æ…¢ä¸ä¸€è‡´: fast=Bee Balm, slow=King Protea (Protea cynaroides), è£å†³ç»“æœ=King Protea
å¿«æ…¢ä¸ä¸€è‡´: fast=Orange Dahlia, slow=Gazania, è£å†³ç»“æœ=Gazania
å¿«æ…¢ä¸ä¸€è‡´: fast=Red Ginger, slow=Trumpet Creeper, è£å†³ç»“æœ=Trumpet Creeper
å¿«æ…¢ä¸ä¸€è‡´: fast=Wild Pansy, slow=Lisianthus (Eustoma grandiflorum), è£å†³ç»“æœ=Lisianthus (Eustoma grandiflorum)
å¿«æ…¢ä¸ä¸€è‡´: fast=Japanese Anemone, slow=Windflower, è£å†³ç»“æœ=Windflower
å¿«æ…¢ä¸ä¸€è‡´: fast=Prince Of Wales Feathers, slow=Cauliflowers, è£å†³ç»“æœ=Prince Of Wales Feathers
å¿«æ…¢ä¸ä¸€è‡´: fast=Gaura, slow=Tree Mallow, è£å†³ç»“æœ=Gaura
å¿«æ…¢ä¸ä¸€è‡´: fast=Bolero Deep Blue, slow=Bromelia, è£å†³ç»“æœ=Bromelia
å¿«æ…¢ä¸ä¸€è‡´: fast=Cape Flower, slow=Clematis, è£å†³ç»“æœ=Clematis
å¿«æ…¢ä¸ä¸€è‡´: fast=Watercress, slow=Nasturtium, è£å†³ç»“æœ=Nasturtium
å¿«æ…¢ä¸ä¸€è‡´: fast=Thorn Apple, slow=Datura (Angel's Trumpet), è£å†³ç»“æœ=Datura (Angel's Trumpet)
å¿«æ…¢ä¸ä¸€è‡´: fast=Tree Mallow, slow=Pink Primrose (Oenothera speciosa), è£å†³ç»“æœ=Pink Primrose (Oenothera speciosa)
å¿«æ…¢ä¸ä¸€è‡´: fast=Petunia, slow=Ruellia tuberosa (Jewelweed), è£å†³ç»“æœ=Petunia
å¿«æ…¢ä¸ä¸€è‡´: fast=Mexican Aster, slow=Osteospermum, è£å†³ç»“æœ=Osteospermum
âœ… æ­£ç¡®é¢„æµ‹æ€»æ•°: 91
  - å…¶ä¸­ä»…å¿«æ€è€ƒæ­£ç¡®: 63
  - å…¶ä¸­æ…¢æ€è€ƒè§¦å‘ä¸”æ­£ç¡®: 28
âŒ é”™è¯¯é¢„æµ‹æ€»æ•°: 11
ğŸ“Š æ…¢æ€è€ƒè§¦å‘æ•°é‡: 37
[fast_slow_classify] æ€»ä½“å‡†ç¡®ç‡: 0.8922 (91/102)
[fast_slow_classify] å¿«æ€è€ƒå‡†ç¡®ç‡: 0.9692
[fast_slow_classify] æ…¢æ€è€ƒè§¦å‘æ¯”ä¾‹: 0.3627
[fast_slow_classify] æ…¢æ€è€ƒå‡†ç¡®ç‡: 0.7568
åˆ†ç±»ç»“æœå·²ä¿å­˜åˆ°: ./experiments/flower102/classify/classification_results.json
æ€»è€—æ—¶: 00:02:01
