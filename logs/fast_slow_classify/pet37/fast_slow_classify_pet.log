/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Namespace(mode='fast_slow_classify', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/pet37_all.yml', num_per_category='3', kshot=None, region_num=None, superclass=None, gallery_out=None, fusion_method='concat', knowledge_base_dir='./knowledge_base', query_image=None, test_data_dir=None, results_out='./results.json', use_slow_thinking=None, confidence_threshold=0.8, similarity_threshold=0.7, enable_mllm_intermediate_judge=False, infer_dir='./experiments/pet37/infer', classify_dir='./experiments/pet37/classify')
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'pet', 'num_classes': 37, 'num_base': 19, 'num_novel': 18, 'seed': 1, 'batch_size': 32, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'FlanT5-XXL', 'model_size_mllm': 'Qwen2.5-VL-7B', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'xiao', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/pet_37', 'expt_dir': './experiments/pet37', 'expt_dir_describe': './experiments/pet37/describe', 'path_vqa_questions': './experiments/pet37/describe/pet_vqa_questions_ours', 'path_vqa_answers': './experiments/pet37/describe/pet_attributes_pairs', 'path_llm_prompts': './experiments/pet37/describe/pet_llm_prompts', 'path_identify_answers': './experiments/pet37/identify', 'expt_dir_guess': './experiments/pet37/guess', 'path_llm_replies_raw': './experiments/pet37/guess/pet_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/pet37/guess/pet_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/pet37/guess/pet_llm_gussed_names', 'expt_dir_gallery': './experiments/pet37/gallery', 'path_references': './experiments/pet37/gallery/pet_image_references', 'path_regions': './experiments/pet37/gallery/pet_image_regions', 'path_descriptions': './experiments/pet37/gallery/pet_image_descriptions_attn', 'expt_dir_grouping': './experiments/pet37/grouping'}
ä»ç›®å½•åŠ è½½æ¨ç†ç»“æœ: ./experiments/pet37/infer
åˆ†ç±»ç»“æœå°†ä¿å­˜åˆ°: ./experiments/pet37/classify
åˆå§‹åŒ–çŸ¥è¯†åº“æ„å»ºå™¨...
ğŸš€ èåˆæ–¹æ³•ä¸º 'weighted'ï¼Œè·³è¿‡BLIPæ¨¡å‹åŠ è½½ä»¥èŠ‚çœæ˜¾å­˜
è·å–MLLMæ¨¡å‹å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰...
ğŸš€ åˆå§‹åŒ–MLLMæ¨¡å‹: Qwen2.5-VL-7B on cuda
ğŸ“Š å½“å‰æ˜¾å­˜: 0.56GB / 47.40GB
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [05:03<20:12, 303.16s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [07:43<10:58, 219.39s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [10:32<06:32, 196.16s/it]Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [13:04<02:58, 178.89s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [13:44<00:00, 128.64s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [13:44<00:00, 164.88s/it]
Some parameters are on the meta device because they were offloaded to the cpu.
local_model_path: /home/Dataset/Models/Qwen/Qwen2.5-VL-7B-Instruct
âœ… MLLMæ¨¡å‹åˆå§‹åŒ–å®Œæˆ
ğŸ“Š åŠ è½½åæ˜¾å­˜: 26.07GB / 47.40GB
åˆå§‹åŒ–å¿«æ€è€ƒæ¨¡å—...
å·²åŠ è½½å†å²ç»Ÿè®¡é‡: 305 æ¬¡é¢„æµ‹
åˆå§‹åŒ–æ…¢æ€è€ƒæ¨¡å—...
å¿«æ…¢æ€è€ƒç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ!
æ‰¾åˆ° 37 ä¸ªæ¨ç†ç»“æœæ–‡ä»¶
Processing classification:   0%|          | 0/37 [00:00<?, ?it/s]Processing classification: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 37/37 [00:00<00:00, 19121.40it/s]
å¤„ç†åˆ†ç±»å¤±è´¥ 007.Bombay_007.Bombay_135.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 023.Persian_023.Persian_190.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 011.Egyptian_Mau_011.Egyptian_Mau_112.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 001.American_Bulldog_001.American_Bulldog_107.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 006.Birman_006.Birman_11.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 013.English_Setter_013.English_Setter_137.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 022.Newfoundland_022.Newfoundland_156.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 005.Bengal_005.Bengal_14.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 029.Samoyed_029.Samoyed_123.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 027.Russian_Blue_027.Russian_Blue_170.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 004.Beagle_004.Beagle_18.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 028.Saint_Bernard_028.Saint_Bernard_159.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 031.Shiba_Inu_031.Shiba_Inu_12.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 003.Basset_Hound_003.Basset_Hound_146.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 012.English_Cocker_Spaniel_012.English_Cocker_Spaniel_107.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 009.British_Shorthair_009.British_Shorthair_108.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 017.Japanese_Chin_017.Japanese_Chin_157.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 020.Maine_Coon_020.Maine_Coon_163.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 002.American_Pit_Bull_Terrier_002.American_Pit_Bull_Terrier_14.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 026.Ragdoll_026.Ragdoll_142.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 034.Staffordshire_Bull_Terrier_034.Staffordshire_Bull_Terrier_126.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 036.Yorkshire_Terrier_036.Yorkshire_Terrier_16.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 010.Chihuahua_010.Chihuahua_179.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 033.Sphynx_033.Sphynx_156.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 024.Pomeranian_024.Pomeranian_105.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 025.Pug_025.Pug_110.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 018.Keeshond_018.Keeshond_101.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 021.Miniature_Pinscher_021.Miniature_Pinscher_105.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 035.Wheaten_Terrier_035.Wheaten_Terrier_109.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 014.German_Shorthaired_014.German_Shorthaired_190.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 016.Havanese_016.Havanese_135.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 000.Abyssinian_000.Abyssinian_126.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 032.Siamese_032.Siamese_153.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 008.Boxer_008.Boxer_109.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 019.Leonberger_019.Leonberger_148.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 030.Scottish_Terrier_030.Scottish_Terrier_139.json: list indices must be integers or slices, not str
å¤„ç†åˆ†ç±»å¤±è´¥ 015.Great_Pyrenees_015.Great_Pyrenees_18.json: list indices must be integers or slices, not str
âœ… æ­£ç¡®é¢„æµ‹æ€»æ•°: 0
  - å…¶ä¸­ä»…å¿«æ€è€ƒæ­£ç¡®: 0
  - å…¶ä¸­æ…¢æ€è€ƒè§¦å‘ä¸”æ­£ç¡®: 0
âŒ é”™è¯¯é¢„æµ‹æ€»æ•°: 0
ğŸ“Š æ…¢æ€è€ƒè§¦å‘æ•°é‡: 0
[fast_slow_classify] æ€»ä½“å‡†ç¡®ç‡: 0.0000 (0/0)
[fast_slow_classify] å¿«æ€è€ƒå‡†ç¡®ç‡: 0.0000
[fast_slow_classify] æ…¢æ€è€ƒè§¦å‘æ¯”ä¾‹: 0.0000
[fast_slow_classify] æ…¢æ€è€ƒå‡†ç¡®ç‡: 0.0000
åˆ†ç±»ç»“æœå·²ä¿å­˜åˆ°: ./experiments/pet37/classify/classification_results.json
