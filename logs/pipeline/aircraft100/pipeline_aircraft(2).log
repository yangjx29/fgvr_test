[INFO] === Pipeline å¯åŠ¨, YAML é…ç½®æ‘˜è¦ ===
GPU: CUDA_VISIBLE_DEVICES=0  # ä½¿ç”¨çš„GPUç¼–å·
Dataset: aircraft (num_classes=100)  # æ•°æ®é›†åŠç±»åˆ«æ•°, test_data_suffix=10  # æµ‹è¯•æ•°æ®æ ·æœ¬åç¼€
K-shot: 4  # æ£€ç´¢åº“ä½¿ç”¨æ¯ä¸ªç±»åˆ«çš„æ ·æœ¬æ•°ç›®
Conda Env: finer_dynamic  # Condaç¯å¢ƒåç§°, Conda Base: /home/hdl/miniconda3  # Condaå®‰è£…è·¯å¾„
Knowledge Base Dir: ./experiments/aircraft100/knowledge_base  # çŸ¥è¯†åº“ç›®å½•
Test Data Dir: ./datasets/fgvc_aircraft/images_discovery_all_10  # æµ‹è¯•æ•°æ®ç›®å½•
Results Out: ./results/aircraft_fast_slow_results.json  # å¿«æ…¢æ€è€ƒè¯„ä¼°ç»“æœè¾“å‡ºæ–‡ä»¶
---------------------------

[INFO] === Step1: æ„å»ºçŸ¥è¯†åº“ ===
/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
å½“å‰æ•°æ®é›†: aircraft (aircraft100)
ç±»åˆ«æ•°: 100
å®éªŒç›®å½•: ./experiments/aircraft100
å½“å‰ä½¿ç”¨çš„ GPU ä¸ºï¼š0

=== Experiment Start Time: 2025-11-22 22:24:48 ===

=== Experiment Arguments ===
{'confidence_threshold': 0.8,
 'config_file_env': './configs/env_machine.yml',
 'config_file_expt': './configs/expts/aircraft100_all.yml',
 'fusion_method': 'concat',
 'gallery_out': None,
 'knowledge_base_dir': './experiments/aircraft100/knowledge_base',
 'kshot': None,
 'mode': 'build_knowledge_base',
 'num_per_category': '4',
 'query_image': None,
 'region_num': None,
 'results_out': './results.json',
 'similarity_threshold': 0.7,
 'superclass': None,
 'test_data_dir': None,
 'use_slow_thinking': None}
=== Configuration (cfg) ===
{'batch_size': 64,
 'clustering_method': 'multi_clip_voting',
 'data_dir': './datasets/fgvc_aircraft',
 'dataset_name': 'aircraft',
 'device': 'cuda',
 'device_count': '1',
 'device_id': '0',
 'experiment': 5.0,
 'expt_dir': './experiments/aircraft100',
 'expt_dir_describe': './experiments/aircraft100/describe',
 'expt_dir_gallery': './experiments/aircraft100/gallery',
 'expt_dir_grouping': './experiments/aircraft100/grouping',
 'expt_dir_guess': './experiments/aircraft100/guess',
 'host': 'xiao',
 'image_size': 224,
 'model_size': 'ViT-B/16',
 'model_size_mllm': 'Qwen2.5-VL-7B',
 'model_size_vqa': 'OPT6.7B-COCO',
 'model_type_llm': 'gpt-3.5-turbo',
 'num_base': 50,
 'num_classes': 100,
 'num_novel': 50,
 'num_workers': 16,
 'path_descriptions': './experiments/aircraft100/gallery/aircraft_image_descriptions_attn',
 'path_identify_answers': './experiments/aircraft100/identify',
 'path_llm_gussed_names': './experiments/aircraft100/guess/aircraft_llm_gussed_names',
 'path_llm_prompts': './experiments/aircraft100/describe/aircraft_llm_prompts',
 'path_llm_replies_jsoned': './experiments/aircraft100/guess/aircraft_llm_replies_jsoned',
 'path_llm_replies_raw': './experiments/aircraft100/guess/aircraft_llm_replies_raw',
 'path_references': './experiments/aircraft100/gallery/aircraft_image_references',
 'path_regions': './experiments/aircraft100/gallery/aircraft_image_regions',
 'path_vqa_answers': './experiments/aircraft100/describe/aircraft_attributes_pairs',
 'path_vqa_questions': './experiments/aircraft100/describe/aircraft_vqa_questions_ours',
 'seed': 1,
 'setup': 'ours',
 'verbose': False}

================= å¿«æ…¢æ€è€ƒç³»ç»Ÿåˆå§‹åŒ– =================
ğŸ–¥ï¸ è®¾å¤‡: cuda
ğŸ¤– MLLM æ¨¡å‹æ ‡ç­¾: Qwen2.5-VL-7B
ğŸ¤– MLLM æ¨¡å‹åç§°: Qwen2.5-VL-7B
ğŸ–¼ï¸ å›¾åƒç¼–ç å™¨: ./models/Clip/clip-vit-base-patch32
ğŸ“„ æ–‡æœ¬ç¼–ç å™¨: ./models/Clip/clip-vit-base-patch32
ğŸ“š æ•°æ®é›†ä¿¡æ¯:
{
    "full_name": "aircraft100",
    "num_classes": 100,
    "config_file": "aircraft100_all.yml",
    "data_dir": "fgvc_aircraft",
    "experiment_dir": "aircraft100",
    "stats_file": "aircraft100/knowledge_base/stats.json",
    "experiments_root": "./experiments",
    "stats_file_full": "./experiments/aircraft100/knowledge_base/stats.json",
    "experiment_dir_full": "./experiments/aircraft100"
}
====================================================

ğŸš€åˆå§‹åŒ–MLLMæ¨¡å‹...

================= æ¨¡å‹åˆå§‹åŒ–ï¼ˆMLLMBotï¼‰ =================
ğŸ“Œ æ¨¡å‹æ ‡è¯†ï¼ˆmodel_tagï¼‰: Qwen2.5-VL-7B
ğŸ“Œ æ¨¡å‹åç§°ï¼ˆmodel_nameï¼‰: Qwen2.5-VL-7B
ğŸ“ æœ¬åœ°æ¨¡å‹è·¯å¾„: ./models/Qwen/Qwen2.5-VL-7B-Instruct
ğŸ–¥ï¸ è®¾å¤‡: GPU - cuda:0
ğŸ¤– ä½¿ç”¨ 8bit æ¨ç†: å¦
ğŸ” ä½¿ç”¨æ•°æ®ç±»å‹: float32ï¼ˆFP32ï¼‰
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [00:02<00:08,  2.01s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:04<00:06,  2.30s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:06<00:04,  2.32s/it]scripts/run_pipeline.sh: line 243: 1798468 Killed                  python discovering.py --mode=build_knowledge_base --config_file_env=./configs/env_machine.yml --config_file_expt=./configs/expts/${CONFIG_FILE_DS} --num_per_category=${KSHOT} --knowledge_base_dir=${KNOWLEDGE_BASE_DIR}
[ERROR] Step1: çŸ¥è¯†åº“æ„å»ºå¤±è´¥ï¼Œé€€å‡º pipeline (exit code=137)
