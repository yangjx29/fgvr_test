/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.

=== Experiment Start Time: 2025-11-22 09:59:54 ===

=== Experiment Arguments ===
{'confidence_threshold': 0.8,
 'config_file_env': './configs/env_machine.yml',
 'config_file_expt': './configs/expts/car196_all.yml',
 'fusion_method': 'concat',
 'gallery_out': None,
 'knowledge_base_dir': './experiments/car196/knowledge_base',
 'kshot': None,
 'mode': 'build_knowledge_base',
 'num_per_category': '4',
 'query_image': None,
 'region_num': None,
 'results_out': './results.json',
 'similarity_threshold': 0.7,
 'superclass': None,
 'test_data_dir': None,
 'use_slow_thinking': None}
=== Configuration (cfg) ===
{'batch_size': 32,
 'clustering_method': 'multi_clip_voting',
 'data_dir': './datasets/car_196',
 'dataset_name': 'car',
 'device': 'cuda',
 'device_count': '1',
 'device_id': '0',
 'experiment': 5.0,
 'expt_dir': './experiments/car196',
 'expt_dir_describe': './experiments/car196/describe',
 'expt_dir_gallery': './experiments/car196/gallery',
 'expt_dir_grouping': './experiments/car196/grouping',
 'expt_dir_guess': './experiments/car196/guess',
 'host': 'xiao',
 'image_size': 224,
 'model_size': 'ViT-B/16',
 'model_size_mllm': 'Qwen2.5-VL-7B',
 'model_size_vqa': 'OPT6.7B-COCO',
 'model_type_llm': 'gpt-3.5-turbo',
 'num_base': 98,
 'num_classes': 196,
 'num_novel': 98,
 'num_workers': 16,
 'path_descriptions': './experiments/car196/gallery/car_image_descriptions_attn',
 'path_identify_answers': './experiments/car196/identify',
 'path_llm_gussed_names': './experiments/car196/guess/car_llm_gussed_names',
 'path_llm_prompts': './experiments/car196/describe/car_llm_prompts',
 'path_llm_replies_jsoned': './experiments/car196/guess/car_llm_replies_jsoned',
 'path_llm_replies_raw': './experiments/car196/guess/car_llm_replies_raw',
 'path_references': './experiments/car196/gallery/car_image_references',
 'path_regions': './experiments/car196/gallery/car_image_regions',
 'path_vqa_answers': './experiments/car196/describe/car_attributes_pairs',
 'path_vqa_questions': './experiments/car196/describe/car_vqa_questions_ours',
 'seed': 1,
 'setup': 'ours',
 'verbose': False}
初始化MLLM模型...
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:02<00:08,  2.06s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:04<00:06,  2.29s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:06<00:04,  2.37s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:09<00:02,  2.34s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:10<00:00,  1.79s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:10<00:00,  2.02s/it]
local_model_path: ./models/Qwen/Qwen2.5-VL-7B-Instruct
初始化知识库构建器...
初始化快思考模块...
已加载历史统计量: 709 次预测
初始化慢思考模块...
快慢思考系统初始化完成!
构建知识库，包含 196 个类别, dog datasets:196
从 ./experiments/car196/knowledge_base 加载知识库...
知识库已从 ./experiments/car196/knowledge_base 加载
知识库加载完成!
构建知识库...
训练样本包含 196 个类别
开始构建知识库...
构建图像知识库...
  0%|          | 0/196 [00:00<?, ?it/s]  1%|          | 1/196 [00:00<00:59,  3.26it/s]  2%|▏         | 4/196 [00:00<00:18, 10.33it/s]  3%|▎         | 6/196 [00:00<00:16, 11.36it/s]  4%|▍         | 8/196 [00:00<00:13, 13.57it/s]  5%|▌         | 10/196 [00:00<00:14, 13.23it/s]  7%|▋         | 13/196 [00:01<00:13, 13.45it/s]  8%|▊         | 16/196 [00:01<00:11, 15.97it/s]  9%|▉         | 18/196 [00:01<00:11, 15.99it/s] 10%|█         | 20/196 [00:01<00:11, 15.23it/s] 11%|█         | 22/196 [00:02<00:22,  7.90it/s] 13%|█▎        | 25/196 [00:02<00:16, 10.49it/s] 14%|█▍        | 27/196 [00:02<00:21,  7.86it/s] 15%|█▍        | 29/196 [00:02<00:18,  9.11it/s] 16%|█▋        | 32/196 [00:02<00:14, 11.56it/s] 18%|█▊        | 35/196 [00:03<00:14, 10.90it/s] 19%|█▉        | 37/196 [00:03<00:12, 12.26it/s] 20%|██        | 40/196 [00:03<00:11, 14.11it/s] 22%|██▏       | 43/196 [00:03<00:09, 16.29it/s] 23%|██▎       | 45/196 [00:03<00:09, 16.55it/s] 24%|██▍       | 48/196 [00:03<00:07, 19.47it/s] 26%|██▌       | 51/196 [00:03<00:07, 19.03it/s] 28%|██▊       | 54/196 [00:04<00:07, 18.61it/s] 29%|██▊       | 56/196 [00:04<00:10, 13.86it/s] 30%|███       | 59/196 [00:04<00:08, 16.04it/s] 31%|███       | 61/196 [00:04<00:08, 15.60it/s] 32%|███▏      | 63/196 [00:04<00:08, 15.39it/s] 33%|███▎      | 65/196 [00:04<00:08, 15.61it/s] 35%|███▍      | 68/196 [00:05<00:07, 17.13it/s] 36%|███▌      | 70/196 [00:05<00:07, 16.03it/s] 37%|███▋      | 73/196 [00:05<00:07, 17.25it/s] 38%|███▊      | 75/196 [00:05<00:07, 17.14it/s] 40%|███▉      | 78/196 [00:05<00:06, 18.41it/s]处理类别: Ford_Focus_Sedan_2007
类别 Ford_Focus_Sedan_2007 图像特征维度: (512,)
处理类别: Volvo_C30_Hatchback_2012
类别 Volvo_C30_Hatchback_2012 图像特征维度: (512,)
处理类别: Bentley_Continental_GT_Coupe_2012
类别 Bentley_Continental_GT_Coupe_2012 图像特征维度: (512,)
处理类别: GMC_Canyon_Extended_Cab_2012
类别 GMC_Canyon_Extended_Cab_2012 图像特征维度: (512,)
处理类别: GMC_Savana_Van_2012
类别 GMC_Savana_Van_2012 图像特征维度: (512,)
处理类别: Mercedes-Benz_E-Class_Sedan_2012
类别 Mercedes-Benz_E-Class_Sedan_2012 图像特征维度: (512,)
处理类别: BMW_Z4_Convertible_2012
类别 BMW_Z4_Convertible_2012 图像特征维度: (512,)
处理类别: Mazda_Tribute_SUV_2011
类别 Mazda_Tribute_SUV_2011 图像特征维度: (512,)
处理类别: Honda_Accord_Sedan_2012
类别 Honda_Accord_Sedan_2012 图像特征维度: (512,)
处理类别: Chevrolet_Tahoe_Hybrid_SUV_2012
类别 Chevrolet_Tahoe_Hybrid_SUV_2012 图像特征维度: (512,)
处理类别: Nissan_240SX_Coupe_1998
类别 Nissan_240SX_Coupe_1998 图像特征维度: (512,)
处理类别: Jeep_Wrangler_SUV_2012
类别 Jeep_Wrangler_SUV_2012 图像特征维度: (512,)
处理类别: Chevrolet_Silverado_1500_Extended_Cab_2012
类别 Chevrolet_Silverado_1500_Extended_Cab_2012 图像特征维度: (512,)
处理类别: Honda_Accord_Coupe_2012
类别 Honda_Accord_Coupe_2012 图像特征维度: (512,)
处理类别: Ford_Freestar_Minivan_2007
类别 Ford_Freestar_Minivan_2007 图像特征维度: (512,)
处理类别: FIAT_500_Abarth_2012
类别 FIAT_500_Abarth_2012 图像特征维度: (512,)
处理类别: Ford_Edge_SUV_2012
类别 Ford_Edge_SUV_2012 图像特征维度: (512,)
处理类别: AM_General_Hummer_SUV_2000
类别 AM_General_Hummer_SUV_2000 图像特征维度: (512,)
处理类别: Jeep_Compass_SUV_2012
类别 Jeep_Compass_SUV_2012 图像特征维度: (512,)
处理类别: Dodge_Durango_SUV_2012
类别 Dodge_Durango_SUV_2012 图像特征维度: (512,)
处理类别: Bugatti_Veyron_16.4_Convertible_2009
类别 Bugatti_Veyron_16.4_Convertible_2009 图像特征维度: (512,)
处理类别: Chevrolet_Impala_Sedan_2007
类别 Chevrolet_Impala_Sedan_2007 图像特征维度: (512,)
处理类别: Chevrolet_Monte_Carlo_Coupe_2007
类别 Chevrolet_Monte_Carlo_Coupe_2007 图像特征维度: (512,)
处理类别: Ford_F-150_Regular_Cab_2007
类别 Ford_F-150_Regular_Cab_2007 图像特征维度: (512,)
处理类别: Chevrolet_Malibu_Sedan_2007
类别 Chevrolet_Malibu_Sedan_2007 图像特征维度: (512,)
处理类别: BMW_M6_Convertible_2010
类别 BMW_M6_Convertible_2010 图像特征维度: (512,)
处理类别: Hyundai_Sonata_Sedan_2012
类别 Hyundai_Sonata_Sedan_2012 图像特征维度: (512,)
处理类别: Hyundai_Veracruz_SUV_2012
类别 Hyundai_Veracruz_SUV_2012 图像特征维度: (512,)
处理类别: Chevrolet_Sonic_Sedan_2012
类别 Chevrolet_Sonic_Sedan_2012 图像特征维度: (512,)
处理类别: Lamborghini_Diablo_Coupe_2001
类别 Lamborghini_Diablo_Coupe_2001 图像特征维度: (512,)
处理类别: Buick_Regal_GS_2012
类别 Buick_Regal_GS_2012 图像特征维度: (512,)
处理类别: BMW_M5_Sedan_2010
类别 BMW_M5_Sedan_2010 图像特征维度: (512,)
处理类别: Ferrari_458_Italia_Convertible_2012
类别 Ferrari_458_Italia_Convertible_2012 图像特征维度: (512,)
处理类别: Volkswagen_Golf_Hatchback_2012
类别 Volkswagen_Golf_Hatchback_2012 图像特征维度: (512,)
处理类别: Mitsubishi_Lancer_Sedan_2012
类别 Mitsubishi_Lancer_Sedan_2012 图像特征维度: (512,)
处理类别: Ford_E-Series_Wagon_Van_2012
类别 Ford_E-Series_Wagon_Van_2012 图像特征维度: (512,)
处理类别: Toyota_4Runner_SUV_2012
类别 Toyota_4Runner_SUV_2012 图像特征维度: (512,)
处理类别: BMW_X6_SUV_2012
类别 BMW_X6_SUV_2012 图像特征维度: (512,)
处理类别: Buick_Rainier_SUV_2007
类别 Buick_Rainier_SUV_2007 图像特征维度: (512,)
处理类别: Audi_S4_Sedan_2007
类别 Audi_S4_Sedan_2007 图像特征维度: (512,)
处理类别: Lamborghini_Reventon_Coupe_2008
类别 Lamborghini_Reventon_Coupe_2008 图像特征维度: (512,)
处理类别: HUMMER_H2_SUT_Crew_Cab_2009
类别 HUMMER_H2_SUT_Crew_Cab_2009 图像特征维度: (512,)
处理类别: Audi_S5_Coupe_2012
类别 Audi_S5_Coupe_2012 图像特征维度: (512,)
处理类别: BMW_3_Series_Sedan_2012
类别 BMW_3_Series_Sedan_2012 图像特征维度: (512,)
处理类别: BMW_X5_SUV_2007
类别 BMW_X5_SUV_2007 图像特征维度: (512,)
处理类别: Chevrolet_Silverado_1500_Hybrid_Crew_Cab_2012
类别 Chevrolet_Silverado_1500_Hybrid_Crew_Cab_2012 图像特征维度: (512,)
处理类别: Ford_F-150_Regular_Cab_2012
类别 Ford_F-150_Regular_Cab_2012 图像特征维度: (512,)
处理类别: Chevrolet_Silverado_1500_Classic_Extended_Cab_2007
类别 Chevrolet_Silverado_1500_Classic_Extended_Cab_2007 图像特征维度: (512,)
处理类别: Dodge_Ram_Pickup_3500_Crew_Cab_2010
类别 Dodge_Ram_Pickup_3500_Crew_Cab_2010 图像特征维度: (512,)
处理类别: Scion_xD_Hatchback_2012
类别 Scion_xD_Hatchback_2012 图像特征维度: (512,)
处理类别: Bentley_Arnage_Sedan_2009
类别 Bentley_Arnage_Sedan_2009 图像特征维度: (512,)
处理类别: Dodge_Ram_Pickup_3500_Quad_Cab_2009
类别 Dodge_Ram_Pickup_3500_Quad_Cab_2009 图像特征维度: (512,)
处理类别: Hyundai_Tucson_SUV_2012
类别 Hyundai_Tucson_SUV_2012 图像特征维度: (512,)
处理类别: Ferrari_458_Italia_Coupe_2012
类别 Ferrari_458_Italia_Coupe_2012 图像特征维度: (512,)
处理类别: Aston_Martin_Virage_Convertible_2012
类别 Aston_Martin_Virage_Convertible_2012 图像特征维度: (512,)
处理类别: Chevrolet_Express_Van_2007
类别 Chevrolet_Express_Van_2007 图像特征维度: (512,)
处理类别: Volkswagen_Golf_Hatchback_1991
类别 Volkswagen_Golf_Hatchback_1991 图像特征维度: (512,)
处理类别: Hyundai_Accent_Sedan_2012
类别 Hyundai_Accent_Sedan_2012 图像特征维度: (512,)
处理类别: FIAT_500_Convertible_2012
类别 FIAT_500_Convertible_2012 图像特征维度: (512,)
处理类别: Mercedes-Benz_SL-Class_Coupe_2009
类别 Mercedes-Benz_SL-Class_Coupe_2009 图像特征维度: (512,)
处理类别: Audi_S4_Sedan_2012
类别 Audi_S4_Sedan_2012 图像特征维度: (512,)
处理类别: Chevrolet_Avalanche_Crew_Cab_2012
类别 Chevrolet_Avalanche_Crew_Cab_2012 图像特征维度: (512,)
处理类别: McLaren_MP4-12C_Coupe_2012
类别 McLaren_MP4-12C_Coupe_2012 图像特征维度: (512,)
处理类别: Aston_Martin_V8_Vantage_Convertible_2012
类别 Aston_Martin_V8_Vantage_Convertible_2012 图像特征维度: (512,)
处理类别: Chevrolet_Camaro_Convertible_2012
类别 Chevrolet_Camaro_Convertible_2012 图像特征维度: (512,)
处理类别: GMC_Yukon_Hybrid_SUV_2012
类别 GMC_Yukon_Hybrid_SUV_2012 图像特征维度: (512,)
处理类别: Acura_Integra_Type_R_2001
类别 Acura_Integra_Type_R_2001 图像特征维度: (512,)
处理类别: Honda_Odyssey_Minivan_2012
类别 Honda_Odyssey_Minivan_2012 图像特征维度: (512,)
处理类别: Bentley_Continental_Flying_Spur_Sedan_2007
类别 Bentley_Continental_Flying_Spur_Sedan_2007 图像特征维度: (512,)
处理类别: Ford_Ranger_SuperCab_2011
类别 Ford_Ranger_SuperCab_2011 图像特征维度: (512,)
处理类别: BMW_X3_SUV_2012
类别 BMW_X3_SUV_2012 图像特征维度: (512,)
处理类别: Hyundai_Elantra_Sedan_2007
类别 Hyundai_Elantra_Sedan_2007 图像特征维度: (512,)
处理类别: Bentley_Mulsanne_Sedan_2011
类别 Bentley_Mulsanne_Sedan_2011 图像特征维度: (512,)
处理类别: Chevrolet_Traverse_SUV_2012
类别 Chevrolet_Traverse_SUV_2012 图像特征维度: (512,)
处理类别: Jeep_Liberty_SUV_2012
类别 Jeep_Liberty_SUV_2012 图像特征维度: (512,)
处理类别: BMW_M3_Coupe_2012
类别 BMW_M3_Coupe_2012 图像特征维度: (512,)
处理类别: Bugatti_Veyron_16.4_Coupe_2009
类别 Bugatti_Veyron_16.4_Coupe_2009 图像特征维度: (512,)
处理类别: Chrysler_300_SRT-8_2010
类别 Chrysler_300_SRT-8_2010 图像特征维度: (512,)
处理类别: Acura_TL_Sedan_2012
类别 Acura_TL_Sedan_2012 图像特征维度: (512,)
处理类别: Chevrolet_Corvette_Convertible_2012
 41%|████      | 80/196 [00:05<00:06, 18.05it/s] 42%|████▏     | 83/196 [00:05<00:05, 19.38it/s] 43%|████▎     | 85/196 [00:06<00:06, 17.24it/s] 44%|████▍     | 87/196 [00:06<00:06, 15.58it/s] 45%|████▌     | 89/196 [00:06<00:07, 15.01it/s] 47%|████▋     | 92/196 [00:06<00:06, 17.20it/s] 48%|████▊     | 95/196 [00:06<00:06, 15.59it/s] 49%|████▉     | 97/196 [00:06<00:06, 15.27it/s] 51%|█████     | 99/196 [00:07<00:07, 12.75it/s] 52%|█████▏    | 101/196 [00:07<00:07, 13.14it/s] 53%|█████▎    | 104/196 [00:07<00:05, 15.53it/s] 54%|█████▍    | 106/196 [00:07<00:05, 15.83it/s] 56%|█████▌    | 109/196 [00:07<00:04, 18.49it/s] 57%|█████▋    | 112/196 [00:07<00:04, 18.88it/s] 58%|█████▊    | 114/196 [00:08<00:06, 12.76it/s] 60%|█████▉    | 117/196 [00:08<00:05, 14.81it/s] 61%|██████    | 120/196 [00:08<00:04, 17.36it/s] 63%|██████▎   | 123/196 [00:08<00:03, 18.80it/s] 64%|██████▍   | 126/196 [00:08<00:03, 19.35it/s] 66%|██████▌   | 129/196 [00:08<00:03, 21.35it/s] 67%|██████▋   | 132/196 [00:08<00:02, 21.74it/s] 69%|██████▉   | 135/196 [00:08<00:02, 22.05it/s] 70%|███████   | 138/196 [00:09<00:02, 20.66it/s] 72%|███████▏  | 141/196 [00:09<00:02, 20.56it/s] 73%|███████▎  | 144/196 [00:09<00:02, 19.91it/s] 75%|███████▌  | 147/196 [00:09<00:02, 20.75it/s] 77%|███████▋  | 150/196 [00:09<00:02, 19.31it/s] 78%|███████▊  | 152/196 [00:09<00:02, 19.24it/s] 79%|███████▊  | 154/196 [00:09<00:02, 17.63it/s] 80%|███████▉  | 156/196 [00:10<00:02, 15.26it/s]类别 Chevrolet_Corvette_Convertible_2012 图像特征维度: (512,)
处理类别: Toyota_Sequoia_SUV_2012
类别 Toyota_Sequoia_SUV_2012 图像特征维度: (512,)
处理类别: Ram_C_V_Cargo_Van_Minivan_2012
类别 Ram_C_V_Cargo_Van_Minivan_2012 图像特征维度: (512,)
处理类别: Ferrari_FF_Coupe_2012
类别 Ferrari_FF_Coupe_2012 图像特征维度: (512,)
处理类别: Porsche_Panamera_Sedan_2012
类别 Porsche_Panamera_Sedan_2012 图像特征维度: (512,)
处理类别: Suzuki_SX4_Sedan_2012
类别 Suzuki_SX4_Sedan_2012 图像特征维度: (512,)
处理类别: Dodge_Caliber_Wagon_2012
类别 Dodge_Caliber_Wagon_2012 图像特征维度: (512,)
处理类别: Jeep_Patriot_SUV_2012
类别 Jeep_Patriot_SUV_2012 图像特征维度: (512,)
处理类别: Volkswagen_Beetle_Hatchback_2012
类别 Volkswagen_Beetle_Hatchback_2012 图像特征维度: (512,)
处理类别: Dodge_Caravan_Minivan_1997
类别 Dodge_Caravan_Minivan_1997 图像特征维度: (512,)
处理类别: Cadillac_SRX_SUV_2012
类别 Cadillac_SRX_SUV_2012 图像特征维度: (512,)
处理类别: BMW_ActiveHybrid_5_Sedan_2012
类别 BMW_ActiveHybrid_5_Sedan_2012 图像特征维度: (512,)
处理类别: Audi_100_Sedan_1994
类别 Audi_100_Sedan_1994 图像特征维度: (512,)
处理类别: Chrysler_Crossfire_Convertible_2008
类别 Chrysler_Crossfire_Convertible_2008 图像特征维度: (512,)
处理类别: smart_fortwo_Convertible_2012
类别 smart_fortwo_Convertible_2012 图像特征维度: (512,)
处理类别: Tesla_Model_S_Sedan_2012
类别 Tesla_Model_S_Sedan_2012 图像特征维度: (512,)
处理类别: Ford_Mustang_Convertible_2007
类别 Ford_Mustang_Convertible_2007 图像特征维度: (512,)
处理类别: Ferrari_California_Convertible_2012
类别 Ferrari_California_Convertible_2012 图像特征维度: (512,)
处理类别: Mercedes-Benz_S-Class_Sedan_2012
类别 Mercedes-Benz_S-Class_Sedan_2012 图像特征维度: (512,)
处理类别: Nissan_Juke_Hatchback_2012
类别 Nissan_Juke_Hatchback_2012 图像特征维度: (512,)
处理类别: Toyota_Corolla_Sedan_2012
类别 Toyota_Corolla_Sedan_2012 图像特征维度: (512,)
处理类别: Buick_Verano_Sedan_2012
类别 Buick_Verano_Sedan_2012 图像特征维度: (512,)
处理类别: MINI_Cooper_Roadster_Convertible_2012
类别 MINI_Cooper_Roadster_Convertible_2012 图像特征维度: (512,)
处理类别: Maybach_Landaulet_Convertible_2012
类别 Maybach_Landaulet_Convertible_2012 图像特征维度: (512,)
处理类别: Audi_S6_Sedan_2011
类别 Audi_S6_Sedan_2011 图像特征维度: (512,)
处理类别: Spyker_C8_Convertible_2009
类别 Spyker_C8_Convertible_2009 图像特征维度: (512,)
处理类别: Audi_100_Wagon_1994
类别 Audi_100_Wagon_1994 图像特征维度: (512,)
处理类别: Dodge_Charger_Sedan_2012
类别 Dodge_Charger_Sedan_2012 图像特征维度: (512,)
处理类别: Dodge_Dakota_Crew_Cab_2010
类别 Dodge_Dakota_Crew_Cab_2010 图像特征维度: (512,)
处理类别: Mercedes-Benz_C-Class_Sedan_2012
类别 Mercedes-Benz_C-Class_Sedan_2012 图像特征维度: (512,)
处理类别: Dodge_Charger_SRT-8_2009
类别 Dodge_Charger_SRT-8_2009 图像特征维度: (512,)
处理类别: Volvo_240_Sedan_1993
类别 Volvo_240_Sedan_1993 图像特征维度: (512,)
处理类别: Hyundai_Elantra_Touring_Hatchback_2012
类别 Hyundai_Elantra_Touring_Hatchback_2012 图像特征维度: (512,)
处理类别: Audi_R8_Coupe_2012
类别 Audi_R8_Coupe_2012 图像特征维度: (512,)
处理类别: Eagle_Talon_Hatchback_1998
类别 Eagle_Talon_Hatchback_1998 图像特征维度: (512,)
处理类别: Infiniti_G_Coupe_IPL_2012
类别 Infiniti_G_Coupe_IPL_2012 图像特征维度: (512,)
处理类别: Isuzu_Ascender_SUV_2008
类别 Isuzu_Ascender_SUV_2008 图像特征维度: (512,)
处理类别: Ford_Expedition_EL_SUV_2009
类别 Ford_Expedition_EL_SUV_2009 图像特征维度: (512,)
处理类别: Cadillac_CTS-V_Sedan_2012
类别 Cadillac_CTS-V_Sedan_2012 图像特征维度: (512,)
处理类别: Chevrolet_Corvette_Ron_Fellows_Edition_Z06_2007
类别 Chevrolet_Corvette_Ron_Fellows_Edition_Z06_2007 图像特征维度: (512,)
处理类别: Dodge_Magnum_Wagon_2008
类别 Dodge_Magnum_Wagon_2008 图像特征维度: (512,)
处理类别: Chrysler_PT_Cruiser_Convertible_2008
类别 Chrysler_PT_Cruiser_Convertible_2008 图像特征维度: (512,)
处理类别: BMW_1_Series_Convertible_2012
类别 BMW_1_Series_Convertible_2012 图像特征维度: (512,)
处理类别: Chevrolet_Corvette_ZR1_2012
类别 Chevrolet_Corvette_ZR1_2012 图像特征维度: (512,)
处理类别: Rolls-Royce_Phantom_Sedan_2012
类别 Rolls-Royce_Phantom_Sedan_2012 图像特征维度: (512,)
处理类别: Infiniti_QX56_SUV_2011
类别 Infiniti_QX56_SUV_2011 图像特征维度: (512,)
处理类别: Land_Rover_Range_Rover_SUV_2012
类别 Land_Rover_Range_Rover_SUV_2012 图像特征维度: (512,)
处理类别: Audi_TTS_Coupe_2012
类别 Audi_TTS_Coupe_2012 图像特征维度: (512,)
处理类别: Geo_Metro_Convertible_1993
类别 Geo_Metro_Convertible_1993 图像特征维度: (512,)
处理类别: Audi_V8_Sedan_1994
类别 Audi_V8_Sedan_1994 图像特征维度: (512,)
处理类别: Acura_TL_Type-S_2008
类别 Acura_TL_Type-S_2008 图像特征维度: (512,)
处理类别: Honda_Odyssey_Minivan_2007
类别 Honda_Odyssey_Minivan_2007 图像特征维度: (512,)
处理类别: Land_Rover_LR2_SUV_2012
类别 Land_Rover_LR2_SUV_2012 图像特征维度: (512,)
处理类别: Jeep_Grand_Cherokee_SUV_2012
类别 Jeep_Grand_Cherokee_SUV_2012 图像特征维度: (512,)
处理类别: Chevrolet_Malibu_Hybrid_Sedan_2010
类别 Chevrolet_Malibu_Hybrid_Sedan_2010 图像特征维度: (512,)
处理类别: Rolls-Royce_Phantom_Drophead_Coupe_Convertible_2012
类别 Rolls-Royce_Phantom_Drophead_Coupe_Convertible_2012 图像特征维度: (512,)
处理类别: Chrysler_Sebring_Convertible_2010
类别 Chrysler_Sebring_Convertible_2010 图像特征维度: (512,)
处理类别: Nissan_Leaf_Hatchback_2012
类别 Nissan_Leaf_Hatchback_2012 图像特征维度: (512,)
处理类别: Jaguar_XK_XKR_2012
类别 Jaguar_XK_XKR_2012 图像特征维度: (512,)
处理类别: Ford_F-450_Super_Duty_Crew_Cab_2012
类别 Ford_F-450_Super_Duty_Crew_Cab_2012 图像特征维度: (512,)
处理类别: Bentley_Continental_GT_Coupe_2007
类别 Bentley_Continental_GT_Coupe_2007 图像特征维度: (512,)
处理类别: Audi_TT_RS_Coupe_2012
类别 Audi_TT_RS_Coupe_2012 图像特征维度: (512,)
处理类别: Audi_RS_4_Convertible_2008
类别 Audi_RS_4_Convertible_2008 图像特征维度: (512,)
处理类别: Spyker_C8_Coupe_2009
类别 Spyker_C8_Coupe_2009 图像特征维度: (512,)
处理类别: Lamborghini_Aventador_Coupe_2012
类别 Lamborghini_Aventador_Coupe_2012 图像特征维度: (512,)
处理类别: Dodge_Sprinter_Cargo_Van_2009
类别 Dodge_Sprinter_Cargo_Van_2009 图像特征维度: (512,)
处理类别: Dodge_Journey_SUV_2012
类别 Dodge_Journey_SUV_2012 图像特征维度: (512,)
处理类别: Hyundai_Santa_Fe_SUV_2012
类别 Hyundai_Santa_Fe_SUV_2012 图像特征维度: (512,)
处理类别: Hyundai_Genesis_Sedan_2012
类别 Hyundai_Genesis_Sedan_2012 图像特征维度: (512,)
处理类别: BMW_6_Series_Convertible_2007
类别 BMW_6_Series_Convertible_2007 图像特征维度: (512,)
处理类别: Acura_ZDX_Hatchback_2012
类别 Acura_ZDX_Hatchback_2012 图像特征维度: (512,)
处理类别: Lamborghini_Gallardo_LP_570-4_Superleggera_2012
类别 Lamborghini_Gallardo_LP_570-4_Superleggera_2012 图像特征维度: (512,)
处理类别: BMW_3_Series_Wagon_2012
类别 BMW_3_Series_Wagon_2012 图像特征维度: (512,)
处理类别: Chevrolet_Cobalt_SS_2010
类别 Chevrolet_Cobalt_SS_2010 图像特征维度: (512,)
处理类别: Suzuki_Aerio_Sedan_2007
类别 Suzuki_Aerio_Sedan_2007 图像特征维度: (512,)
处理类别: Nissan_NV_Passenger_Van_2012
类别 Nissan_NV_Passenger_Van_2012 图像特征维度: (512,)
处理类别: Ford_GT_Coupe_2006
类别 Ford_GT_Coupe_2006 图像特征维度: (512,)
处理类别: Hyundai_Sonata_Hybrid_Sedan_2012
类别 Hyundai_Sonata_Hybrid_Sedan_2012 图像特征维度: (512,)
处理类别: Chrysler_Town_and_Country_Minivan_2012
 81%|████████  | 158/196 [00:10<00:02, 15.79it/s] 82%|████████▏ | 161/196 [00:10<00:01, 18.36it/s] 83%|████████▎ | 163/196 [00:10<00:01, 18.44it/s] 84%|████████▍ | 165/196 [00:10<00:01, 17.46it/s] 86%|████████▌ | 168/196 [00:10<00:01, 19.15it/s] 87%|████████▋ | 170/196 [00:10<00:01, 19.07it/s] 88%|████████▊ | 172/196 [00:10<00:01, 18.25it/s] 89%|████████▉ | 175/196 [00:11<00:01, 20.53it/s] 91%|█████████ | 178/196 [00:11<00:00, 21.04it/s] 92%|█████████▏| 181/196 [00:11<00:00, 22.22it/s] 94%|█████████▍| 184/196 [00:11<00:00, 23.43it/s] 95%|█████████▌| 187/196 [00:11<00:00, 19.08it/s] 97%|█████████▋| 190/196 [00:11<00:00, 18.14it/s] 98%|█████████▊| 193/196 [00:11<00:00, 19.84it/s]100%|██████████| 196/196 [00:12<00:00, 19.07it/s]100%|██████████| 196/196 [00:12<00:00, 16.14it/s]
类别 Chrysler_Town_and_Country_Minivan_2012 图像特征维度: (512,)
处理类别: GMC_Acadia_SUV_2012
类别 GMC_Acadia_SUV_2012 图像特征维度: (512,)
处理类别: Chevrolet_Silverado_2500HD_Regular_Cab_2012
类别 Chevrolet_Silverado_2500HD_Regular_Cab_2012 图像特征维度: (512,)
处理类别: Mercedes-Benz_Sprinter_Van_2012
类别 Mercedes-Benz_Sprinter_Van_2012 图像特征维度: (512,)
处理类别: Chevrolet_TrailBlazer_SS_2009
类别 Chevrolet_TrailBlazer_SS_2009 图像特征维度: (512,)
处理类别: Plymouth_Neon_Coupe_1999
类别 Plymouth_Neon_Coupe_1999 图像特征维度: (512,)
处理类别: Hyundai_Veloster_Hatchback_2012
类别 Hyundai_Veloster_Hatchback_2012 图像特征维度: (512,)
处理类别: Fisker_Karma_Sedan_2012
类别 Fisker_Karma_Sedan_2012 图像特征维度: (512,)
处理类别: Audi_S5_Convertible_2012
类别 Audi_S5_Convertible_2012 图像特征维度: (512,)
处理类别: Bentley_Continental_Supersports_Conv._Convertible_2012
类别 Bentley_Continental_Supersports_Conv._Convertible_2012 图像特征维度: (512,)
处理类别: Hyundai_Azera_Sedan_2012
类别 Hyundai_Azera_Sedan_2012 图像特征维度: (512,)
处理类别: Suzuki_SX4_Hatchback_2012
类别 Suzuki_SX4_Hatchback_2012 图像特征维度: (512,)
处理类别: Audi_TT_Hatchback_2011
类别 Audi_TT_Hatchback_2011 图像特征维度: (512,)
处理类别: Volvo_XC90_SUV_2007
类别 Volvo_XC90_SUV_2007 图像特征维度: (512,)
处理类别: Aston_Martin_Virage_Coupe_2012
类别 Aston_Martin_Virage_Coupe_2012 图像特征维度: (512,)
处理类别: Chevrolet_HHR_SS_2010
类别 Chevrolet_HHR_SS_2010 图像特征维度: (512,)
处理类别: Acura_TSX_Sedan_2012
类别 Acura_TSX_Sedan_2012 图像特征维度: (512,)
处理类别: Daewoo_Nubira_Wagon_2002
类别 Daewoo_Nubira_Wagon_2002 图像特征维度: (512,)
处理类别: Dodge_Durango_SUV_2007
类别 Dodge_Durango_SUV_2007 图像特征维度: (512,)
处理类别: Lincoln_Town_Car_Sedan_2011
类别 Lincoln_Town_Car_Sedan_2011 图像特征维度: (512,)
处理类别: BMW_1_Series_Coupe_2012
类别 BMW_1_Series_Coupe_2012 图像特征维度: (512,)
处理类别: Dodge_Challenger_SRT8_2011
类别 Dodge_Challenger_SRT8_2011 图像特征维度: (512,)
处理类别: Rolls-Royce_Ghost_Sedan_2012
类别 Rolls-Royce_Ghost_Sedan_2012 图像特征维度: (512,)
处理类别: Chrysler_Aspen_SUV_2009
类别 Chrysler_Aspen_SUV_2009 图像特征维度: (512,)
处理类别: GMC_Terrain_SUV_2012
类别 GMC_Terrain_SUV_2012 图像特征维度: (512,)
处理类别: HUMMER_H3T_Crew_Cab_2010
类别 HUMMER_H3T_Crew_Cab_2010 图像特征维度: (512,)
处理类别: Mercedes-Benz_300-Class_Convertible_1993
类别 Mercedes-Benz_300-Class_Convertible_1993 图像特征维度: (512,)
处理类别: Ford_Fiesta_Sedan_2012
类别 Ford_Fiesta_Sedan_2012 图像特征维度: (512,)
处理类别: Buick_Enclave_SUV_2012
类别 Buick_Enclave_SUV_2012 图像特征维度: (512,)
处理类别: Chevrolet_Silverado_1500_Regular_Cab_2012
类别 Chevrolet_Silverado_1500_Regular_Cab_2012 图像特征维度: (512,)
处理类别: Suzuki_Kizashi_Sedan_2012
类别 Suzuki_Kizashi_Sedan_2012 图像特征维度: (512,)
处理类别: Toyota_Camry_Sedan_2012
类别 Toyota_Camry_Sedan_2012 图像特征维度: (512,)
处理类别: Aston_Martin_V8_Vantage_Coupe_2012
类别 Aston_Martin_V8_Vantage_Coupe_2012 图像特征维度: (512,)
处理类别: Chevrolet_Express_Cargo_Van_2007
类别 Chevrolet_Express_Cargo_Van_2007 图像特征维度: (512,)
处理类别: Dodge_Caliber_Wagon_2007
类别 Dodge_Caliber_Wagon_2007 图像特征维度: (512,)
处理类别: Cadillac_Escalade_EXT_Crew_Cab_2007
类别 Cadillac_Escalade_EXT_Crew_Cab_2007 图像特征维度: (512,)
处理类别: Audi_A5_Coupe_2012
类别 Audi_A5_Coupe_2012 图像特征维度: (512,)
处理类别: Dodge_Dakota_Club_Cab_2007
类别 Dodge_Dakota_Club_Cab_2007 图像特征维度: (512,)
处理类别: Acura_RL_Sedan_2012
类别 Acura_RL_Sedan_2012 图像特征维度: (512,)
构建文本知识库...
  0%|          | 0/196 [00:00<?, ?it/s]/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:629: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `1e-06` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
  0%|          | 0/196 [04:20<?, ?it/s]
处理类别: Ford_Focus_Sedan_2007
wiki desc: Description for Ford_Focus_Sedan_2007 category.
推理前显存: 已分配=32.44GB, 已保留=32.80GB
警告: 显存使用过高，强制清理...
推理后显存: 已分配=32.44GB
MLLM description: The Ford Focus Sedan 2007 is a compact car with a sleek and aerodynamic design. Here's a breakdown of its distinctive features:

1. **Distinctive Physical Features**: The Ford Focus has a low-slung profile with a long hood and short rear deck, giving it a sporty appearance. It features a prominent grille with the Ford logo at the center, flanked by sharp, angular headlights. The car has a set of five-spoke alloy wheels, which add to its modern look.

2. **Color Patterns and Markings**: The images show the Ford Focus in three different colors: maroon, white, and silver. Each color variant has a glossy finish, reflecting light and emphasizing the car's curves. The maroon model has a bold and vibrant appearance, while the white and silver models have a more understated elegance.

3. **Size and Proportions**: The Ford Focus is a compact sedan, measuring approximately 168 inches in length, 69 inches in width, and 56 inches in height. Its proportions are balanced, with a slightly longer wheelbase than its rivals, providing ample interior space. The car's stance is low and wide, enhancing its stability and handling.

4. **Behavioral Characteristics
Traceback (most recent call last):
  File "/home/hdl/project/fgvr_test/discovering.py", line 429, in <module>
    image_kb, text_kb = system.build_knowledge_base(
  File "/home/hdl/project/fgvr_test/fast_slow_thinking_system.py", line 136, in build_knowledge_base
    image_kb, text_kb = self.kb_builder.build_knowledge_base(
  File "/home/hdl/project/fgvr_test/knowledge_base_builder.py", line 311, in build_knowledge_base
    text_kb = self.build_text_knowledge_base(mllm_bot, train_samples)
  File "/home/hdl/project/fgvr_test/knowledge_base_builder.py", line 277, in build_text_knowledge_base
    self.category_descriptions[category] = description
TypeError: list indices must be integers or slices, not str
