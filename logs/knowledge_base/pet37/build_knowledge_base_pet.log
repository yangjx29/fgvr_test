[INFO] === Build Knowledge Base å¯åŠ¨, YAML é…ç½®æ‘˜è¦ ===
GPU: CUDA_VISIBLE_DEVICES=4  # ä½¿ç”¨çš„GPUç¼–å·
Dataset: pet (num_classes=)  # æ•°æ®é›†åŠç±»åˆ«æ•°
K-shot: 4  # æ¯ç±»æ ·æœ¬æ•° (K-shot learning)
Conda Env: finer_dynamic  # Condaç¯å¢ƒåç§°, Conda Base: /home/hdl/miniconda3  # Condaå®‰è£…è·¯å¾„
Project Root: /home/hdl/project/fgvr_test  # é¡¹ç›®æ ¹ç›®å½•
Knowledge Base Dir: ./experiments/pet37/knowledge_base  # çŸ¥è¯†åº“ç›®å½•
Config File: ./configs/expts/pet37_all.yml  # å®éªŒé…ç½®æ–‡ä»¶
Log File: /home/hdl/project/fgvr_test/logs/knowledge_base/pet37/build_knowledge_base_pet.log  # æ—¥å¿—æ–‡ä»¶è·¯å¾„
Run Mode: build_knowledge_base  # è¿è¡Œæ¨¡å¼
[INFO] ========================================================

/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
å½“å‰æ•°æ®é›†: pet (pet37)
ç±»åˆ«æ•°: 37
å®éªŒç›®å½•: ./experiments/pet37
å½“å‰ä½¿ç”¨çš„ GPU ä¸ºï¼š4

=== Experiment Start Time: 2025-11-22 19:36:05 ===

=== Experiment Arguments ===
{'confidence_threshold': 0.8,
 'config_file_env': './configs/env_machine.yml',
 'config_file_expt': './configs/expts/pet37_all.yml',
 'fusion_method': 'concat',
 'gallery_out': None,
 'knowledge_base_dir': './experiments/pet37/knowledge_base',
 'kshot': None,
 'mode': 'build_knowledge_base',
 'num_per_category': '4',
 'query_image': None,
 'region_num': None,
 'results_out': './results.json',
 'similarity_threshold': 0.7,
 'superclass': None,
 'test_data_dir': None,
 'use_slow_thinking': None}
=== Configuration (cfg) ===
{'batch_size': 16,
 'clustering_method': 'multi_clip_voting',
 'data_dir': './datasets/pet_37',
 'dataset_name': 'pet',
 'device': 'cuda',
 'device_count': '1',
 'device_id': '0',
 'experiment': 5.0,
 'expt_dir': './experiments/pet37',
 'expt_dir_describe': './experiments/pet37/describe',
 'expt_dir_gallery': './experiments/pet37/gallery',
 'expt_dir_grouping': './experiments/pet37/grouping',
 'expt_dir_guess': './experiments/pet37/guess',
 'host': 'xiao',
 'image_size': 224,
 'model_size': 'ViT-B/16',
 'model_size_mllm': 'Qwen2.5-VL-7B',
 'model_size_vqa': 'OPT6.7B-COCO',
 'model_type_llm': 'gpt-3.5-turbo',
 'num_base': 19,
 'num_classes': 37,
 'num_novel': 18,
 'num_workers': 16,
 'path_descriptions': './experiments/pet37/gallery/pet_image_descriptions_attn',
 'path_identify_answers': './experiments/pet37/identify',
 'path_llm_gussed_names': './experiments/pet37/guess/pet_llm_gussed_names',
 'path_llm_prompts': './experiments/pet37/describe/pet_llm_prompts',
 'path_llm_replies_jsoned': './experiments/pet37/guess/pet_llm_replies_jsoned',
 'path_llm_replies_raw': './experiments/pet37/guess/pet_llm_replies_raw',
 'path_references': './experiments/pet37/gallery/pet_image_references',
 'path_regions': './experiments/pet37/gallery/pet_image_regions',
 'path_vqa_answers': './experiments/pet37/describe/pet_attributes_pairs',
 'path_vqa_questions': './experiments/pet37/describe/pet_vqa_questions_ours',
 'seed': 1,
 'setup': 'ours',
 'verbose': False}

================= å¿«æ…¢æ€è€ƒç³»ç»Ÿåˆå§‹åŒ– =================
ğŸ–¥ï¸ è®¾å¤‡: cuda
ğŸ¤– MLLM æ¨¡å‹æ ‡ç­¾: Qwen2.5-VL-7B
ğŸ¤– MLLM æ¨¡å‹åç§°: Qwen2.5-VL-7B
ğŸ–¼ï¸ å›¾åƒç¼–ç å™¨: ./models/Clip/clip-vit-base-patch32
ğŸ“„ æ–‡æœ¬ç¼–ç å™¨: ./models/Clip/clip-vit-base-patch32
ğŸ“š æ•°æ®é›†ä¿¡æ¯:
{
    "full_name": "pet37",
    "num_classes": 37,
    "config_file": "pet37_all.yml",
    "data_dir": "pet_37",
    "experiment_dir": "pet37",
    "stats_file": "pet37/knowledge_base/stats.json",
    "experiments_root": "./experiments",
    "stats_file_full": "./experiments/pet37/knowledge_base/stats.json",
    "experiment_dir_full": "./experiments/pet37"
}
====================================================

ğŸš€åˆå§‹åŒ–MLLMæ¨¡å‹...

================= æ¨¡å‹åˆå§‹åŒ–ï¼ˆMLLMBotï¼‰ =================
ğŸ“Œ æ¨¡å‹æ ‡è¯†ï¼ˆmodel_tagï¼‰: Qwen2.5-VL-7B
ğŸ“Œ æ¨¡å‹åç§°ï¼ˆmodel_nameï¼‰: Qwen2.5-VL-7B
ğŸ“ æœ¬åœ°æ¨¡å‹è·¯å¾„: ./models/Qwen/Qwen2.5-VL-7B-Instruct
ğŸ–¥ï¸ è®¾å¤‡: GPU - cuda:0
ğŸ¤– ä½¿ç”¨ 8bit æ¨ç†: å¦
ğŸ” ä½¿ç”¨æ•°æ®ç±»å‹: float32ï¼ˆFP32ï¼‰
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [00:02<00:08,  2.03s/it]Loading checkpoint shards:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:04<00:06,  2.23s/it]Loading checkpoint shards:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:06<00:04,  2.28s/it]Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:09<00:02,  2.32s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:09<00:00,  1.79s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:09<00:00,  1.99s/it]
/tmp/run_build_knowledge_base_pet_1093231.sh: line 5: 1093303 Killed                  python discovering.py --mode=build_knowledge_base --config_file_env=./configs/env_machine.yml --config_file_expt=./configs/expts/pet37_all.yml --num_per_category=4 --knowledge_base_dir=./experiments/pet37/knowledge_base
