The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
`torch_dtype` is deprecated! Use `dtype` instead!
Namespace(mode='fast_slow', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/dog120_all.yml', num_per_category='3', kshot=None, region_num=None, superclass=None, gallery_out=None, fusion_method='concat', knowledge_base_dir='/data/yjx/MLLM/Try_again/experiments/dog120/knowledge_base', query_image=None, test_data_dir='/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1', results_out='./logs/fast_and_slow_eval.json', use_slow_thinking=None, confidence_threshold=0.8, similarity_threshold=0.7)
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'dog', 'num_classes': 120, 'num_base': 60, 'num_novel': 60, 'seed': 1, 'batch_size': 256, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'OPT6.7B-COCO', 'model_size_mllm': 'Qwen2.5-VL-7B', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'xiao', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/dogs_120', 'expt_dir': './experiments/dog120', 'expt_dir_describe': './experiments/dog120/describe', 'path_vqa_questions': './experiments/dog120/describe/dog_vqa_questions_ours', 'path_vqa_answers': './experiments/dog120/describe/dog_attributes_pairs', 'path_llm_prompts': './experiments/dog120/describe/dog_llm_prompts', 'path_identify_answers': './experiments/dog120/identify', 'expt_dir_guess': './experiments/dog120/guess', 'path_llm_replies_raw': './experiments/dog120/guess/dog_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/dog120/guess/dog_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/dog120/guess/dog_llm_gussed_names', 'expt_dir_gallery': './experiments/dog120/gallery', 'path_references': './experiments/dog120/gallery/dog_image_references', 'path_regions': './experiments/dog120/gallery/dog_image_regions', 'path_descriptions': './experiments/dog120/gallery/dog_image_descriptions_attn', 'expt_dir_grouping': './experiments/dog120/grouping'}
初始化MLLM模型...
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:03,  1.22it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:02,  1.38it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.44it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:02<00:00,  1.47it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:02<00:00,  2.01it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:02<00:00,  1.68it/s]
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
local_model_path: /data/yjx/MLLM/models/Qwen2.5-VL-7B-Instruct
初始化知识库构建器...
初始化快思考模块...
已加载历史统计量: 5196 次预测
初始化慢思考模块...
快慢思考系统初始化完成!
从 /data/yjx/MLLM/Try_again/experiments/dog120/knowledge_base 加载知识库...
Self-Belief已从 /data/yjx/MLLM/Try_again/experiments/dog120/knowledge_base/self_belief.txt 加载
知识库已从 /data/yjx/MLLM/Try_again/experiments/dog120/knowledge_base 加载
知识库加载完成!
初始化经验库构建器...
经验库构建器初始化完成!
加载self_belief:You are an expert in fine-grained visual recognition. Please follow these steps:
    1. Observe: First, look at the overall object and identify its coarse category (e.g., bird, dog, car).
    2. Localize: Then, identify the most discriminative local parts.
    3. Compare: Recall the visual characteristics of the candidate subcategories from your knowledge.
    4. Decide: Based on the match between observed details and subcategory descriptions, choose the most likely class.
    Answer only with the final class name.

Policy Memory (learned strategy rules):
1. Verify the highest similarity score against the observed features before making a final prediction. (Trigger: Whenever the highest similarity score does not align with the observed features in an image.)
2. Carefully analyze the texture of the coat and the overall body structure to distinguish between silky and shaggy breeds. (Trigger: When dealing with small dogs with pointed ears and shaggy coats.)
3. Focus on distinctive facial features and body structure when distinguishing between breeds with similar coat textures and color patterns. (Trigger: When dealing with breeds that share similar coat textures and color patterns, especially those with distinctive facial features or body structures.)

经验库已从 /data/yjx/MLLM/Try_again/experiments/dog120/knowledge_base 加载完成
经验库已设置到慢思考模块
经验库加载完成!
test sample:{'014.Black and tan Coonhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/014.Black_and_tan_Coonhound/014.Black_and_tan_Coonhound_n02089078_1275.jpg'], '044.Boston Bull': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/044.Boston_Bull/044.Boston_Bull_n02096585_5260.jpg'], '043.Dandi Dinmont': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/043.Dandi_Dinmont/043.Dandi_Dinmont_n02096437_730.jpg'], '002.Maltese Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/002.Maltese_Dog/002.Maltese_Dog_n02085936_16355.jpg'], '010.Basset Hound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/010.Basset_Hound/010.Basset_Hound_n02088238_7181.jpg'], '094.French Bulldog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/094.French_Bulldog/094.French_Bulldog_n02108915_7608.jpg'], '009.Afghan Hound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/009.Afghan_Hound/009.Afghan_Hound_n02088094_6035.jpg'], '029.American Staffordshire Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/029.American_Staffordshire_Terrier/029.American_Staffordshire_Terrier_n02093428_3353.jpg'], '035.Norwich Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/035.Norwich_Terrier/035.Norwich_Terrier_n02094258_2911.jpg'], '086.Miniature Pinscher': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/086.Miniature_Pinscher/086.Miniature_Pinscher_n02107312_3227.jpg'], '118.Dhole': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/118.Dhole/118.Dhole_n02115913_1142.jpg'], '072.Schipperke': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/072.Schipperke/072.Schipperke_n02104365_6140.jpg'], '028.Staffordshire Bullterrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/028.Staffordshire_Bullterrier/028.Staffordshire_Bullterrier_n02093256_11732.jpg'], '077.Komondor': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/077.Komondor/077.Komondor_n02105505_3933.jpg'], '079.Shetland Sheepdog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/079.Shetland_Sheepdog/079.Shetland_Sheepdog_n02105855_5719.jpg'], '111.Pembroke': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/111.Pembroke/111.Pembroke_n02113023_6140.jpg'], '058.Chesapeake Bay Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/058.Chesapeake_Bay_Retriever/058.Chesapeake_Bay_Retriever_n02099849_513.jpg'], '003.Pekinese': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/003.Pekinese/003.Pekinese_n02086079_8902.jpg'], '025.Saluki': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/025.Saluki/025.Saluki_n02091831_11021.jpg'], '102.Pug': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/102.Pug/102.Pug_n02110958_1975.jpg'], '062.Irish Setter': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/062.Irish_Setter/062.Irish_Setter_n02100877_5286.jpg'], '066.English Springer Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/066.English_Springer_Spaniel/066.English_Springer_Spaniel_n02102040_5096.jpg'], '057.Labrador Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/057.Labrador_Retriever/057.Labrador_Retriever_n02099712_3613.jpg'], '007.Toy Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/007.Toy_Terrier/007.Toy_Terrier_n02087046_4402.jpg'], '084.German Shepard': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/084.German_Shepard/084.German_Shepard_n02106662_9625.jpg'], '048.Scotch Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/048.Scotch_Terrier/048.Scotch_Terrier_n02097298_2443.jpg'], '090.EntleBucher': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/090.EntleBucher/090.EntleBucher_n02108000_716.jpg'], '059.German Short haired Pointer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/059.German_Short_haired_Pointer/059.German_Short_haired_Pointer_n02100236_4198.jpg'], '047.Standard Schnauzer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/047.Standard_Schnauzer/047.Standard_Schnauzer_n02097209_2194.jpg'], '045.Miniature Schnauzer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/045.Miniature_Schnauzer/045.Miniature_Schnauzer_n02097047_724.jpg'], '004.Shih Tzu': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/004.Shih_Tzu/004.Shih_Tzu_n02086240_1011.jpg'], '064.Brittany': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/064.Brittany/064.Brittany_n02101388_4229.jpg'], '053.Lhasa': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/053.Lhasa/053.Lhasa_n02098413_3033.jpg'], '042.Australian Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/042.Australian_Terrier/042.Australian_Terrier_n02096294_3554.jpg'], '039.Sealyham Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/039.Sealyham_Terrier/039.Sealyham_Terrier_n02095889_610.jpg'], '067.Welsh Springer Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/067.Welsh_Springer_Spaniel/067.Welsh_Springer_Spaniel_n02102177_1128.jpg'], '068.Cocker Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/068.Cocker_Spaniel/068.Cocker_Spaniel_n02102318_6612.jpg'], '089.Appenzeller': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/089.Appenzeller/089.Appenzeller_n02107908_7236.jpg'], '017.Redbone': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/017.Redbone/017.Redbone_n02090379_3996.jpg'], '119.African Hunting Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/119.African_Hunting_Dog/119.African_Hunting_Dog_n02116738_8653.jpg'], '113.Toy Poodle': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/113.Toy_Poodle/113.Toy_Poodle_n02113624_665.jpg'], '027.Weimaraner': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/027.Weimaraner/027.Weimaraner_n02092339_4003.jpg'], '041.Cairn': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/041.Cairn/041.Cairn_n02096177_5206.jpg'], '117.Dingo': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/117.Dingo/117.Dingo_n02115641_925.jpg'], '034.Norfolk Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/034.Norfolk_Terrier/034.Norfolk_Terrier_n02094114_99.jpg'], '114.Miniature Poodle': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/114.Miniature_Poodle/114.Miniature_Poodle_n02113712_2274.jpg'], '085.Doberman': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/085.Doberman/085.Doberman_n02107142_4763.jpg'], '116.Mexican Hairless': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/116.Mexican_Hairless/116.Mexican_Hairless_n02113978_2888.jpg'], '073.Groenendael': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/073.Groenendael/073.Groenendael_n02105056_7068.jpg'], '012.Bloodhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/012.Bloodhound/012.Bloodhound_n02088466_4731.jpg'], '088.Bernese Mountain Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/088.Bernese_Mountain_Dog/088.Bernese_Mountain_Dog_n02107683_6301.jpg'], '095.Great Dane': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/095.Great_Dane/095.Great_Dane_n02109047_34175.jpg'], '040.Airedale': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/040.Airedale/040.Airedale_n02096051_8826.jpg'], '107.Pomeranian': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/107.Pomeranian/107.Pomeranian_n02112018_1577.jpg'], '082.Bouvier des Flandres': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/082.Bouvier_des_Flandres/082.Bouvier_des_Flandres_n02106382_1151.jpg'], '019.Irish Wolfhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/019.Irish_Wolfhound/019.Irish_Wolfhound_n02090721_537.jpg'], '087.Greater Swiss Mountain Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/087.Greater_Swiss_Mountain_Dog/087.Greater_Swiss_Mountain_Dog_n02107574_2436.jpg'], '099.Siberian Husky': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/099.Siberian_Husky/099.Siberian_Husky_n02110185_12380.jpg'], '075.Briard': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/075.Briard/075.Briard_n02105251_2591.jpg'], '033.Irish Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/033.Irish_Terrier/033.Irish_Terrier_n02093991_1276.jpg'], '013.Bluetick': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/013.Bluetick/013.Bluetick_n02088632_4058.jpg'], '061.English Setter': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/061.English_Setter/061.English_Setter_n02100735_3595.jpg'], '020.Italian Greyhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/020.Italian_Greyhound/020.Italian_Greyhound_n02091032_490.jpg'], '112.Cardigan': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/112.Cardigan/112.Cardigan_n02113186_5833.jpg'], '063.Gordon Setter': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/063.Gordon_Setter/063.Gordon_Setter_n02101006_2540.jpg'], '083.Rottweiler': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/083.Rottweiler/083.Rottweiler_n02106550_2197.jpg'], '018.Borzoi': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/018.Borzoi/018.Borzoi_n02090622_6976.jpg'], '008.Rhodesian Ridgeback': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/008.Rhodesian_Ridgeback/008.Rhodesian_Ridgeback_n02087394_3795.jpg'], '050.Silky Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/050.Silky_Terrier/050.Silky_Terrier_n02097658_2329.jpg'], '098.Malamute': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/098.Malamute/098.Malamute_n02110063_12514.jpg'], '070.Irish Water Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/070.Irish_Water_Spaniel/070.Irish_Water_Spaniel_n02102973_2642.jpg'], '100.Affenpinscher': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/100.Affenpinscher/100.Affenpinscher_n02110627_10439.jpg'], '078.Old English Sheepdog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/078.Old_English_Sheepdog/078.Old_English_Sheepdog_n02105641_3531.jpg'], '106.Samoyed': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/106.Samoyed/106.Samoyed_n02111889_6592.jpg'], '022.Ibizian Hound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/022.Ibizian_Hound/022.Ibizian_Hound_n02091244_5818.jpg'], '000.Chihuaha': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/000.Chihuaha/000.Chihuaha_n02085620_3488.jpg'], '023.Norwegian Elkhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/023.Norwegian_Elkhound/023.Norwegian_Elkhound_n02091467_4362.jpg'], '036.Yorkshire Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/036.Yorkshire_Terrier/036.Yorkshire_Terrier_n02094433_730.jpg'], '037.Wirehaired Fox Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/037.Wirehaired_Fox_Terrier/037.Wirehaired_Fox_Terrier_n02095314_3512.jpg'], '011.Beagle': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/011.Beagle/011.Beagle_n02088364_4052.jpg'], '109.Keeshond': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/109.Keeshond/109.Keeshond_n02112350_7087.jpg'], '015.Walker Hound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/015.Walker_Hound/015.Walker_Hound_n02089867_24.jpg'], '101.Basenji': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/101.Basenji/101.Basenji_n02110806_4876.jpg'], '105.Great Pyrenees': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/105.Great_Pyrenees/105.Great_Pyrenees_n02111500_5052.jpg'], '046.Giant Schnauzer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/046.Giant_Schnauzer/046.Giant_Schnauzer_n02097130_5907.jpg'], '006.Papillon': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/006.Papillon/006.Papillon_n02086910_4388.jpg'], '024.Otterhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/024.Otterhound/024.Otterhound_n02091635_2068.jpg'], '031.Border Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/031.Border_Terrier/031.Border_Terrier_n02093754_7403.jpg'], '030.Bedlington Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/030.Bedlington_Terrier/030.Bedlington_Terrier_n02093647_79.jpg'], '051.Soft coated Wheaten Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/051.Soft_coated_Wheaten_Terrier/051.Soft_coated_Wheaten_Terrier_n02098105_838.jpg'], '071.Kuvasz': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/071.Kuvasz/071.Kuvasz_n02104029_662.jpg'], '110.Brabancon Griffon': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/110.Brabancon_Griffon/110.Brabancon_Griffon_n02112706_1554.jpg'], '060.Vizsla': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/060.Vizsla/060.Vizsla_n02100583_6521.jpg'], '026.Scottish Deerhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/026.Scottish_Deerhound/026.Scottish_Deerhound_n02092002_1727.jpg'], '080.Collie': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/080.Collie/080.Collie_n02106030_10057.jpg'], '096.Saint Bernard': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/096.Saint_Bernard/096.Saint_Bernard_n02109525_18948.jpg'], '081.Border Collie': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/081.Border_Collie/081.Border_Collie_n02106166_3882.jpg'], '005.Blenheim Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/005.Blenheim_Spaniel/005.Blenheim_Spaniel_n02086646_3986.jpg'], '038.Lakeland Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/038.Lakeland_Terrier/038.Lakeland_Terrier_n02095570_4782.jpg'], '092.Bull Mastiff': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/092.Bull_Mastiff/092.Bull_Mastiff_n02108422_5221.jpg'], '104.Newfoundland': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/104.Newfoundland/104.Newfoundland_n02111277_8856.jpg'], '076.Kelpie': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/076.Kelpie/076.Kelpie_n02105412_5288.jpg'], '074.Malinois': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/074.Malinois/074.Malinois_n02105162_6106.jpg'], '052.West Highland White Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/052.West_Highland_White_Terrier/052.West_Highland_White_Terrier_n02098286_1632.jpg'], '069.Sussex Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/069.Sussex_Spaniel/069.Sussex_Spaniel_n02102480_5703.jpg'], '091.Boxer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/091.Boxer/091.Boxer_n02108089_14719.jpg'], '108.Chow': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/108.Chow/108.Chow_n02112137_14448.jpg'], '049.Tibetan Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/049.Tibetan_Terrier/049.Tibetan_Terrier_n02097474_5841.jpg'], '056.Golden Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/056.Golden_Retriever/056.Golden_Retriever_n02099601_3360.jpg'], '097.Eskimo Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/097.Eskimo_Dog/097.Eskimo_Dog_n02109961_9973.jpg'], '001.Japanese Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/001.Japanese_Spaniel/001.Japanese_Spaniel_n02085782_1691.jpg'], '115.Standard Poodle': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/115.Standard_Poodle/115.Standard_Poodle_n02113799_1537.jpg'], '065.Clumber': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/065.Clumber/065.Clumber_n02101556_4514.jpg'], '016.English Foxhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/016.English_Foxhound/016.English_Foxhound_n02089973_1907.jpg'], '103.Leonberg': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/103.Leonberg/103.Leonberg_n02111129_1197.jpg'], '021.Whippet': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/021.Whippet/021.Whippet_n02091134_15784.jpg'], '032.Kerry Blue Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/032.Kerry_Blue_Terrier/032.Kerry_Blue_Terrier_n02093859_393.jpg'], '055.Curly coater Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/055.Curly_coater_Retriever/055.Curly_coater_Retriever_n02099429_618.jpg'], '054.Flat coated Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/054.Flat_coated_Retriever/054.Flat_coated_Retriever_n02099267_5540.jpg'], '093.Tibetan Mastiff': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/093.Tibetan_Mastiff/093.Tibetan_Mastiff_n02108551_7523.jpg']}
[fast and slow] 测试数据集包含 120 个类别
Processing fast and slow thinking:   0%|          | 0/120 [00:00<?, ?it/s]Processing fast and slow thinking:   1%|          | 1/120 [00:06<13:25,  6.77s/it]Processing fast and slow thinking:   2%|▏         | 2/120 [00:12<11:47,  6.00s/it]Processing fast and slow thinking:   2%|▎         | 3/120 [00:23<16:21,  8.39s/it]Processing fast and slow thinking:   3%|▎         | 4/120 [00:28<13:59,  7.24s/it]Processing fast and slow thinking:   4%|▍         | 5/120 [00:39<15:59,  8.34s/it]Processing fast and slow thinking:   5%|▌         | 6/120 [00:44<13:49,  7.27s/it]Processing fast and slow thinking:   7%|▋         | 8/120 [00:49<09:24,  5.04s/it]Processing fast and slow thinking:   8%|▊         | 9/120 [00:55<09:32,  5.16s/it]Processing fast and slow thinking:   8%|▊         | 10/120 [01:00<09:28,  5.17s/it]开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/014.Black_and_tan_Coonhound/014.Black_and_tan_Coonhound_n02089078_1275.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/014.Black_and_tan_Coonhound/014.Black_and_tan_Coonhound_n02089078_1275.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Black-and-tan Coonhound', 'Bloodhound', 'Basset Hound', 'Doberman', 'Groenendael', 'Redbone', 'Silky Terrier', 'Rottweiler', 'Vizsla']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Black-and-tan Coonhound (置信度: 0.0000)
总耗时: 6.77秒
succ. pred cate:Black-and-tan Coonhound, true cate:014.Black and tan Coonhound, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/044.Boston_Bull/044.Boston_Bull_n02096585_5260.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/044.Boston_Bull/044.Boston_Bull_n02096585_5260.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Boston Bull', 'American Staffordshire Terrier', 'Staffordshire Bullterrier', 'French Bulldog', 'Clumber', 'Bluetick', 'Shetland Sheepdog', 'Basset Hound', 'Maltese Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Boston Bull (置信度: 0.0000)
总耗时: 5.46秒
succ. pred cate:Boston Bull, true cate:044.Boston Bull, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/043.Dandi_Dinmont/043.Dandi_Dinmont_n02096437_730.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/043.Dandi_Dinmont/043.Dandi_Dinmont_n02096437_730.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Clumber', 'Cocker Spaniel', 'Dandi Dinmont', 'English Setter', 'Sussex Spaniel', 'Otterhound', 'Kuvasz', 'Soft-coated Wheaten Terrier', 'Newfoundland']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Dandi Dinmont (置信度: 0.8000)
总耗时: 11.24秒
succ. pred cate:Dandi Dinmont, true cate:043.Dandi Dinmont, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/002.Maltese_Dog/002.Maltese_Dog_n02085936_16355.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/002.Maltese_Dog/002.Maltese_Dog_n02085936_16355.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['West Highland White Terrier', 'Dandi Dinmont', 'Sealyham Terrier', 'Maltese Dog', 'Miniature Poodle', 'Kuvasz', 'Pekinese', 'Cardigan']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: West Highland White Terrier (置信度: 0.0000)
总耗时: 5.46秒
failed. pred cate:West Highland White Terrier, true cate:002.Maltese Dog, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/010.Basset_Hound/010.Basset_Hound_n02088238_7181.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/010.Basset_Hound/010.Basset_Hound_n02088238_7181.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Beagle', 'Basset Hound', 'Walker Hound', 'English Foxhound', 'Redbone', 'Irish Setter', 'Greater Swiss Mountain Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Basset Hound (置信度: 0.9000)
总耗时: 10.31秒
succ. pred cate:Basset Hound, true cate:010.Basset Hound, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/094.French_Bulldog/094.French_Bulldog_n02108915_7608.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/094.French_Bulldog/094.French_Bulldog_n02108915_7608.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['French Bulldog', 'Staffordshire Bullterrier', 'American Staffordshire Terrier', 'Boston Bull', 'Appenzeller', 'Soft-coated Wheaten Terrier', 'Cairn', 'Lhasa', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: French Bulldog (置信度: 0.0000)
总耗时: 5.20秒
succ. pred cate:French Bulldog, true cate:094.French Bulldog, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/009.Afghan_Hound/009.Afghan_Hound_n02088094_6035.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Afghan Hound (置信度: 0.7355)
总耗时: 0.02秒
succ. pred cate:Afghan Hound, true cate:009.Afghan Hound, used_slow:False, confidence:0.7355
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/029.American_Staffordshire_Terrier/029.American_Staffordshire_Terrier_n02093428_3353.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/029.American_Staffordshire_Terrier/029.American_Staffordshire_Terrier_n02093428_3353.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Staffordshire Bullterrier', 'American Staffordshire Terrier', 'Boxer', 'Clumber', 'Boston Bull', 'Bull Mastiff', 'Yorkshire Terrier', 'Vizsla', 'Bluetick']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: American Staffordshire Terrier (置信度: 0.0000)
总耗时: 5.44秒
succ. pred cate:American Staffordshire Terrier, true cate:029.American Staffordshire Terrier, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/035.Norwich_Terrier/035.Norwich_Terrier_n02094258_2911.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/035.Norwich_Terrier/035.Norwich_Terrier_n02094258_2911.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Yorkshire Terrier', 'Norfolk Terrier', 'Norwich Terrier', 'Silky Terrier', 'Cairn', 'Maltese Dog', 'Airedale', 'Australian Terrier', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Norfolk Terrier (置信度: 0.0000)
总耗时: 5.51秒
succ. pred cate:Norfolk Terrier, true cate:035.Norwich Terrier, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/086.Miniature_Pinscher/086.Miniature_Pinscher_n02107312_3227.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/086.Miniature_Pinscher/086.Miniature_Pinscher_n02107312_3227.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Miniature Pinscher', 'Doberman', 'Kelpie', 'Toy Terrier', 'Chihuaha', 'Yorkshire Terrier', 'Maltese Dog', 'Silky Terrier', 'Redbone']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Miniature Pinscher (置信度: 0.0000)
总耗时: 5.21秒
succ. pred cate:Miniature Pinscher, true cate:086.Miniature Pinscher, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/118.Dhole/118.Dhole_n02115913_1142.jpg
执行快思考...
Processing fast and slow thinking:  10%|█         | 12/120 [01:13<10:13,  5.68s/it]Processing fast and slow thinking:  11%|█         | 13/120 [01:18<09:59,  5.60s/it]Processing fast and slow thinking:  12%|█▏        | 14/120 [01:25<10:32,  5.97s/it]Processing fast and slow thinking:  12%|█▎        | 15/120 [01:30<10:06,  5.77s/it]Processing fast and slow thinking:  13%|█▎        | 16/120 [01:41<12:20,  7.12s/it]Processing fast and slow thinking:  15%|█▌        | 18/120 [01:48<09:12,  5.42s/it]Processing fast and slow thinking:  16%|█▌        | 19/120 [01:59<11:34,  6.87s/it]Processing fast and slow thinking:  17%|█▋        | 20/120 [02:04<10:43,  6.44s/it]Processing fast and slow thinking:  18%|█▊        | 21/120 [02:11<10:43,  6.50s/it]快思考结果确定，直接返回...
分类完成: Dhole (置信度: 0.7569)
总耗时: 0.02秒
succ. pred cate:Dhole, true cate:118.Dhole, used_slow:False, confidence:0.7569
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/072.Schipperke/072.Schipperke_n02104365_6140.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/072.Schipperke/072.Schipperke_n02104365_6140.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Miniature Pinscher', 'Chihuaha', 'Kelpie', 'Toy Terrier', 'Schipperke', 'Norwich Terrier', 'Dandi Dinmont', 'Australian Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
模糊匹配类别修正: 'Ch' -> 'Chow'
快慢思考结果不一致，进行最终融合决策...
分类完成: Schipperke (置信度: 0.8500)
总耗时: 12.65秒
succ. pred cate:Schipperke, true cate:072.Schipperke, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/028.Staffordshire_Bullterrier/028.Staffordshire_Bullterrier_n02093256_11732.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/028.Staffordshire_Bullterrier/028.Staffordshire_Bullterrier_n02093256_11732.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Staffordshire Bullterrier', 'Bull Mastiff', 'American Staffordshire Terrier', 'Clumber', 'Leonberg', 'Great Dane', 'Rottweiler']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Staffordshire Bullterrier (置信度: 0.0000)
总耗时: 5.34秒
succ. pred cate:Staffordshire Bullterrier, true cate:028.Staffordshire Bullterrier, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/077.Komondor/077.Komondor_n02105505_3933.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/077.Komondor/077.Komondor_n02105505_3933.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Komondor', 'Afghan Hound', 'Briard', 'Tibetan Terrier', 'Lhasa', 'Sealyham Terrier', 'Maltese Dog', 'Saluki', 'Kerry Blue Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Komondor (置信度: 0.0000)
总耗时: 7.05秒
succ. pred cate:Komondor, true cate:077.Komondor, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/079.Shetland_Sheepdog/079.Shetland_Sheepdog_n02105855_5719.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/079.Shetland_Sheepdog/079.Shetland_Sheepdog_n02105855_5719.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Shetland Sheepdog', 'Australian Terrier', 'Collie', 'Scotch Terrier', 'Basenji', 'Tibetan Terrier', 'Papillon', 'Golden Retriever', 'Maltese Dog', 'Italian Greyhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Shetland Sheepdog (置信度: 0.0000)
总耗时: 5.23秒
succ. pred cate:Shetland Sheepdog, true cate:079.Shetland Sheepdog, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/111.Pembroke/111.Pembroke_n02113023_6140.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/111.Pembroke/111.Pembroke_n02113023_6140.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Pembroke', 'Cardigan', 'Appenzeller', 'German Shepard', 'Chihuaha', 'Samoyed', 'Malamute', 'Toy Poodle']
步骤3: 使用MLLM进行最终推理（基于经验库）...
模糊匹配类别修正: 'is clear.' -> 'Vizsla'
快慢思考结果不一致，进行最终融合决策...
分类完成: Pembroke (置信度: 0.9000)
总耗时: 10.68秒
succ. pred cate:Pembroke, true cate:111.Pembroke, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/058.Chesapeake_Bay_Retriever/058.Chesapeake_Bay_Retriever_n02099849_513.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Chesapeake Bay Retriever (置信度: 0.9613)
总耗时: 0.02秒
succ. pred cate:Chesapeake Bay Retriever, true cate:058.Chesapeake Bay Retriever, used_slow:False, confidence:0.9613
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/003.Pekinese/003.Pekinese_n02086079_8902.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/003.Pekinese/003.Pekinese_n02086079_8902.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Pekinese', 'Shih-Tzu', 'Japanese Spaniel', 'Lhasa', 'Blenheim Spaniel', 'Yorkshire Terrier', 'Silky Terrier', 'Australian Terrier', 'Maltese Dog', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Pekinese (置信度: 0.0000)
总耗时: 6.47秒
succ. pred cate:Pekinese, true cate:003.Pekinese, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/025.Saluki/025.Saluki_n02091831_11021.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/025.Saluki/025.Saluki_n02091831_11021.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Irish Wolfhound', 'Bedlington Terrier', 'Saluki', 'Rhodesian Ridgeback', 'Weimaraner', 'Chow', 'Siberian Husky', 'Kerry Blue Terrier', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Saluki (置信度: 0.8500)
总耗时: 11.51秒
succ. pred cate:Saluki, true cate:025.Saluki, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/102.Pug/102.Pug_n02110958_1975.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/102.Pug/102.Pug_n02110958_1975.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Pug', 'French Bulldog', 'Pekinese', 'Shih-Tzu', 'Norwegian Elkhound', 'Toy Poodle', 'Basset Hound', 'Brabancon Griffon', 'Labrador Retriever']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Pug (置信度: 0.0000)
总耗时: 5.16秒
succ. pred cate:Pug, true cate:102.Pug, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/062.Irish_Setter/062.Irish_Setter_n02100877_5286.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/062.Irish_Setter/062.Irish_Setter_n02100877_5286.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Irish Setter', 'Golden Retriever', 'Sussex Spaniel', 'Afghan Hound', 'Clumber', 'Otterhound', 'Redbone', 'Kuvasz', 'Tibetan Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Irish Setter (置信度: 0.0000)
总耗时: 6.69秒
succ. pred cate:Irish Setter, true cate:062.Irish Setter, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/066.English_Springer_Spaniel/066.English_Springer_Spaniel_n02102040_5096.jpg
执行快思考...
Processing fast and slow thinking:  18%|█▊        | 22/120 [02:23<12:57,  7.94s/it]Processing fast and slow thinking:  19%|█▉        | 23/120 [02:28<11:26,  7.08s/it]Processing fast and slow thinking:  20%|██        | 24/120 [02:39<13:07,  8.21s/it]Processing fast and slow thinking:  21%|██        | 25/120 [02:43<11:13,  7.09s/it]Processing fast and slow thinking:  22%|██▏       | 26/120 [02:53<12:24,  7.92s/it]Processing fast and slow thinking:  22%|██▎       | 27/120 [02:59<11:39,  7.52s/it]Processing fast and slow thinking:  24%|██▍       | 29/120 [03:06<08:35,  5.66s/it]Processing fast and slow thinking:  25%|██▌       | 30/120 [03:11<08:11,  5.46s/it]Processing fast and slow thinking:  26%|██▌       | 31/120 [03:22<10:15,  6.92s/it]快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/066.English_Springer_Spaniel/066.English_Springer_Spaniel_n02102040_5096.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Clumber', 'English Springer Spaniel', 'Cocker Spaniel', 'Welsh Springer Spaniel', 'Brittany', 'Tibetan Terrier', 'Kuvasz', 'Great Dane', 'Golden Retriever', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: English Springer Spaniel (置信度: 0.9500)
总耗时: 11.70秒
succ. pred cate:English Springer Spaniel, true cate:066.English Springer Spaniel, used_slow:True, confidence:0.9500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/057.Labrador_Retriever/057.Labrador_Retriever_n02099712_3613.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/057.Labrador_Retriever/057.Labrador_Retriever_n02099712_3613.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Labrador Retriever', 'Black-and-tan Coonhound', 'German Short-haired Pointer', 'Flat-coated Retriever', 'Gordon Setter', 'Redbone', 'Great Dane', 'Basset Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Labrador Retriever (置信度: 0.0000)
总耗时: 4.91秒
succ. pred cate:Labrador Retriever, true cate:057.Labrador Retriever, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/007.Toy_Terrier/007.Toy_Terrier_n02087046_4402.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/007.Toy_Terrier/007.Toy_Terrier_n02087046_4402.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Mexican Hairless', 'Toy Terrier', 'Italian Greyhound', 'Whippet', 'Clumber', 'Otterhound', 'Malinois', 'Shih-Tzu', 'Papillon']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Toy Terrier (置信度: 0.8000)
总耗时: 11.00秒
succ. pred cate:Toy Terrier, true cate:007.Toy Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/084.German_Shepard/084.German_Shepard_n02106662_9625.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/084.German_Shepard/084.German_Shepard_n02106662_9625.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['German Shepard', 'Malinois', 'Norwegian Elkhound', 'Groenendael', 'Appenzeller', 'Bull Mastiff', 'Keeshond']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: German Shepard (置信度: 0.0000)
总耗时: 4.37秒
succ. pred cate:German Shepard, true cate:084.German Shepard, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/048.Scotch_Terrier/048.Scotch_Terrier_n02097298_2443.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/048.Scotch_Terrier/048.Scotch_Terrier_n02097298_2443.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Giant Schnauzer', 'Standard Schnauzer', 'Flat-coated Retriever', 'Kerry Blue Terrier', 'Scotch Terrier', 'Great Dane', 'German Short-haired Pointer', 'Groenendael', 'Tibetan Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Scotch Terrier (置信度: 0.8500)
总耗时: 9.92秒
succ. pred cate:Scotch Terrier, true cate:048.Scotch Terrier, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/090.EntleBucher/090.EntleBucher_n02108000_716.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/090.EntleBucher/090.EntleBucher_n02108000_716.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['EntleBucher', 'Greater Swiss Mountain Dog', 'Cardigan', 'Beagle', 'Walker Hound', 'Otterhound', 'Saint Bernard', 'Bernese Mountain Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: EntleBucher (置信度: 0.0000)
总耗时: 6.57秒
succ. pred cate:EntleBucher, true cate:090.EntleBucher, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/059.German_Short_haired_Pointer/059.German_Short_haired_Pointer_n02100236_4198.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: German Short-haired Pointer (置信度: 0.8649)
总耗时: 0.02秒
succ. pred cate:German Short-haired Pointer, true cate:059.German Short haired Pointer, used_slow:False, confidence:0.8649
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/047.Standard_Schnauzer/047.Standard_Schnauzer_n02097209_2194.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/047.Standard_Schnauzer/047.Standard_Schnauzer_n02097209_2194.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Standard Schnauzer', 'Miniature Schnauzer', 'Scotch Terrier', 'Irish Wolfhound', 'Kerry Blue Terrier', 'Otterhound', 'Norwich Terrier', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Miniature Schnauzer (置信度: 0.0000)
总耗时: 6.90秒
succ. pred cate:Miniature Schnauzer, true cate:047.Standard Schnauzer, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/045.Miniature_Schnauzer/045.Miniature_Schnauzer_n02097047_724.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/045.Miniature_Schnauzer/045.Miniature_Schnauzer_n02097047_724.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Miniature Schnauzer', 'Standard Schnauzer', 'Affenpinscher', 'Giant Schnauzer', 'Scotch Terrier', 'Australian Terrier', 'Maltese Dog', 'Yorkshire Terrier', 'Silky Terrier', 'Great Dane']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Miniature Schnauzer (置信度: 0.0000)
总耗时: 4.86秒
succ. pred cate:Miniature Schnauzer, true cate:045.Miniature Schnauzer, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/004.Shih_Tzu/004.Shih_Tzu_n02086240_1011.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/004.Shih_Tzu/004.Shih_Tzu_n02086240_1011.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Lhasa', 'Shih-Tzu', 'Tibetan Terrier', 'Dandi Dinmont', 'Norfolk Terrier', 'Maltese Dog', 'Yorkshire Terrier', 'Silky Terrier', 'Australian Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Shih-Tzu (置信度: 0.8500)
总耗时: 11.06秒
succ. pred cate:Shih-Tzu, true cate:004.Shih Tzu, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/064.Brittany/064.Brittany_n02101388_4229.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  27%|██▋       | 32/120 [03:32<11:15,  7.67s/it]Processing fast and slow thinking:  28%|██▊       | 33/120 [03:43<12:19,  8.50s/it]Processing fast and slow thinking:  28%|██▊       | 34/120 [03:47<10:39,  7.44s/it]Processing fast and slow thinking:  29%|██▉       | 35/120 [03:59<12:21,  8.72s/it]Processing fast and slow thinking:  30%|███       | 36/120 [04:11<13:16,  9.48s/it]Processing fast and slow thinking:  31%|███       | 37/120 [04:21<13:20,  9.65s/it]Processing fast and slow thinking:  32%|███▏      | 38/120 [04:32<13:43, 10.04s/it]Processing fast and slow thinking:  32%|███▎      | 39/120 [04:36<11:27,  8.48s/it]Processing fast and slow thinking:  34%|███▍      | 41/120 [04:43<07:57,  6.04s/it]开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/064.Brittany/064.Brittany_n02101388_4229.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Borzoi', 'Appenzeller', 'English Setter', 'Saluki', 'Shetland Sheepdog', 'Sealyham Terrier', 'Staffordshire Bullterrier', 'Tibetan Terrier', 'Otterhound', 'Kerry Blue Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: English Setter (置信度: 0.9000)
总耗时: 9.70秒
failed. pred cate:English Setter, true cate:064.Brittany, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/053.Lhasa/053.Lhasa_n02098413_3033.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/053.Lhasa/053.Lhasa_n02098413_3033.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Lhasa', 'Shih-Tzu', 'Tibetan Terrier', 'Maltese Dog', 'Dandi Dinmont', 'Silky Terrier', 'Japanese Spaniel', 'Yorkshire Terrier', 'Pekinese']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Shih-Tzu (置信度: 0.8500)
总耗时: 10.64秒
failed. pred cate:Shih-Tzu, true cate:053.Lhasa, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/042.Australian_Terrier/042.Australian_Terrier_n02096294_3554.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/042.Australian_Terrier/042.Australian_Terrier_n02096294_3554.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Yorkshire Terrier', 'Silky Terrier', 'Affenpinscher', 'Cairn', 'Briard', 'Norwich Terrier', 'Australian Terrier', 'Maltese Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Yorkshire Terrier (置信度: 0.0000)
总耗时: 4.78秒
succ. pred cate:Yorkshire Terrier, true cate:042.Australian Terrier, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/039.Sealyham_Terrier/039.Sealyham_Terrier_n02095889_610.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/039.Sealyham_Terrier/039.Sealyham_Terrier_n02095889_610.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Sealyham Terrier', 'West Highland White Terrier', 'Miniature Schnauzer', 'Standard Schnauzer', 'Dandi Dinmont', 'Pekinese', 'Maltese Dog', 'Afghan Hound', 'Bedlington Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Sealyham Terrier (置信度: 0.9000)
总耗时: 11.86秒
succ. pred cate:Sealyham Terrier, true cate:039.Sealyham Terrier, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/067.Welsh_Springer_Spaniel/067.Welsh_Springer_Spaniel_n02102177_1128.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/067.Welsh_Springer_Spaniel/067.Welsh_Springer_Spaniel_n02102177_1128.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Clumber', 'Brittany', 'Welsh Springer Spaniel', 'English Setter', 'English Springer Spaniel', 'Silky Terrier', 'Dandi Dinmont', 'Australian Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Welsh Springer Spaniel (置信度: 0.7500)
总耗时: 11.31秒
succ. pred cate:Welsh Springer Spaniel, true cate:067.Welsh Springer Spaniel, used_slow:True, confidence:0.7500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/068.Cocker_Spaniel/068.Cocker_Spaniel_n02102318_6612.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/068.Cocker_Spaniel/068.Cocker_Spaniel_n02102318_6612.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Curly-coater Retriever', 'Irish Water Spaniel', 'Clumber', 'Flat-coated Retriever', 'Sussex Spaniel', 'Cocker Spaniel', 'Airedale', 'Golden Retriever', 'Otterhound', 'Collie']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Curly-coated Retriever (置信度: 0.8500)
总耗时: 10.05秒
failed. pred cate:Curly-coated Retriever, true cate:068.Cocker Spaniel, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/089.Appenzeller/089.Appenzeller_n02107908_7236.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/089.Appenzeller/089.Appenzeller_n02107908_7236.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['EntleBucher', 'Miniature Pinscher', 'Greater Swiss Mountain Dog', 'Basenji', 'Beagle', 'Norwich Terrier', 'Toy Terrier', 'Bull Mastiff', 'Great Dane']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: EntleBucher (置信度: 0.7500)
总耗时: 10.97秒
failed. pred cate:EntleBucher, true cate:089.Appenzeller, used_slow:True, confidence:0.7500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/017.Redbone/017.Redbone_n02090379_3996.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/017.Redbone/017.Redbone_n02090379_3996.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Vizsla', 'Kelpie', 'Irish Setter', 'Malinois', 'Irish Terrier', 'Giant Schnauzer', 'Cardigan', 'Brabancon Griffon', 'Boston Bull', 'Mexican Hairless']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Vizsla (置信度: 0.0000)
总耗时: 4.81秒
failed. pred cate:Vizsla, true cate:017.Redbone, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/119.African_Hunting_Dog/119.African_Hunting_Dog_n02116738_8653.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: African Hunting Dog (置信度: 0.8386)
总耗时: 0.03秒
succ. pred cate:African Hunting Dog, true cate:119.African Hunting Dog, used_slow:False, confidence:0.8386
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/113.Toy_Poodle/113.Toy_Poodle_n02113624_665.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/113.Toy_Poodle/113.Toy_Poodle_n02113624_665.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Toy Poodle', 'Miniature Poodle', 'Lakeland Terrier', 'Airedale', 'Soft-coated Wheaten Terrier', 'Maltese Dog', 'Yorkshire Terrier', 'Silky Terrier', 'Japanese Spaniel']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Miniature Poodle (置信度: 0.0000)
总耗时: 6.31秒
failed. pred cate:Miniature Poodle, true cate:113.Toy Poodle, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/027.Weimaraner/027.Weimaraner_n02092339_4003.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  35%|███▌      | 42/120 [04:48<07:43,  5.94s/it]Processing fast and slow thinking:  36%|███▌      | 43/120 [04:59<09:12,  7.18s/it]Processing fast and slow thinking:  37%|███▋      | 44/120 [05:04<08:20,  6.58s/it]Processing fast and slow thinking:  38%|███▊      | 45/120 [05:10<07:55,  6.33s/it]Processing fast and slow thinking:  38%|███▊      | 46/120 [05:15<07:25,  6.02s/it]Processing fast and slow thinking:  39%|███▉      | 47/120 [05:26<08:56,  7.34s/it]Processing fast and slow thinking:  40%|████      | 48/120 [05:30<07:53,  6.57s/it]Processing fast and slow thinking:  41%|████      | 49/120 [05:40<08:49,  7.45s/it]Processing fast and slow thinking:  42%|████▏     | 50/120 [05:51<09:53,  8.47s/it]Processing fast and slow thinking:  42%|████▎     | 51/120 [05:56<08:44,  7.59s/it]开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/027.Weimaraner/027.Weimaraner_n02092339_4003.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Weimaraner', 'Basset Hound', 'Italian Greyhound', 'Vizsla', 'German Short-haired Pointer', 'Redbone', 'English Setter']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Weimaraner (置信度: 0.0000)
总耗时: 5.63秒
succ. pred cate:Weimaraner, true cate:027.Weimaraner, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/041.Cairn/041.Cairn_n02096177_5206.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/041.Cairn/041.Cairn_n02096177_5206.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Yorkshire Terrier', 'Cairn', 'Silky Terrier', 'Affenpinscher', 'Norwich Terrier', 'Maltese Dog', 'Australian Terrier', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Yorkshire Terrier (置信度: 0.8000)
总耗时: 10.70秒
failed. pred cate:Yorkshire Terrier, true cate:041.Cairn, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/117.Dingo/117.Dingo_n02115641_925.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/117.Dingo/117.Dingo_n02115641_925.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Dingo', 'Dhole', 'African Hunting Dog', 'Cardigan', 'Pembroke', 'Saint Bernard', 'Kelpie', 'Bernese Mountain Dog', 'Keeshond', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Dingo (置信度: 0.0000)
总耗时: 4.98秒
succ. pred cate:Dingo, true cate:117.Dingo, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/034.Norfolk_Terrier/034.Norfolk_Terrier_n02094114_99.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/034.Norfolk_Terrier/034.Norfolk_Terrier_n02094114_99.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Irish Terrier', 'Norfolk Terrier', 'Border Terrier', 'Airedale', 'Australian Terrier', 'Silky Terrier', 'Otterhound', 'Sealyham Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Border Terrier (置信度: 0.0000)
总耗时: 5.70秒
succ. pred cate:Border Terrier, true cate:034.Norfolk Terrier, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/114.Miniature_Poodle/114.Miniature_Poodle_n02113712_2274.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/114.Miniature_Poodle/114.Miniature_Poodle_n02113712_2274.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Miniature Poodle', 'Bedlington Terrier', 'Kerry Blue Terrier', 'Dandi Dinmont', 'Toy Poodle', 'Kuvasz', 'Otterhound', 'Soft-coated Wheaten Terrier', 'Pekinese']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Toy Poodle (置信度: 0.0000)
总耗时: 5.23秒
failed. pred cate:Toy Poodle, true cate:114.Miniature Poodle, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/085.Doberman/085.Doberman_n02107142_4763.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/085.Doberman/085.Doberman_n02107142_4763.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Mexican Hairless', 'Kelpie', 'Great Dane', 'Doberman', 'Italian Greyhound', 'Scotch Terrier', 'Cardigan', 'Black-and-tan Coonhound', 'Irish Setter']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Doberman (置信度: 0.8000)
总耗时: 10.59秒
succ. pred cate:Doberman, true cate:085.Doberman, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/116.Mexican_Hairless/116.Mexican_Hairless_n02113978_2888.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/116.Mexican_Hairless/116.Mexican_Hairless_n02113978_2888.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Mexican Hairless', 'Black-and-tan Coonhound', 'German Short-haired Pointer', 'Bedlington Terrier', 'Whippet', 'Great Dane', 'Redbone', 'Italian Greyhound', 'Bull Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Mexican Hairless (置信度: 0.0000)
总耗时: 4.72秒
succ. pred cate:Mexican Hairless, true cate:116.Mexican Hairless, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/073.Groenendael/073.Groenendael_n02105056_7068.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/073.Groenendael/073.Groenendael_n02105056_7068.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Schipperke', 'Gordon Setter', 'Scotch Terrier', 'Collie', 'Malinois', 'Groenendael', 'Great Dane', 'Keeshond', 'Black-and-tan Coonhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Schipperke (置信度: 0.8500)
总耗时: 9.55秒
failed. pred cate:Schipperke, true cate:073.Groenendael, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/012.Bloodhound/012.Bloodhound_n02088466_4731.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/012.Bloodhound/012.Bloodhound_n02088466_4731.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Rhodesian Ridgeback', 'Vizsla', 'Bull Mastiff', 'Redbone', 'Bloodhound', 'Otterhound', 'Great Dane', 'Miniature Poodle']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Bloodhound (置信度: 0.8000)
总耗时: 10.89秒
succ. pred cate:Bloodhound, true cate:012.Bloodhound, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/088.Bernese_Mountain_Dog/088.Bernese_Mountain_Dog_n02107683_6301.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/088.Bernese_Mountain_Dog/088.Bernese_Mountain_Dog_n02107683_6301.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Bernese Mountain Dog', 'Clumber', 'Gordon Setter', 'English Springer Spaniel', 'Greater Swiss Mountain Dog', 'Airedale', 'Brittany', 'Silky Terrier', 'English Setter', 'Doberman']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Bernese Mountain Dog (置信度: 0.0000)
总耗时: 5.52秒
succ. pred cate:Bernese Mountain Dog, true cate:088.Bernese Mountain Dog, used_slow:True, confidence:0.0000
Processing fast and slow thinking:  43%|████▎     | 52/120 [06:07<09:45,  8.62s/it]Processing fast and slow thinking:  44%|████▍     | 53/120 [06:15<09:25,  8.44s/it]Processing fast and slow thinking:  45%|████▌     | 54/120 [06:20<08:08,  7.40s/it]Processing fast and slow thinking:  46%|████▌     | 55/120 [06:27<07:43,  7.13s/it]Processing fast and slow thinking:  47%|████▋     | 56/120 [06:32<07:07,  6.68s/it]Processing fast and slow thinking:  48%|████▊     | 57/120 [06:38<06:38,  6.32s/it]Processing fast and slow thinking:  48%|████▊     | 58/120 [06:43<06:06,  5.91s/it]Processing fast and slow thinking:  49%|████▉     | 59/120 [06:48<05:41,  5.59s/it]Processing fast and slow thinking:  50%|█████     | 60/120 [06:53<05:25,  5.43s/it]开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/095.Great_Dane/095.Great_Dane_n02109047_34175.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/095.Great_Dane/095.Great_Dane_n02109047_34175.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Great Dane', 'Black-and-tan Coonhound', 'Groenendael', 'German Short-haired Pointer', 'Standard Schnauzer', 'Kerry Blue Terrier', 'EntleBucher', 'Redbone']
步骤3: 使用MLLM进行最终推理（基于经验库）...
模糊匹配类别修正: 'is clear.' -> 'Vizsla'
快慢思考结果不一致，进行最终融合决策...
分类完成: Great Dane (置信度: 0.9500)
总耗时: 11.02秒
succ. pred cate:Great Dane, true cate:095.Great Dane, used_slow:True, confidence:0.9500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/040.Airedale/040.Airedale_n02096051_8826.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/040.Airedale/040.Airedale_n02096051_8826.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Otterhound', 'Airedale', 'Soft-coated Wheaten Terrier', 'Irish Terrier', 'Lakeland Terrier', 'Silky Terrier', 'Brittany', 'Clumber', 'Walker Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Otterhound (置信度: 0.0000)
总耗时: 8.01秒
failed. pred cate:Otterhound, true cate:040.Airedale, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/107.Pomeranian/107.Pomeranian_n02112018_1577.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/107.Pomeranian/107.Pomeranian_n02112018_1577.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Pomeranian', 'Keeshond', 'Japanese Spaniel', 'Shetland Sheepdog', 'Pekinese', 'Doberman', 'Maltese Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Pomeranian (置信度: 0.0000)
总耗时: 4.98秒
succ. pred cate:Pomeranian, true cate:107.Pomeranian, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/082.Bouvier_des_Flandres/082.Bouvier_des_Flandres_n02106382_1151.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/082.Bouvier_des_Flandres/082.Bouvier_des_Flandres_n02106382_1151.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Bouvier des Flandres', 'Kerry Blue Terrier', 'Giant Schnauzer', 'Miniature Poodle', 'Irish Water Spaniel', 'Maltese Dog', 'Yorkshire Terrier', 'Silky Terrier', 'Toy Poodle']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Bouvier des Flandres (置信度: 0.0000)
总耗时: 6.48秒
succ. pred cate:Bouvier des Flandres, true cate:082.Bouvier des Flandres, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/019.Irish_Wolfhound/019.Irish_Wolfhound_n02090721_537.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/019.Irish_Wolfhound/019.Irish_Wolfhound_n02090721_537.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Irish Wolfhound', 'Standard Poodle', 'Scottish Deerhound', 'Standard Schnauzer', 'Soft-coated Wheaten Terrier', 'Shetland Sheepdog', 'Old English Sheepdog', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Irish Wolfhound (置信度: 0.0000)
总耗时: 5.63秒
succ. pred cate:Irish Wolfhound, true cate:019.Irish Wolfhound, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/087.Greater_Swiss_Mountain_Dog/087.Greater_Swiss_Mountain_Dog_n02107574_2436.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/087.Greater_Swiss_Mountain_Dog/087.Greater_Swiss_Mountain_Dog_n02107574_2436.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Greater Swiss Mountain Dog', 'EntleBucher', 'Rottweiler', 'Bernese Mountain Dog', 'Appenzeller', 'Redbone', 'Bull Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Greater Swiss Mountain Dog (置信度: 0.0000)
总耗时: 5.48秒
succ. pred cate:Greater Swiss Mountain Dog, true cate:087.Greater Swiss Mountain Dog, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/099.Siberian_Husky/099.Siberian_Husky_n02110185_12380.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/099.Siberian_Husky/099.Siberian_Husky_n02110185_12380.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Siberian Husky', 'Eskimo Dog', 'Malamute', 'Norwegian Elkhound', 'Appenzeller', 'Keeshond', 'Bull Mastiff', 'Doberman', 'Schipperke']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Siberian Husky (置信度: 0.0000)
总耗时: 4.95秒
succ. pred cate:Siberian Husky, true cate:099.Siberian Husky, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/075.Briard/075.Briard_n02105251_2591.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/075.Briard/075.Briard_n02105251_2591.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Briard', 'Standard Schnauzer', 'Tibetan Terrier', 'Irish Wolfhound', 'Scottish Deerhound', 'Otterhound', 'Lhasa', 'Keeshond', 'Pekinese']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Briard (置信度: 0.0000)
总耗时: 4.84秒
succ. pred cate:Briard, true cate:075.Briard, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/033.Irish_Terrier/033.Irish_Terrier_n02093991_1276.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/033.Irish_Terrier/033.Irish_Terrier_n02093991_1276.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Irish Terrier', 'Airedale', 'Norwich Terrier', 'Norfolk Terrier', 'Vizsla', 'Miniature Poodle', 'Lhasa', 'Soft-coated Wheaten Terrier', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Irish Terrier (置信度: 0.0000)
总耗时: 5.06秒
succ. pred cate:Irish Terrier, true cate:033.Irish Terrier, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/013.Bluetick/013.Bluetick_n02088632_4058.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/013.Bluetick/013.Bluetick_n02088632_4058.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Bluetick', 'Black-and-tan Coonhound', 'Beagle', 'English Foxhound', 'Basset Hound', 'Walker Hound', 'Greater Swiss Mountain Dog', 'Redbone', 'Great Dane']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Bluetick (置信度: 0.0000)
总耗时: 5.78秒
Processing fast and slow thinking:  51%|█████     | 61/120 [06:58<05:26,  5.54s/it]Processing fast and slow thinking:  52%|█████▏    | 62/120 [07:06<05:58,  6.17s/it]Processing fast and slow thinking:  52%|█████▎    | 63/120 [07:11<05:31,  5.81s/it]Processing fast and slow thinking:  53%|█████▎    | 64/120 [07:16<05:13,  5.60s/it]Processing fast and slow thinking:  54%|█████▍    | 65/120 [07:26<06:14,  6.81s/it]Processing fast and slow thinking:  55%|█████▌    | 66/120 [07:32<06:02,  6.72s/it]Processing fast and slow thinking:  57%|█████▋    | 68/120 [07:39<04:33,  5.26s/it]Processing fast and slow thinking:  57%|█████▊    | 69/120 [07:46<04:44,  5.57s/it]Processing fast and slow thinking:  58%|█████▊    | 70/120 [07:56<05:43,  6.87s/it]Processing fast and slow thinking:  59%|█████▉    | 71/120 [08:02<05:14,  6.41s/it]succ. pred cate:Bluetick, true cate:013.Bluetick, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/061.English_Setter/061.English_Setter_n02100735_3595.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/061.English_Setter/061.English_Setter_n02100735_3595.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['English Setter', 'Brittany', 'Welsh Springer Spaniel', 'Irish Setter', 'Clumber', 'Silky Terrier', 'Malinois', 'Redbone']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: English Setter (置信度: 0.0000)
总耗时: 7.66秒
succ. pred cate:English Setter, true cate:061.English Setter, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/020.Italian_Greyhound/020.Italian_Greyhound_n02091032_490.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/020.Italian_Greyhound/020.Italian_Greyhound_n02091032_490.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Italian Greyhound', 'Whippet', 'Mexican Hairless', 'African Hunting Dog', 'Basenji', 'Great Dane', 'English Springer Spaniel', 'Siberian Husky']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Italian Greyhound (置信度: 0.0000)
总耗时: 4.97秒
succ. pred cate:Italian Greyhound, true cate:020.Italian Greyhound, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/112.Cardigan/112.Cardigan_n02113186_5833.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/112.Cardigan/112.Cardigan_n02113186_5833.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Pembroke', 'Cardigan', 'Basenji', 'Collie', 'Shetland Sheepdog', 'Greater Swiss Mountain Dog', 'Golden Retriever', 'Boston Bull', 'Old English Sheepdog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Pembroke (置信度: 0.0000)
总耗时: 5.11秒
failed. pred cate:Pembroke, true cate:112.Cardigan, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/063.Gordon_Setter/063.Gordon_Setter_n02101006_2540.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/063.Gordon_Setter/063.Gordon_Setter_n02101006_2540.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Cocker Spaniel', 'Curly-coater Retriever', 'Irish Water Spaniel', 'Flat-coated Retriever', 'Gordon Setter', 'Tibetan Terrier', 'Kuvasz', 'Bernese Mountain Dog', 'Great Dane', 'Redbone']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Gordon Setter (置信度: 0.9500)
总耗时: 9.64秒
succ. pred cate:Gordon Setter, true cate:063.Gordon Setter, used_slow:True, confidence:0.9500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/083.Rottweiler/083.Rottweiler_n02106550_2197.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/083.Rottweiler/083.Rottweiler_n02106550_2197.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Rottweiler', 'Bernese Mountain Dog', 'Black-and-tan Coonhound', 'Greater Swiss Mountain Dog', 'Doberman', 'Giant Schnauzer', 'Redbone']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Rottweiler (置信度: 0.0000)
总耗时: 6.50秒
succ. pred cate:Rottweiler, true cate:083.Rottweiler, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/018.Borzoi/018.Borzoi_n02090622_6976.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Borzoi (置信度: 0.7161)
总耗时: 0.02秒
succ. pred cate:Borzoi, true cate:018.Borzoi, used_slow:False, confidence:0.7161
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/008.Rhodesian_Ridgeback/008.Rhodesian_Ridgeback_n02087394_3795.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/008.Rhodesian_Ridgeback/008.Rhodesian_Ridgeback_n02087394_3795.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Rhodesian Ridgeback', 'Vizsla', 'Redbone', 'Black-and-tan Coonhound', 'Malinois', 'Brabancon Griffon', 'Bull Mastiff', 'Bloodhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Rhodesian Ridgeback (置信度: 0.0000)
总耗时: 7.08秒
succ. pred cate:Rhodesian Ridgeback, true cate:008.Rhodesian Ridgeback, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/050.Silky_Terrier/050.Silky_Terrier_n02097658_2329.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/050.Silky_Terrier/050.Silky_Terrier_n02097658_2329.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Silky Terrier', 'Australian Terrier', 'Yorkshire Terrier', 'Norwich Terrier', 'Cairn', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Australian Terrier (置信度: 0.0000)
总耗时: 6.52秒
succ. pred cate:Australian Terrier, true cate:050.Silky Terrier, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/098.Malamute/098.Malamute_n02110063_12514.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/098.Malamute/098.Malamute_n02110063_12514.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Eskimo Dog', 'Siberian Husky', 'Collie', 'Malamute', 'Keeshond', 'Leonberg', 'Boston Bull', 'Whippet', 'Old English Sheepdog', 'Chesapeake Bay Retriever']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Siberian Husky (置信度: 0.7500)
总耗时: 10.55秒
failed. pred cate:Siberian Husky, true cate:098.Malamute, used_slow:True, confidence:0.7500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/070.Irish_Water_Spaniel/070.Irish_Water_Spaniel_n02102973_2642.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/070.Irish_Water_Spaniel/070.Irish_Water_Spaniel_n02102973_2642.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Toy Poodle', 'Miniature Poodle', 'Irish Water Spaniel', 'Curly-coater Retriever', 'Standard Poodle', 'Basset Hound', 'Lakeland Terrier', 'Silky Terrier', 'Collie']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Miniature Poodle (置信度: 0.0000)
总耗时: 5.18秒
failed. pred cate:Miniature Poodle, true cate:070.Irish Water Spaniel, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/100.Affenpinscher/100.Affenpinscher_n02110627_10439.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  60%|██████    | 72/120 [08:11<05:50,  7.29s/it]Processing fast and slow thinking:  61%|██████    | 73/120 [08:18<05:33,  7.10s/it]Processing fast and slow thinking:  62%|██████▏   | 74/120 [08:30<06:33,  8.55s/it]Processing fast and slow thinking:  62%|██████▎   | 75/120 [08:35<05:35,  7.45s/it]Processing fast and slow thinking:  63%|██████▎   | 76/120 [08:45<06:01,  8.21s/it]Processing fast and slow thinking:  64%|██████▍   | 77/120 [08:50<05:19,  7.43s/it]Processing fast and slow thinking:  65%|██████▌   | 78/120 [09:02<06:03,  8.65s/it]Processing fast and slow thinking:  66%|██████▌   | 79/120 [09:12<06:10,  9.04s/it]Processing fast and slow thinking:  67%|██████▋   | 80/120 [09:18<05:23,  8.08s/it]开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/100.Affenpinscher/100.Affenpinscher_n02110627_10439.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Tibetan Terrier', 'Affenpinscher', 'Japanese Spaniel', 'Shih-Tzu', 'Lhasa', 'Silky Terrier', 'Maltese Dog', 'Yorkshire Terrier', 'Australian Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Affenpinscher (置信度: 0.8500)
总耗时: 9.56秒
succ. pred cate:Affenpinscher, true cate:100.Affenpinscher, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/078.Old_English_Sheepdog/078.Old_English_Sheepdog_n02105641_3531.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/078.Old_English_Sheepdog/078.Old_English_Sheepdog_n02105641_3531.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Old English Sheepdog', 'Lhasa', 'Tibetan Terrier', 'Soft-coated Wheaten Terrier', 'Briard', 'Maltese Dog', 'Otterhound', 'Silky Terrier', 'Komondor', 'Pekinese']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Old English Sheepdog (置信度: 0.0000)
总耗时: 6.62秒
succ. pred cate:Old English Sheepdog, true cate:078.Old English Sheepdog, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/106.Samoyed/106.Samoyed_n02111889_6592.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/106.Samoyed/106.Samoyed_n02111889_6592.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Chow', 'Eskimo Dog', 'Malamute', 'Shetland Sheepdog', 'Soft-coated Wheaten Terrier', 'Lhasa', 'Toy Terrier', 'Australian Terrier', 'Weimaraner']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Eskimo Dog (置信度: 0.8000)
总耗时: 12.12秒
failed. pred cate:Eskimo Dog, true cate:106.Samoyed, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/022.Ibizian_Hound/022.Ibizian_Hound_n02091244_5818.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/022.Ibizian_Hound/022.Ibizian_Hound_n02091244_5818.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Welsh Springer Spaniel', 'Brittany', 'Redbone', 'English Foxhound', 'Bull Mastiff', 'Blenheim Spaniel', 'Doberman', 'Bluetick', 'English Setter', 'Airedale']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Welsh Springer Spaniel (置信度: 0.0000)
总耗时: 4.78秒
failed. pred cate:Welsh Springer Spaniel, true cate:022.Ibizian Hound, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/000.Chihuaha/000.Chihuaha_n02085620_3488.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/000.Chihuaha/000.Chihuaha_n02085620_3488.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Toy Terrier', 'Mexican Hairless', 'Miniature Pinscher', 'Italian Greyhound', 'Chihuaha', 'Yorkshire Terrier', 'Doberman', 'Japanese Spaniel', 'Australian Terrier', 'Maltese Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
模糊匹配类别修正: 'Chihuahua' -> 'Chihuaha'
快慢思考结果不一致，进行最终融合决策...
分类完成: Chihuahua (置信度: 0.9000)
总耗时: 10.03秒
succ. pred cate:Chihuahua, true cate:000.Chihuaha, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/023.Norwegian_Elkhound/023.Norwegian_Elkhound_n02091467_4362.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/023.Norwegian_Elkhound/023.Norwegian_Elkhound_n02091467_4362.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Norwegian Elkhound', 'Eskimo Dog', 'Siberian Husky', 'Malamute', 'Schipperke', 'Malinois', 'Keeshond', 'Doberman', 'Brittany', 'English Setter']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Norwegian Elkhound (置信度: 0.0000)
总耗时: 5.57秒
succ. pred cate:Norwegian Elkhound, true cate:023.Norwegian Elkhound, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/036.Yorkshire_Terrier/036.Yorkshire_Terrier_n02094433_730.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/036.Yorkshire_Terrier/036.Yorkshire_Terrier_n02094433_730.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Yorkshire Terrier', 'Silky Terrier', 'Cairn', 'Shih-Tzu', 'Affenpinscher', 'Maltese Dog', 'Australian Terrier', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Yorkshire Terrier (置信度: 0.9500)
总耗时: 11.54秒
succ. pred cate:Yorkshire Terrier, true cate:036.Yorkshire Terrier, used_slow:True, confidence:0.9500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/037.Wirehaired_Fox_Terrier/037.Wirehaired_Fox_Terrier_n02095314_3512.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/037.Wirehaired_Fox_Terrier/037.Wirehaired_Fox_Terrier_n02095314_3512.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Miniature Schnauzer', 'Bedlington Terrier', 'Dandi Dinmont', 'Appenzeller', 'Standard Schnauzer', 'Sealyham Terrier', 'Kerry Blue Terrier', 'Maltese Dog', 'Pekinese']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Bedlington Terrier (置信度: 0.8500)
总耗时: 9.94秒
succ. pred cate:Bedlington Terrier, true cate:037.Wirehaired Fox Terrier, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/011.Beagle/011.Beagle_n02088364_4052.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/011.Beagle/011.Beagle_n02088364_4052.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Beagle', 'Basset Hound', 'Appenzeller', 'EntleBucher', 'English Foxhound', 'Labrador Retriever', 'Toy Poodle', 'Maltese Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Beagle (置信度: 0.0000)
总耗时: 5.84秒
succ. pred cate:Beagle, true cate:011.Beagle, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/109.Keeshond/109.Keeshond_n02112350_7087.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Keeshond (置信度: 0.7897)
总耗时: 0.02秒
succ. pred cate:Keeshond, true cate:109.Keeshond, used_slow:False, confidence:0.7897
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/015.Walker_Hound/015.Walker_Hound_n02089867_24.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  68%|██████▊   | 82/120 [09:28<04:11,  6.63s/it]Processing fast and slow thinking:  69%|██████▉   | 83/120 [09:40<04:58,  8.07s/it]Processing fast and slow thinking:  70%|███████   | 84/120 [09:51<05:16,  8.80s/it]Processing fast and slow thinking:  71%|███████   | 85/120 [10:02<05:33,  9.53s/it]Processing fast and slow thinking:  72%|███████▏  | 86/120 [10:09<04:54,  8.65s/it]Processing fast and slow thinking:  72%|███████▎  | 87/120 [10:22<05:27,  9.92s/it]Processing fast and slow thinking:  74%|███████▍  | 89/120 [10:31<03:56,  7.62s/it]Processing fast and slow thinking:  75%|███████▌  | 90/120 [10:38<03:41,  7.37s/it]Processing fast and slow thinking:  76%|███████▌  | 91/120 [10:44<03:22,  6.97s/it]开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/015.Walker_Hound/015.Walker_Hound_n02089867_24.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['German Short-haired Pointer', 'Bluetick', 'English Foxhound', 'Great Dane', 'English Setter', 'Redbone', 'Whippet', 'Bull Mastiff', 'Basset Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Bluetick (置信度: 0.9000)
总耗时: 9.83秒
failed. pred cate:Bluetick, true cate:015.Walker Hound, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/101.Basenji/101.Basenji_n02110806_4876.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/101.Basenji/101.Basenji_n02110806_4876.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Walker Hound', 'Beagle', 'Basenji', 'Miniature Pinscher', 'Clumber', 'Cardigan', 'Standard Poodle', 'Mexican Hairless', 'Brabancon Griffon']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Basenji (置信度: 0.8500)
总耗时: 12.46秒
succ. pred cate:Basenji, true cate:101.Basenji, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/105.Great_Pyrenees/105.Great_Pyrenees_n02111500_5052.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/105.Great_Pyrenees/105.Great_Pyrenees_n02111500_5052.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Cardigan', 'Japanese Spaniel', 'Borzoi', 'Eskimo Dog', 'English Springer Spaniel', 'Giant Schnauzer', 'Great Pyrenees', 'Airedale', 'Bernese Mountain Dog', 'Weimaraner']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Japanese Spaniel (置信度: 0.8000)
总耗时: 10.88秒
failed. pred cate:Japanese Spaniel, true cate:105.Great Pyrenees, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/046.Giant_Schnauzer/046.Giant_Schnauzer_n02097130_5907.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/046.Giant_Schnauzer/046.Giant_Schnauzer_n02097130_5907.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Kerry Blue Terrier', 'Standard Poodle', 'Clumber', 'Giant Schnauzer', 'Standard Schnauzer', 'Old English Sheepdog', 'Irish Wolfhound', 'Pekinese', 'Tibetan Terrier', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Standard Schnauzer (置信度: 0.8500)
总耗时: 11.47秒
succ. pred cate:Standard Schnauzer, true cate:046.Giant Schnauzer, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/006.Papillon/006.Papillon_n02086910_4388.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/006.Papillon/006.Papillon_n02086910_4388.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Papillon', 'Japanese Spaniel', 'Pekinese', 'Shetland Sheepdog', 'Blenheim Spaniel', 'Tibetan Terrier', 'Maltese Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Papillon (置信度: 0.0000)
总耗时: 6.39秒
succ. pred cate:Papillon, true cate:006.Papillon, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/024.Otterhound/024.Otterhound_n02091635_2068.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/024.Otterhound/024.Otterhound_n02091635_2068.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Otterhound', 'Briard', 'Dandi Dinmont', 'Soft-coated Wheaten Terrier', 'Lhasa', 'Maltese Dog', 'Tibetan Terrier', 'Silky Terrier', 'Sealyham Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Otterhound (置信度: 0.8500)
总耗时: 13.11秒
succ. pred cate:Otterhound, true cate:024.Otterhound, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/031.Border_Terrier/031.Border_Terrier_n02093754_7403.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Border Terrier (置信度: 0.7321)
总耗时: 0.02秒
succ. pred cate:Border Terrier, true cate:031.Border Terrier, used_slow:False, confidence:0.7321
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/030.Bedlington_Terrier/030.Bedlington_Terrier_n02093647_79.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/030.Bedlington_Terrier/030.Bedlington_Terrier_n02093647_79.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Miniature Poodle', 'Bedlington Terrier', 'Old English Sheepdog', 'Kerry Blue Terrier', 'Lakeland Terrier', 'Silky Terrier', 'Maltese Dog', 'Malinois', 'Soft-coated Wheaten Terrier', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Bedlington Terrier (置信度: 0.8500)
总耗时: 9.59秒
succ. pred cate:Bedlington Terrier, true cate:030.Bedlington Terrier, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/051.Soft_coated_Wheaten_Terrier/051.Soft_coated_Wheaten_Terrier_n02098105_838.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/051.Soft_coated_Wheaten_Terrier/051.Soft_coated_Wheaten_Terrier_n02098105_838.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Otterhound', 'Soft-coated Wheaten Terrier', 'Tibetan Terrier', 'Dandi Dinmont', 'Norfolk Terrier', 'Silky Terrier', 'Maltese Dog', 'Australian Terrier', 'Yorkshire Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Otterhound (置信度: 0.0000)
总耗时: 6.58秒
failed. pred cate:Otterhound, true cate:051.Soft coated Wheaten Terrier, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/071.Kuvasz/071.Kuvasz_n02104029_662.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/071.Kuvasz/071.Kuvasz_n02104029_662.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Great Pyrenees', 'Golden Retriever', 'Kuvasz', 'Maltese Dog', 'Chow', 'Pekinese', 'Otterhound', 'Soft-coated Wheaten Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Great Pyrenees (置信度: 0.0000)
总耗时: 5.81秒
failed. pred cate:Great Pyrenees, true cate:071.Kuvasz, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/110.Brabancon_Griffon/110.Brabancon_Griffon_n02112706_1554.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  77%|███████▋  | 92/120 [10:50<03:11,  6.84s/it]Processing fast and slow thinking:  78%|███████▊  | 93/120 [11:03<03:46,  8.41s/it]Processing fast and slow thinking:  78%|███████▊  | 94/120 [11:15<04:08,  9.54s/it]Processing fast and slow thinking:  79%|███████▉  | 95/120 [11:22<03:35,  8.63s/it]Processing fast and slow thinking:  80%|████████  | 96/120 [11:27<03:06,  7.75s/it]Processing fast and slow thinking:  81%|████████  | 97/120 [11:33<02:42,  7.05s/it]Processing fast and slow thinking:  82%|████████▏ | 98/120 [11:38<02:24,  6.55s/it]Processing fast and slow thinking:  82%|████████▎ | 99/120 [11:50<02:51,  8.16s/it]Processing fast and slow thinking:  84%|████████▍ | 101/120 [11:55<01:45,  5.53s/it]开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/110.Brabancon_Griffon/110.Brabancon_Griffon_n02112706_1554.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Brabancon Griffon', 'Pug', 'Border Terrier', 'Pekinese', 'Affenpinscher', 'Maltese Dog', 'Bloodhound', 'Yorkshire Terrier', 'Silky Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Brabancon Griffon (置信度: 0.0000)
总耗时: 6.50秒
succ. pred cate:Brabancon Griffon, true cate:110.Brabancon Griffon, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/060.Vizsla/060.Vizsla_n02100583_6521.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/060.Vizsla/060.Vizsla_n02100583_6521.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Bloodhound', 'Redbone', 'Vizsla', 'Black-and-tan Coonhound', 'Rhodesian Ridgeback', 'Silky Terrier', 'Brittany']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Redbone (置信度: 0.9000)
总耗时: 12.48秒
failed. pred cate:Redbone, true cate:060.Vizsla, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/026.Scottish_Deerhound/026.Scottish_Deerhound_n02092002_1727.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/026.Scottish_Deerhound/026.Scottish_Deerhound_n02092002_1727.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Scottish Deerhound', 'Irish Wolfhound', 'Groenendael', 'Standard Schnauzer', 'Norwegian Elkhound', 'Borzoi', 'Dingo', 'Bedlington Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Irish Wolfhound (置信度: 0.8500)
总耗时: 12.39秒
failed. pred cate:Irish Wolfhound, true cate:026.Scottish Deerhound, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/080.Collie/080.Collie_n02106030_10057.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/080.Collie/080.Collie_n02106030_10057.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Shetland Sheepdog', 'Cardigan', 'Malamute', 'Keeshond', 'Appenzeller', 'Afghan Hound', 'Old English Sheepdog', 'Saint Bernard', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Shetland Sheepdog (置信度: 0.0000)
总耗时: 6.38秒
failed. pred cate:Shetland Sheepdog, true cate:080.Collie, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/096.Saint_Bernard/096.Saint_Bernard_n02109525_18948.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/096.Saint_Bernard/096.Saint_Bernard_n02109525_18948.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Saint Bernard', 'Bernese Mountain Dog', 'Basset Hound', 'Clumber', 'Bloodhound', 'Greater Swiss Mountain Dog', 'Golden Retriever', 'Redbone', 'Airedale']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Saint Bernard (置信度: 0.0000)
总耗时: 5.63秒
succ. pred cate:Saint Bernard, true cate:096.Saint Bernard, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/081.Border_Collie/081.Border_Collie_n02106166_3882.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/081.Border_Collie/081.Border_Collie_n02106166_3882.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Collie', 'Shetland Sheepdog', 'Japanese Spaniel', 'Eskimo Dog', 'Papillon', 'Bernese Mountain Dog', 'Afghan Hound', 'Keeshond', 'Golden Retriever', 'Tibetan Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Collie (置信度: 0.0000)
总耗时: 5.35秒
succ. pred cate:Collie, true cate:081.Border Collie, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/005.Blenheim_Spaniel/005.Blenheim_Spaniel_n02086646_3986.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/005.Blenheim_Spaniel/005.Blenheim_Spaniel_n02086646_3986.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Blenheim Spaniel', 'Japanese Spaniel', 'Clumber', 'Shih-Tzu', 'Brittany', 'Silky Terrier', 'Maltese Dog', 'Australian Terrier', 'Papillon']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Blenheim Spaniel (置信度: 0.0000)
总耗时: 5.36秒
succ. pred cate:Blenheim Spaniel, true cate:005.Blenheim Spaniel, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/038.Lakeland_Terrier/038.Lakeland_Terrier_n02095570_4782.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/038.Lakeland_Terrier/038.Lakeland_Terrier_n02095570_4782.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Curly-coater Retriever', 'Kerry Blue Terrier', 'Giant Schnauzer', 'Flat-coated Retriever', 'Miniature Poodle', 'Kuvasz', 'Tibetan Mastiff', 'Silky Terrier', 'Irish Setter']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Kerry Blue Terrier (置信度: 0.8500)
总耗时: 11.96秒
succ. pred cate:Kerry Blue Terrier, true cate:038.Lakeland Terrier, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/092.Bull_Mastiff/092.Bull_Mastiff_n02108422_5221.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Bull Mastiff (置信度: 0.7078)
总耗时: 0.02秒
succ. pred cate:Bull Mastiff, true cate:092.Bull Mastiff, used_slow:False, confidence:0.7078
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/104.Newfoundland/104.Newfoundland_n02111277_8856.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/104.Newfoundland/104.Newfoundland_n02111277_8856.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Newfoundland', 'Bouvier des Flandres', 'Flat-coated Retriever', 'Giant Schnauzer', 'Briard', 'Bernese Mountain Dog', 'Afghan Hound', 'Old English Sheepdog', 'Tibetan Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Newfoundland (置信度: 0.0000)
总耗时: 4.86秒
succ. pred cate:Newfoundland, true cate:104.Newfoundland, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/076.Kelpie/076.Kelpie_n02105412_5288.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/076.Kelpie/076.Kelpie_n02105412_5288.jpg
步骤1: 提取快思考候选类别...
Processing fast and slow thinking:  85%|████████▌ | 102/120 [12:00<01:38,  5.45s/it]Processing fast and slow thinking:  86%|████████▌ | 103/120 [12:05<01:31,  5.38s/it]Processing fast and slow thinking:  87%|████████▋ | 104/120 [12:15<01:45,  6.56s/it]Processing fast and slow thinking:  88%|████████▊ | 105/120 [12:25<01:55,  7.70s/it]Processing fast and slow thinking:  88%|████████▊ | 106/120 [12:36<01:57,  8.40s/it]Processing fast and slow thinking:  89%|████████▉ | 107/120 [12:42<01:40,  7.70s/it]Processing fast and slow thinking:  90%|█████████ | 108/120 [12:55<01:51,  9.31s/it]Processing fast and slow thinking:  91%|█████████ | 109/120 [13:01<01:32,  8.38s/it]Processing fast and slow thinking:  92%|█████████▏| 110/120 [13:11<01:28,  8.87s/it]Processing fast and slow thinking:  92%|█████████▎| 111/120 [13:15<01:07,  7.52s/it]快思考Top-5候选类别: ['Kelpie', 'German Shepard', 'EntleBucher', 'Miniature Pinscher', 'Collie', 'Great Dane', 'Groenendael', 'Whippet', 'Greater Swiss Mountain Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Kelpie (置信度: 0.0000)
总耗时: 5.20秒
succ. pred cate:Kelpie, true cate:076.Kelpie, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/074.Malinois/074.Malinois_n02105162_6106.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/074.Malinois/074.Malinois_n02105162_6106.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Malinois', 'German Shepard', 'Groenendael', 'Norwegian Elkhound', 'Leonberg', 'Bull Mastiff', 'Redbone', 'Great Dane']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Malinois (置信度: 0.0000)
总耗时: 5.17秒
succ. pred cate:Malinois, true cate:074.Malinois, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/052.West_Highland_White_Terrier/052.West_Highland_White_Terrier_n02098286_1632.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/052.West_Highland_White_Terrier/052.West_Highland_White_Terrier_n02098286_1632.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Chow', 'Malamute', 'Eskimo Dog', 'Samoyed', 'Shetland Sheepdog', 'Bouvier des Flandres', 'Miniature Schnauzer', 'Lhasa', 'Airedale']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Shetland Sheepdog (置信度: 0.8000)
总耗时: 9.75秒
failed. pred cate:Shetland Sheepdog, true cate:052.West Highland White Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/069.Sussex_Spaniel/069.Sussex_Spaniel_n02102480_5703.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/069.Sussex_Spaniel/069.Sussex_Spaniel_n02102480_5703.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Airedale', 'Otterhound', 'Irish Terrier', 'Soft-coated Wheaten Terrier', 'Lakeland Terrier', 'Kerry Blue Terrier', 'Sealyham Terrier', 'Kuvasz', 'Silky Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Cocker Spaniel (置信度: 0.8500)
总耗时: 10.62秒
succ. pred cate:Cocker Spaniel, true cate:069.Sussex Spaniel, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/091.Boxer/091.Boxer_n02108089_14719.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/091.Boxer/091.Boxer_n02108089_14719.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Bull Mastiff', 'Boxer', 'Saint Bernard', 'Staffordshire Bullterrier', 'Appenzeller', 'Redbone', 'Greater Swiss Mountain Dog', 'Beagle', 'Bloodhound', 'French Bulldog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
模糊匹配类别修正: 'is clear.' -> 'Vizsla'
快慢思考结果不一致，进行最终融合决策...
分类完成: Boxer (置信度: 0.9000)
总耗时: 10.16秒
succ. pred cate:Boxer, true cate:091.Boxer, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/108.Chow/108.Chow_n02112137_14448.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/108.Chow/108.Chow_n02112137_14448.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Chow', 'Pomeranian', 'Keeshond', 'Pekinese', 'Tibetan Mastiff', 'Pembroke', 'Maltese Dog', 'Toy Poodle', 'Japanese Spaniel']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Chow (置信度: 0.0000)
总耗时: 5.97秒
succ. pred cate:Chow, true cate:108.Chow, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/049.Tibetan_Terrier/049.Tibetan_Terrier_n02097474_5841.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/049.Tibetan_Terrier/049.Tibetan_Terrier_n02097474_5841.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Dandi Dinmont', 'Soft-coated Wheaten Terrier', 'Maltese Dog', 'Miniature Poodle', 'Lhasa', 'Kuvasz', 'Otterhound', 'Silky Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Soft-coated Wheaten Terrier (置信度: 0.8500)
总耗时: 13.22秒
failed. pred cate:Soft-coated Wheaten Terrier, true cate:049.Tibetan Terrier, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/056.Golden_Retriever/056.Golden_Retriever_n02099601_3360.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/056.Golden_Retriever/056.Golden_Retriever_n02099601_3360.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Golden Retriever', 'Labrador Retriever', 'Great Pyrenees', 'Flat-coated Retriever', 'Saluki', 'Silky Terrier', 'Redbone', 'Basset Hound', 'Bull Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Golden Retriever (置信度: 0.0000)
总耗时: 6.15秒
succ. pred cate:Golden Retriever, true cate:056.Golden Retriever, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/097.Eskimo_Dog/097.Eskimo_Dog_n02109961_9973.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/097.Eskimo_Dog/097.Eskimo_Dog_n02109961_9973.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Collie', 'Siberian Husky', 'Eskimo Dog', 'English Springer Spaniel', 'Brittany', 'Malinois', 'Kelpie', 'Maltese Dog', 'Silky Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Siberian Husky (置信度: 0.8500)
总耗时: 10.03秒
failed. pred cate:Siberian Husky, true cate:097.Eskimo Dog, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/001.Japanese_Spaniel/001.Japanese_Spaniel_n02085782_1691.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/001.Japanese_Spaniel/001.Japanese_Spaniel_n02085782_1691.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Japanese Spaniel', 'Blenheim Spaniel', 'Tibetan Terrier', 'Pekinese', 'Shih-Tzu', 'Papillon', 'Afghan Hound', 'Sealyham Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Japanese Spaniel (置信度: 0.0000)
总耗时: 4.33秒
succ. pred cate:Japanese Spaniel, true cate:001.Japanese Spaniel, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/115.Standard_Poodle/115.Standard_Poodle_n02113799_1537.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  93%|█████████▎| 112/120 [13:26<01:07,  8.38s/it]Processing fast and slow thinking:  94%|█████████▍| 113/120 [13:38<01:05,  9.39s/it]Processing fast and slow thinking:  95%|█████████▌| 114/120 [13:49<01:00, 10.12s/it]Processing fast and slow thinking:  97%|█████████▋| 116/120 [13:55<00:26,  6.66s/it]Processing fast and slow thinking:  98%|█████████▊| 117/120 [14:00<00:18,  6.32s/it]Processing fast and slow thinking:  98%|█████████▊| 118/120 [14:12<00:15,  7.92s/it]Processing fast and slow thinking:  99%|█████████▉| 119/120 [14:18<00:07,  7.27s/it]Processing fast and slow thinking: 100%|██████████| 120/120 [14:29<00:00,  8.45s/it]Processing fast and slow thinking: 100%|██████████| 120/120 [14:29<00:00,  7.25s/it]
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/115.Standard_Poodle/115.Standard_Poodle_n02113799_1537.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Kerry Blue Terrier', 'Miniature Poodle', 'Curly-coater Retriever', 'Bedlington Terrier', 'Irish Water Spaniel', 'Silky Terrier', 'Maltese Dog', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Miniature Poodle (置信度: 0.8500)
总耗时: 10.42秒
succ. pred cate:Miniature Poodle, true cate:115.Standard Poodle, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/065.Clumber/065.Clumber_n02101556_4514.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/065.Clumber/065.Clumber_n02101556_4514.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Welsh Springer Spaniel', 'Brittany', 'English Setter', 'Sussex Spaniel', 'Clumber', 'Otterhound', 'Great Dane', 'Tibetan Terrier', 'Cocker Spaniel', 'Bouvier des Flandres']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Clumber (置信度: 0.8500)
总耗时: 11.77秒
succ. pred cate:Clumber, true cate:065.Clumber, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/016.English_Foxhound/016.English_Foxhound_n02089973_1907.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/016.English_Foxhound/016.English_Foxhound_n02089973_1907.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Bluetick', 'Walker Hound', 'Clumber', 'English Foxhound', 'Beagle', 'Standard Poodle', 'Cardigan', 'Basset Hound', 'Black-and-tan Coonhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Bluetick (置信度: 0.8000)
总耗时: 11.82秒
failed. pred cate:Bluetick, true cate:016.English Foxhound, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/103.Leonberg/103.Leonberg_n02111129_1197.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Leonberg (置信度: 0.9518)
总耗时: 0.02秒
succ. pred cate:Leonberg, true cate:103.Leonberg, used_slow:False, confidence:0.9518
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/021.Whippet/021.Whippet_n02091134_15784.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/021.Whippet/021.Whippet_n02091134_15784.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Whippet', 'Great Dane', 'Saluki', 'Scottish Deerhound', 'African Hunting Dog', 'Bull Mastiff', 'Redbone', 'Kelpie']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Whippet (置信度: 0.0000)
总耗时: 5.20秒
succ. pred cate:Whippet, true cate:021.Whippet, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/032.Kerry_Blue_Terrier/032.Kerry_Blue_Terrier_n02093859_393.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/032.Kerry_Blue_Terrier/032.Kerry_Blue_Terrier_n02093859_393.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Kerry Blue Terrier', 'Giant Schnauzer', 'Standard Schnauzer', 'Bouvier des Flandres', 'Miniature Schnauzer', 'Tibetan Terrier', 'Maltese Dog', 'Afghan Hound', 'Bedlington Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Kerry Blue Terrier (置信度: 0.0000)
总耗时: 5.31秒
succ. pred cate:Kerry Blue Terrier, true cate:032.Kerry Blue Terrier, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/055.Curly_coater_Retriever/055.Curly_coater_Retriever_n02099429_618.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/055.Curly_coater_Retriever/055.Curly_coater_Retriever_n02099429_618.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Curly-coater Retriever', 'Flat-coated Retriever', 'Irish Water Spaniel', 'Newfoundland', 'Giant Schnauzer', 'Kerry Blue Terrier', 'Sealyham Terrier', 'Afghan Hound', 'Tibetan Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Curly-coated Retriever (置信度: 0.8500)
总耗时: 12.45秒
succ. pred cate:Curly-coated Retriever, true cate:055.Curly coater Retriever, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/054.Flat_coated_Retriever/054.Flat_coated_Retriever_n02099267_5540.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/054.Flat_coated_Retriever/054.Flat_coated_Retriever_n02099267_5540.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['Flat-coated Retriever', 'Curly-coater Retriever', 'Clumber', 'Cocker Spaniel', 'Newfoundland', 'Giant Schnauzer', 'Great Dane', 'Tibetan Mastiff', 'Kuvasz', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
分类完成: Flat-coated Retriever (置信度: 0.0000)
总耗时: 5.50秒
succ. pred cate:Flat-coated Retriever, true cate:054.Flat coated Retriever, used_slow:True, confidence:0.0000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/093.Tibetan_Mastiff/093.Tibetan_Mastiff_n02108551_7523.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/093.Tibetan_Mastiff/093.Tibetan_Mastiff_n02108551_7523.jpg
步骤1: 提取快思考候选类别...
快思考Top-5候选类别: ['English Springer Spaniel', 'Japanese Spaniel', 'Clumber', 'Collie', 'Maltese Dog', 'Scotch Terrier', 'Cocker Spaniel', 'Lhasa', 'English Foxhound', 'Great Pyrenees']
步骤3: 使用MLLM进行最终推理（基于经验库）...
快慢思考结果不一致，进行最终融合决策...
分类完成: Collie (置信度: 0.8000)
总耗时: 11.49秒
failed. pred cate:Collie, true cate:093.Tibetan Mastiff, used_slow:True, confidence:0.8000
✅ 正确预测总数: 92
  - 其中仅快思考正确: 10
  - 其中慢思考触发且正确: 82
❌ 错误预测总数: 28
📊 慢思考触发数量: 110
[fast and slow] 总体准确率: 0.7667 (92/120)
[fast and slow] 快思考准确率: 1.0000
[fast and slow] 慢思考触发比例: 0.9167
[fast and slow] 慢思考准确率: 0.7455
