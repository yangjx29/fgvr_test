/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
当前数据集: dog (dog120)
类别数: 120
实验目录: ./experiments/dog120
当前使用的 GPU 为：8

=== Experiment Start Time: 2025-11-22 12:39:34 ===

=== Experiment Arguments ===
{'confidence_threshold': 0.8,
 'config_file_env': './configs/env_machine.yml',
 'config_file_expt': './configs/expts/dog120_all.yml',
 'fusion_method': 'concat',
 'gallery_out': None,
 'knowledge_base_dir': './experiments/dog120/knowledge_base',
 'kshot': None,
 'mode': 'fast_slow',
 'num_per_category': '3',
 'query_image': None,
 'region_num': None,
 'results_out': './results/dog_fast_slow_results.json',
 'similarity_threshold': 0.7,
 'superclass': None,
 'test_data_dir': './datasets/dogs_120/images_discovery_all_1',
 'use_slow_thinking': None}
=== Configuration (cfg) ===
{'batch_size': 128,
 'clustering_method': 'multi_clip_voting',
 'data_dir': './datasets/dogs_120',
 'dataset_name': 'dog',
 'device': 'cuda',
 'device_count': '1',
 'device_id': '0',
 'experiment': 5.0,
 'expt_dir': './experiments/dog120',
 'expt_dir_describe': './experiments/dog120/describe',
 'expt_dir_gallery': './experiments/dog120/gallery',
 'expt_dir_grouping': './experiments/dog120/grouping',
 'expt_dir_guess': './experiments/dog120/guess',
 'host': 'xiao',
 'image_size': 224,
 'model_size': 'ViT-B/16',
 'model_size_mllm': 'Qwen2.5-VL-7B',
 'model_size_vqa': 'OPT6.7B-COCO',
 'model_type_llm': 'gpt-3.5-turbo',
 'num_base': 60,
 'num_classes': 120,
 'num_novel': 60,
 'num_workers': 16,
 'path_descriptions': './experiments/dog120/gallery/dog_image_descriptions_attn',
 'path_identify_answers': './experiments/dog120/identify',
 'path_llm_gussed_names': './experiments/dog120/guess/dog_llm_gussed_names',
 'path_llm_prompts': './experiments/dog120/describe/dog_llm_prompts',
 'path_llm_replies_jsoned': './experiments/dog120/guess/dog_llm_replies_jsoned',
 'path_llm_replies_raw': './experiments/dog120/guess/dog_llm_replies_raw',
 'path_references': './experiments/dog120/gallery/dog_image_references',
 'path_regions': './experiments/dog120/gallery/dog_image_regions',
 'path_vqa_answers': './experiments/dog120/describe/dog_attributes_pairs',
 'path_vqa_questions': './experiments/dog120/describe/dog_vqa_questions_ours',
 'seed': 1,
 'setup': 'ours',
 'verbose': False}
初始化MLLM模型...
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:01<00:04,  1.09s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:02<00:03,  1.22s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:03<00:02,  1.27s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:05<00:01,  1.27s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:05<00:00,  1.01s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:05<00:00,  1.11s/it]
✓ 已启用梯度检查点以节省显存
local_model_path: ./models/Qwen/Qwen2.5-VL-7B-Instruct
初始化知识库构建器...
初始化快思考模块...
使用数据集stats文件: ./experiments/dog120/knowledge_base/stats.json
已加载历史统计量: 5196 次预测
初始化慢思考模块...
慢思考默认保存目录: ./experiments/dog120/knowledge_base
使用数据集: dog, 类别数: 120
[2025-11-22 12:40:32] [显存监控] 已分配=16.90GB, 已保留=17.10GB, 空闲=30.50GB
快慢思考系统初始化完成!
从 ./experiments/dog120/knowledge_base 加载知识库...
Self-Belief已从 ./experiments/dog120/knowledge_base/self_belief.txt 加载
知识库已从 ./experiments/dog120/knowledge_base 加载
知识库加载完成!
初始化经验库构建器...
经验库构建器初始化完成!
加载self_belief:You are an expert in fine-grained visual recognition. Please follow these steps:
    1. Observe: First, look at the overall object and identify its coarse category (e.g., bird, dog, car).
    2. Localize: Then, identify the most discriminative local parts.
    3. Compare: Recall the visual characteristics of the candidate subcategories from your knowledge.
    4. Decide: Based on the match between observed details and subcategory descriptions, choose the most likely class.
    Answer only with the final class name.

Policy Memory (learned strategy rules):
1. Verify the highest similarity score against the observed features before making a final prediction. (Trigger: Whenever the highest similarity score does not align with the observed features in an image.)
2. Carefully analyze the texture of the coat and the overall body structure to distinguish between silky and shaggy breeds. (Trigger: When dealing with small dogs with pointed ears and shaggy coats.)
3. Focus on distinctive facial features and body structure when distinguishing between breeds with similar coat textures and color patterns. (Trigger: When dealing with breeds that share similar coat textures and color patterns, especially those with distinctive facial features or body structures.)

经验库已从 ./experiments/dog120/knowledge_base 加载完成
经验库已设置到慢思考模块
经验库加载完成!
test sample:{'107.Pomeranian': ['./datasets/dogs_120/images_discovery_all_1/107.Pomeranian/107.Pomeranian_n02112018_1577.jpg'], '023.Norwegian Elkhound': ['./datasets/dogs_120/images_discovery_all_1/023.Norwegian_Elkhound/023.Norwegian_Elkhound_n02091467_4362.jpg'], '039.Sealyham Terrier': ['./datasets/dogs_120/images_discovery_all_1/039.Sealyham_Terrier/039.Sealyham_Terrier_n02095889_610.jpg'], '014.Black and tan Coonhound': ['./datasets/dogs_120/images_discovery_all_1/014.Black_and_tan_Coonhound/014.Black_and_tan_Coonhound_n02089078_1275.jpg'], '075.Briard': ['./datasets/dogs_120/images_discovery_all_1/075.Briard/075.Briard_n02105251_2591.jpg'], '056.Golden Retriever': ['./datasets/dogs_120/images_discovery_all_1/056.Golden_Retriever/056.Golden_Retriever_n02099601_3360.jpg'], '105.Great Pyrenees': ['./datasets/dogs_120/images_discovery_all_1/105.Great_Pyrenees/105.Great_Pyrenees_n02111500_5052.jpg'], '019.Irish Wolfhound': ['./datasets/dogs_120/images_discovery_all_1/019.Irish_Wolfhound/019.Irish_Wolfhound_n02090721_537.jpg'], '003.Pekinese': ['./datasets/dogs_120/images_discovery_all_1/003.Pekinese/003.Pekinese_n02086079_8902.jpg'], '081.Border Collie': ['./datasets/dogs_120/images_discovery_all_1/081.Border_Collie/081.Border_Collie_n02106166_3882.jpg'], '102.Pug': ['./datasets/dogs_120/images_discovery_all_1/102.Pug/102.Pug_n02110958_1975.jpg'], '116.Mexican Hairless': ['./datasets/dogs_120/images_discovery_all_1/116.Mexican_Hairless/116.Mexican_Hairless_n02113978_2888.jpg'], '078.Old English Sheepdog': ['./datasets/dogs_120/images_discovery_all_1/078.Old_English_Sheepdog/078.Old_English_Sheepdog_n02105641_3531.jpg'], '048.Scotch Terrier': ['./datasets/dogs_120/images_discovery_all_1/048.Scotch_Terrier/048.Scotch_Terrier_n02097298_2443.jpg'], '051.Soft coated Wheaten Terrier': ['./datasets/dogs_120/images_discovery_all_1/051.Soft_coated_Wheaten_Terrier/051.Soft_coated_Wheaten_Terrier_n02098105_838.jpg'], '061.English Setter': ['./datasets/dogs_120/images_discovery_all_1/061.English_Setter/061.English_Setter_n02100735_3595.jpg'], '087.Greater Swiss Mountain Dog': ['./datasets/dogs_120/images_discovery_all_1/087.Greater_Swiss_Mountain_Dog/087.Greater_Swiss_Mountain_Dog_n02107574_2436.jpg'], '009.Afghan Hound': ['./datasets/dogs_120/images_discovery_all_1/009.Afghan_Hound/009.Afghan_Hound_n02088094_6035.jpg'], '006.Papillon': ['./datasets/dogs_120/images_discovery_all_1/006.Papillon/006.Papillon_n02086910_4388.jpg'], '013.Bluetick': ['./datasets/dogs_120/images_discovery_all_1/013.Bluetick/013.Bluetick_n02088632_4058.jpg'], '063.Gordon Setter': ['./datasets/dogs_120/images_discovery_all_1/063.Gordon_Setter/063.Gordon_Setter_n02101006_2540.jpg'], '066.English Springer Spaniel': ['./datasets/dogs_120/images_discovery_all_1/066.English_Springer_Spaniel/066.English_Springer_Spaniel_n02102040_5096.jpg'], '012.Bloodhound': ['./datasets/dogs_120/images_discovery_all_1/012.Bloodhound/012.Bloodhound_n02088466_4731.jpg'], '069.Sussex Spaniel': ['./datasets/dogs_120/images_discovery_all_1/069.Sussex_Spaniel/069.Sussex_Spaniel_n02102480_5703.jpg'], '059.German Short haired Pointer': ['./datasets/dogs_120/images_discovery_all_1/059.German_Short_haired_Pointer/059.German_Short_haired_Pointer_n02100236_4198.jpg'], '100.Affenpinscher': ['./datasets/dogs_120/images_discovery_all_1/100.Affenpinscher/100.Affenpinscher_n02110627_10439.jpg'], '103.Leonberg': ['./datasets/dogs_120/images_discovery_all_1/103.Leonberg/103.Leonberg_n02111129_1197.jpg'], '025.Saluki': ['./datasets/dogs_120/images_discovery_all_1/025.Saluki/025.Saluki_n02091831_11021.jpg'], '043.Dandi Dinmont': ['./datasets/dogs_120/images_discovery_all_1/043.Dandi_Dinmont/043.Dandi_Dinmont_n02096437_730.jpg'], '000.Chihuaha': ['./datasets/dogs_120/images_discovery_all_1/000.Chihuaha/000.Chihuaha_n02085620_3488.jpg'], '113.Toy Poodle': ['./datasets/dogs_120/images_discovery_all_1/113.Toy_Poodle/113.Toy_Poodle_n02113624_665.jpg'], '058.Chesapeake Bay Retriever': ['./datasets/dogs_120/images_discovery_all_1/058.Chesapeake_Bay_Retriever/058.Chesapeake_Bay_Retriever_n02099849_513.jpg'], '052.West Highland White Terrier': ['./datasets/dogs_120/images_discovery_all_1/052.West_Highland_White_Terrier/052.West_Highland_White_Terrier_n02098286_1632.jpg'], '082.Bouvier des Flandres': ['./datasets/dogs_120/images_discovery_all_1/082.Bouvier_des_Flandres/082.Bouvier_des_Flandres_n02106382_1151.jpg'], '021.Whippet': ['./datasets/dogs_120/images_discovery_all_1/021.Whippet/021.Whippet_n02091134_15784.jpg'], '046.Giant Schnauzer': ['./datasets/dogs_120/images_discovery_all_1/046.Giant_Schnauzer/046.Giant_Schnauzer_n02097130_5907.jpg'], '088.Bernese Mountain Dog': ['./datasets/dogs_120/images_discovery_all_1/088.Bernese_Mountain_Dog/088.Bernese_Mountain_Dog_n02107683_6301.jpg'], '080.Collie': ['./datasets/dogs_120/images_discovery_all_1/080.Collie/080.Collie_n02106030_10057.jpg'], '015.Walker Hound': ['./datasets/dogs_120/images_discovery_all_1/015.Walker_Hound/015.Walker_Hound_n02089867_24.jpg'], '057.Labrador Retriever': ['./datasets/dogs_120/images_discovery_all_1/057.Labrador_Retriever/057.Labrador_Retriever_n02099712_3613.jpg'], '040.Airedale': ['./datasets/dogs_120/images_discovery_all_1/040.Airedale/040.Airedale_n02096051_8826.jpg'], '104.Newfoundland': ['./datasets/dogs_120/images_discovery_all_1/104.Newfoundland/104.Newfoundland_n02111277_8856.jpg'], '032.Kerry Blue Terrier': ['./datasets/dogs_120/images_discovery_all_1/032.Kerry_Blue_Terrier/032.Kerry_Blue_Terrier_n02093859_393.jpg'], '047.Standard Schnauzer': ['./datasets/dogs_120/images_discovery_all_1/047.Standard_Schnauzer/047.Standard_Schnauzer_n02097209_2194.jpg'], '117.Dingo': ['./datasets/dogs_120/images_discovery_all_1/117.Dingo/117.Dingo_n02115641_925.jpg'], '055.Curly coater Retriever': ['./datasets/dogs_120/images_discovery_all_1/055.Curly_coater_Retriever/055.Curly_coater_Retriever_n02099429_618.jpg'], '089.Appenzeller': ['./datasets/dogs_120/images_discovery_all_1/089.Appenzeller/089.Appenzeller_n02107908_7236.jpg'], '101.Basenji': ['./datasets/dogs_120/images_discovery_all_1/101.Basenji/101.Basenji_n02110806_4876.jpg'], '077.Komondor': ['./datasets/dogs_120/images_discovery_all_1/077.Komondor/077.Komondor_n02105505_3933.jpg'], '115.Standard Poodle': ['./datasets/dogs_120/images_discovery_all_1/115.Standard_Poodle/115.Standard_Poodle_n02113799_1537.jpg'], '045.Miniature Schnauzer': ['./datasets/dogs_120/images_discovery_all_1/045.Miniature_Schnauzer/045.Miniature_Schnauzer_n02097047_724.jpg'], '095.Great Dane': ['./datasets/dogs_120/images_discovery_all_1/095.Great_Dane/095.Great_Dane_n02109047_34175.jpg'], '092.Bull Mastiff': ['./datasets/dogs_120/images_discovery_all_1/092.Bull_Mastiff/092.Bull_Mastiff_n02108422_5221.jpg'], '018.Borzoi': ['./datasets/dogs_120/images_discovery_all_1/018.Borzoi/018.Borzoi_n02090622_6976.jpg'], '022.Ibizian Hound': ['./datasets/dogs_120/images_discovery_all_1/022.Ibizian_Hound/022.Ibizian_Hound_n02091244_5818.jpg'], '044.Boston Bull': ['./datasets/dogs_120/images_discovery_all_1/044.Boston_Bull/044.Boston_Bull_n02096585_5260.jpg'], '110.Brabancon Griffon': ['./datasets/dogs_120/images_discovery_all_1/110.Brabancon_Griffon/110.Brabancon_Griffon_n02112706_1554.jpg'], '067.Welsh Springer Spaniel': ['./datasets/dogs_120/images_discovery_all_1/067.Welsh_Springer_Spaniel/067.Welsh_Springer_Spaniel_n02102177_1128.jpg'], '076.Kelpie': ['./datasets/dogs_120/images_discovery_all_1/076.Kelpie/076.Kelpie_n02105412_5288.jpg'], '072.Schipperke': ['./datasets/dogs_120/images_discovery_all_1/072.Schipperke/072.Schipperke_n02104365_6140.jpg'], '065.Clumber': ['./datasets/dogs_120/images_discovery_all_1/065.Clumber/065.Clumber_n02101556_4514.jpg'], '049.Tibetan Terrier': ['./datasets/dogs_120/images_discovery_all_1/049.Tibetan_Terrier/049.Tibetan_Terrier_n02097474_5841.jpg'], '114.Miniature Poodle': ['./datasets/dogs_120/images_discovery_all_1/114.Miniature_Poodle/114.Miniature_Poodle_n02113712_2274.jpg'], '111.Pembroke': ['./datasets/dogs_120/images_discovery_all_1/111.Pembroke/111.Pembroke_n02113023_6140.jpg'], '036.Yorkshire Terrier': ['./datasets/dogs_120/images_discovery_all_1/036.Yorkshire_Terrier/036.Yorkshire_Terrier_n02094433_730.jpg'], '068.Cocker Spaniel': ['./datasets/dogs_120/images_discovery_all_1/068.Cocker_Spaniel/068.Cocker_Spaniel_n02102318_6612.jpg'], '086.Miniature Pinscher': ['./datasets/dogs_120/images_discovery_all_1/086.Miniature_Pinscher/086.Miniature_Pinscher_n02107312_3227.jpg'], '071.Kuvasz': ['./datasets/dogs_120/images_discovery_all_1/071.Kuvasz/071.Kuvasz_n02104029_662.jpg'], '112.Cardigan': ['./datasets/dogs_120/images_discovery_all_1/112.Cardigan/112.Cardigan_n02113186_5833.jpg'], '070.Irish Water Spaniel': ['./datasets/dogs_120/images_discovery_all_1/070.Irish_Water_Spaniel/070.Irish_Water_Spaniel_n02102973_2642.jpg'], '020.Italian Greyhound': ['./datasets/dogs_120/images_discovery_all_1/020.Italian_Greyhound/020.Italian_Greyhound_n02091032_490.jpg'], '034.Norfolk Terrier': ['./datasets/dogs_120/images_discovery_all_1/034.Norfolk_Terrier/034.Norfolk_Terrier_n02094114_99.jpg'], '002.Maltese Dog': ['./datasets/dogs_120/images_discovery_all_1/002.Maltese_Dog/002.Maltese_Dog_n02085936_16355.jpg'], '119.African Hunting Dog': ['./datasets/dogs_120/images_discovery_all_1/119.African_Hunting_Dog/119.African_Hunting_Dog_n02116738_8653.jpg'], '084.German Shepard': ['./datasets/dogs_120/images_discovery_all_1/084.German_Shepard/084.German_Shepard_n02106662_9625.jpg'], '038.Lakeland Terrier': ['./datasets/dogs_120/images_discovery_all_1/038.Lakeland_Terrier/038.Lakeland_Terrier_n02095570_4782.jpg'], '099.Siberian Husky': ['./datasets/dogs_120/images_discovery_all_1/099.Siberian_Husky/099.Siberian_Husky_n02110185_12380.jpg'], '109.Keeshond': ['./datasets/dogs_120/images_discovery_all_1/109.Keeshond/109.Keeshond_n02112350_7087.jpg'], '017.Redbone': ['./datasets/dogs_120/images_discovery_all_1/017.Redbone/017.Redbone_n02090379_3996.jpg'], '106.Samoyed': ['./datasets/dogs_120/images_discovery_all_1/106.Samoyed/106.Samoyed_n02111889_6592.jpg'], '028.Staffordshire Bullterrier': ['./datasets/dogs_120/images_discovery_all_1/028.Staffordshire_Bullterrier/028.Staffordshire_Bullterrier_n02093256_11732.jpg'], '062.Irish Setter': ['./datasets/dogs_120/images_discovery_all_1/062.Irish_Setter/062.Irish_Setter_n02100877_5286.jpg'], '010.Basset Hound': ['./datasets/dogs_120/images_discovery_all_1/010.Basset_Hound/010.Basset_Hound_n02088238_7181.jpg'], '041.Cairn': ['./datasets/dogs_120/images_discovery_all_1/041.Cairn/041.Cairn_n02096177_5206.jpg'], '004.Shih Tzu': ['./datasets/dogs_120/images_discovery_all_1/004.Shih_Tzu/004.Shih_Tzu_n02086240_1011.jpg'], '090.EntleBucher': ['./datasets/dogs_120/images_discovery_all_1/090.EntleBucher/090.EntleBucher_n02108000_716.jpg'], '042.Australian Terrier': ['./datasets/dogs_120/images_discovery_all_1/042.Australian_Terrier/042.Australian_Terrier_n02096294_3554.jpg'], '008.Rhodesian Ridgeback': ['./datasets/dogs_120/images_discovery_all_1/008.Rhodesian_Ridgeback/008.Rhodesian_Ridgeback_n02087394_3795.jpg'], '029.American Staffordshire Terrier': ['./datasets/dogs_120/images_discovery_all_1/029.American_Staffordshire_Terrier/029.American_Staffordshire_Terrier_n02093428_3353.jpg'], '094.French Bulldog': ['./datasets/dogs_120/images_discovery_all_1/094.French_Bulldog/094.French_Bulldog_n02108915_7608.jpg'], '085.Doberman': ['./datasets/dogs_120/images_discovery_all_1/085.Doberman/085.Doberman_n02107142_4763.jpg'], '053.Lhasa': ['./datasets/dogs_120/images_discovery_all_1/053.Lhasa/053.Lhasa_n02098413_3033.jpg'], '030.Bedlington Terrier': ['./datasets/dogs_120/images_discovery_all_1/030.Bedlington_Terrier/030.Bedlington_Terrier_n02093647_79.jpg'], '016.English Foxhound': ['./datasets/dogs_120/images_discovery_all_1/016.English_Foxhound/016.English_Foxhound_n02089973_1907.jpg'], '108.Chow': ['./datasets/dogs_120/images_discovery_all_1/108.Chow/108.Chow_n02112137_14448.jpg'], '001.Japanese Spaniel': ['./datasets/dogs_120/images_discovery_all_1/001.Japanese_Spaniel/001.Japanese_Spaniel_n02085782_1691.jpg'], '073.Groenendael': ['./datasets/dogs_120/images_discovery_all_1/073.Groenendael/073.Groenendael_n02105056_7068.jpg'], '083.Rottweiler': ['./datasets/dogs_120/images_discovery_all_1/083.Rottweiler/083.Rottweiler_n02106550_2197.jpg'], '024.Otterhound': ['./datasets/dogs_120/images_discovery_all_1/024.Otterhound/024.Otterhound_n02091635_2068.jpg'], '050.Silky Terrier': ['./datasets/dogs_120/images_discovery_all_1/050.Silky_Terrier/050.Silky_Terrier_n02097658_2329.jpg'], '033.Irish Terrier': ['./datasets/dogs_120/images_discovery_all_1/033.Irish_Terrier/033.Irish_Terrier_n02093991_1276.jpg'], '074.Malinois': ['./datasets/dogs_120/images_discovery_all_1/074.Malinois/074.Malinois_n02105162_6106.jpg'], '060.Vizsla': ['./datasets/dogs_120/images_discovery_all_1/060.Vizsla/060.Vizsla_n02100583_6521.jpg'], '118.Dhole': ['./datasets/dogs_120/images_discovery_all_1/118.Dhole/118.Dhole_n02115913_1142.jpg'], '064.Brittany': ['./datasets/dogs_120/images_discovery_all_1/064.Brittany/064.Brittany_n02101388_4229.jpg'], '096.Saint Bernard': ['./datasets/dogs_120/images_discovery_all_1/096.Saint_Bernard/096.Saint_Bernard_n02109525_18948.jpg'], '007.Toy Terrier': ['./datasets/dogs_120/images_discovery_all_1/007.Toy_Terrier/007.Toy_Terrier_n02087046_4402.jpg'], '093.Tibetan Mastiff': ['./datasets/dogs_120/images_discovery_all_1/093.Tibetan_Mastiff/093.Tibetan_Mastiff_n02108551_7523.jpg'], '027.Weimaraner': ['./datasets/dogs_120/images_discovery_all_1/027.Weimaraner/027.Weimaraner_n02092339_4003.jpg'], '031.Border Terrier': ['./datasets/dogs_120/images_discovery_all_1/031.Border_Terrier/031.Border_Terrier_n02093754_7403.jpg'], '037.Wirehaired Fox Terrier': ['./datasets/dogs_120/images_discovery_all_1/037.Wirehaired_Fox_Terrier/037.Wirehaired_Fox_Terrier_n02095314_3512.jpg'], '054.Flat coated Retriever': ['./datasets/dogs_120/images_discovery_all_1/054.Flat_coated_Retriever/054.Flat_coated_Retriever_n02099267_5540.jpg'], '097.Eskimo Dog': ['./datasets/dogs_120/images_discovery_all_1/097.Eskimo_Dog/097.Eskimo_Dog_n02109961_9973.jpg'], '079.Shetland Sheepdog': ['./datasets/dogs_120/images_discovery_all_1/079.Shetland_Sheepdog/079.Shetland_Sheepdog_n02105855_5719.jpg'], '091.Boxer': ['./datasets/dogs_120/images_discovery_all_1/091.Boxer/091.Boxer_n02108089_14719.jpg'], '026.Scottish Deerhound': ['./datasets/dogs_120/images_discovery_all_1/026.Scottish_Deerhound/026.Scottish_Deerhound_n02092002_1727.jpg'], '005.Blenheim Spaniel': ['./datasets/dogs_120/images_discovery_all_1/005.Blenheim_Spaniel/005.Blenheim_Spaniel_n02086646_3986.jpg'], '011.Beagle': ['./datasets/dogs_120/images_discovery_all_1/011.Beagle/011.Beagle_n02088364_4052.jpg'], '035.Norwich Terrier': ['./datasets/dogs_120/images_discovery_all_1/035.Norwich_Terrier/035.Norwich_Terrier_n02094258_2911.jpg'], '098.Malamute': ['./datasets/dogs_120/images_discovery_all_1/098.Malamute/098.Malamute_n02110063_12514.jpg']}
[fast and slow] 测试数据集包含 120 个类别
Processing fast and slow thinking:   0%|          | 0/120 [00:00<?, ?it/s]/home/hdl/miniconda3/envs/finer_dynamic/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:629: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `1e-06` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
Processing fast and slow thinking:   1%|          | 1/120 [00:05<11:20,  5.72s/it]Processing fast and slow thinking:   2%|▏         | 2/120 [00:11<11:02,  5.61s/it]Processing fast and slow thinking:   2%|▎         | 3/120 [00:16<10:46,  5.52s/it]Processing fast and slow thinking:   3%|▎         | 4/120 [00:21<10:21,  5.36s/it]Processing fast and slow thinking:   4%|▍         | 5/120 [00:26<09:54,  5.17s/it]Processing fast and slow thinking:   5%|▌         | 6/120 [00:31<09:30,  5.00s/it]开始分类图像: ./datasets/dogs_120/images_discovery_all_1/107.Pomeranian/107.Pomeranian_n02112018_1577.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/107.Pomeranian/107.Pomeranian_n02112018_1577.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Pomeranian', 'Keeshond', 'Japanese Spaniel', 'Pekinese', 'Shetland Sheepdog', 'Brabancon Griffon', 'Schipperke', 'Chihuaha', 'Collie', 'Papillon', 'Doberman', 'Maltese Dog', 'Yorkshire Terrier', 'Blenheim Spaniel', 'Bloodhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:40:35] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Pomeranian (置信度: 0.1265)
总耗时: 5.72秒
succ. pred cate:Pomeranian, true cate:107.Pomeranian, used_slow:True, confidence:0.1265
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/023.Norwegian_Elkhound/023.Norwegian_Elkhound_n02091467_4362.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/023.Norwegian_Elkhound/023.Norwegian_Elkhound_n02091467_4362.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Norwegian Elkhound', 'Eskimo Dog', 'Siberian Husky', 'Malamute', 'Schipperke', 'Malinois', 'Keeshond', 'Kelpie', 'Labrador Retriever', 'German Shepard', 'Doberman', 'Brittany', 'English Setter', 'Silky Terrier', 'Bull Mastiff', 'Maltese Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:40:39] [显存监控] 已分配=16.97GB, 已保留=17.33GB, 空闲=30.43GB
[2025-11-22 12:40:42] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Norwegian Elkhound (置信度: 0.1704)
总耗时: 5.53秒
succ. pred cate:Norwegian Elkhound, true cate:023.Norwegian Elkhound, used_slow:True, confidence:0.1704
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/039.Sealyham_Terrier/039.Sealyham_Terrier_n02095889_610.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/039.Sealyham_Terrier/039.Sealyham_Terrier_n02095889_610.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Sealyham Terrier', 'West Highland White Terrier', 'Miniature Schnauzer', 'Standard Schnauzer', 'Tibetan Terrier', 'Old English Sheepdog', 'Dandi Dinmont', 'Scotch Terrier', 'Lhasa', 'Shih-Tzu', 'Pekinese', 'Maltese Dog', 'Afghan Hound', 'Bedlington Terrier', 'Otterhound', 'Kerry Blue Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:40:45] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.46GB
[2025-11-22 12:40:48] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Sealyham Terrier (置信度: 0.1521)
总耗时: 5.42秒
succ. pred cate:Sealyham Terrier, true cate:039.Sealyham Terrier, used_slow:True, confidence:0.1521
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/014.Black_and_tan_Coonhound/014.Black_and_tan_Coonhound_n02089078_1275.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/014.Black_and_tan_Coonhound/014.Black_and_tan_Coonhound_n02089078_1275.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Black-and-tan Coonhound', 'Bloodhound', 'Basset Hound', 'Doberman', 'Redbone', 'Rottweiler', 'Groenendael', 'Greater Swiss Mountain Dog', 'Great Dane', 'Bluetick', 'Silky Terrier', 'Vizsla', 'Brittany', 'Bull Mastiff', 'English Setter']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:40:51] [显存监控] 已分配=16.95GB, 已保留=17.50GB, 空闲=30.45GB
[2025-11-22 12:40:54] [显存监控] 已分配=16.96GB, 已保留=17.50GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Black-and-tan Coonhound (置信度: 0.1654)
总耗时: 5.11秒
succ. pred cate:Black-and-tan Coonhound, true cate:014.Black and tan Coonhound, used_slow:True, confidence:0.1654
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/075.Briard/075.Briard_n02105251_2591.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/075.Briard/075.Briard_n02105251_2591.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Briard', 'Standard Schnauzer', 'Tibetan Terrier', 'Irish Wolfhound', 'Scottish Deerhound', 'Cairn', 'Giant Schnauzer', 'Miniature Schnauzer', 'Scotch Terrier', 'Chow', 'Otterhound', 'Lhasa', 'Keeshond', 'Pekinese', 'Groenendael', 'Saint Bernard', 'Kuvasz', 'Afghan Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:40:57] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Briard (置信度: 0.1259)
总耗时: 4.83秒
succ. pred cate:Briard, true cate:075.Briard, used_slow:True, confidence:0.1259
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/056.Golden_Retriever/056.Golden_Retriever_n02099601_3360.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/056.Golden_Retriever/056.Golden_Retriever_n02099601_3360.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Golden Retriever', 'Great Pyrenees', 'Labrador Retriever', 'Maltese Dog', 'Flat-coated Retriever', 'Saluki', 'Appenzeller', 'Japanese Spaniel', 'Tibetan Mastiff', 'Welsh Springer Spaniel', 'Silky Terrier', 'Redbone', 'Basset Hound', 'Bull Mastiff', 'Bloodhound', 'Greater Swiss Mountain Dog', 'Vizsla']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.92GB, 已保留=17.11GB
[2025-11-22 12:41:00] [显存监控] 已分配=16.98GB, 已保留=18.14GB, 空闲=30.42GB
[2025-11-22 12:41:03] [显存监控] 已分配=17.02GB, 已保留=18.14GB, 空闲=30.38GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Golden Retriever (置信度: 0.1856)
总耗时: 4.69秒
succ. pred cate:Golden Retriever, true cate:056.Golden Retriever, used_slow:True, confidence:0.1856
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/105.Great_Pyrenees/105.Great_Pyrenees_n02111500_5052.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/105.Great_Pyrenees/105.Great_Pyrenees_n02111500_5052.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Cardigan', 'Japanese Spaniel', 'Borzoi', 'Miniature Poodle', 'Standard Poodle', 'Eskimo Dog', 'English Springer Spaniel', 'Whippet', 'Clumber', 'Staffordshire Bullterrier', 'Giant Schnauzer', 'Great Pyrenees', 'Airedale', 'Bernese Mountain Dog', 'Weimaraner', 'Shetland Sheepdog', 'Boston Bull']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:41:06] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:41:09] [显存监控] 已分配=16.99GB, 已保留=17.60GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
Processing fast and slow thinking:   6%|▌         | 7/120 [00:40<11:49,  6.27s/it]Processing fast and slow thinking:   7%|▋         | 8/120 [00:45<11:10,  5.99s/it]Processing fast and slow thinking:   8%|▊         | 9/120 [00:50<10:11,  5.51s/it]Processing fast and slow thinking:   8%|▊         | 10/120 [00:54<09:33,  5.21s/it]Processing fast and slow thinking:   9%|▉         | 11/120 [00:59<09:19,  5.13s/it]Processing fast and slow thinking:  10%|█         | 12/120 [01:04<08:59,  4.99s/it]Processing fast and slow thinking:  11%|█         | 13/120 [01:10<09:43,  5.45s/it][2025-11-22 12:41:12] [显存监控] 已分配=16.96GB, 已保留=17.50GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Japanese Spaniel (置信度: 0.8500)
总耗时: 8.89秒
failed. pred cate:Japanese Spaniel, true cate:105.Great Pyrenees, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/019.Irish_Wolfhound/019.Irish_Wolfhound_n02090721_537.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/019.Irish_Wolfhound/019.Irish_Wolfhound_n02090721_537.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Irish Wolfhound', 'Standard Poodle', 'Scottish Deerhound', 'Standard Schnauzer', 'Soft-coated Wheaten Terrier', 'Otterhound', 'Cairn', 'Bedlington Terrier', 'Miniature Schnauzer', 'Dandi Dinmont', 'Shetland Sheepdog', 'Old English Sheepdog', 'Briard', 'Lhasa', 'Pekinese']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:41:15] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.44GB
[2025-11-22 12:41:18] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Irish Wolfhound (置信度: 0.1379)
总耗时: 5.38秒
succ. pred cate:Irish Wolfhound, true cate:019.Irish Wolfhound, used_slow:True, confidence:0.1379
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/003.Pekinese/003.Pekinese_n02086079_8902.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/003.Pekinese/003.Pekinese_n02086079_8902.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Pekinese', 'Shih-Tzu', 'Japanese Spaniel', 'Lhasa', 'Blenheim Spaniel', 'Dandi Dinmont', 'Papillon', 'Norfolk Terrier', 'Tibetan Terrier', 'Brabancon Griffon', 'Yorkshire Terrier', 'Silky Terrier', 'Australian Terrier', 'Maltese Dog', 'Toy Terrier', 'Brittany']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:41:21] [显存监控] 已分配=16.97GB, 已保留=17.59GB, 空闲=30.43GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Pekinese (置信度: 0.1636)
总耗时: 4.46秒
succ. pred cate:Pekinese, true cate:003.Pekinese, used_slow:True, confidence:0.1636
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/081.Border_Collie/081.Border_Collie_n02106166_3882.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/081.Border_Collie/081.Border_Collie_n02106166_3882.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Collie', 'Shetland Sheepdog', 'Japanese Spaniel', 'Papillon', 'Eskimo Dog', 'Maltese Dog', 'Tibetan Terrier', 'Bernese Mountain Dog', 'Schipperke', 'Old English Sheepdog', 'Afghan Hound', 'Keeshond', 'Golden Retriever', 'Pekinese', 'Kuvasz']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:41:24] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.45GB
[2025-11-22 12:41:27] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Collie (置信度: 0.1563)
总耗时: 4.54秒
succ. pred cate:Collie, true cate:081.Border Collie, used_slow:True, confidence:0.1563
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/102.Pug/102.Pug_n02110958_1975.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/102.Pug/102.Pug_n02110958_1975.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Pug', 'French Bulldog', 'Pekinese', 'Shih-Tzu', 'Norwegian Elkhound', 'Bull Mastiff', 'Appenzeller', 'Brabancon Griffon', 'Border Terrier', 'Groenendael', 'Toy Poodle', 'Basset Hound', 'Labrador Retriever', 'Maltese Dog', 'Silky Terrier', 'Yorkshire Terrier', 'Greater Swiss Mountain Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:41:30] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Pug (置信度: 0.1900)
总耗时: 4.95秒
succ. pred cate:Pug, true cate:102.Pug, used_slow:True, confidence:0.1900
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/116.Mexican_Hairless/116.Mexican_Hairless_n02113978_2888.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/116.Mexican_Hairless/116.Mexican_Hairless_n02113978_2888.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Mexican Hairless', 'Black-and-tan Coonhound', 'German Short-haired Pointer', 'Great Dane', 'Italian Greyhound', 'Whippet', 'Bedlington Terrier', 'Scottish Deerhound', 'Rhodesian Ridgeback', 'Labrador Retriever', 'Redbone', 'Bull Mastiff', 'Kerry Blue Terrier', 'Norwich Terrier', 'American Staffordshire Terrier', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:41:33] [显存监控] 已分配=16.95GB, 已保留=17.55GB, 空闲=30.45GB
[2025-11-22 12:41:36] [显存监控] 已分配=16.96GB, 已保留=17.55GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Mexican Hairless (置信度: 0.1646)
总耗时: 4.67秒
succ. pred cate:Mexican Hairless, true cate:116.Mexican Hairless, used_slow:True, confidence:0.1646
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/078.Old_English_Sheepdog/078.Old_English_Sheepdog_n02105641_3531.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/078.Old_English_Sheepdog/078.Old_English_Sheepdog_n02105641_3531.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Old English Sheepdog', 'Lhasa', 'Soft-coated Wheaten Terrier', 'Tibetan Terrier', 'Maltese Dog', 'Otterhound', 'Briard', 'Great Pyrenees', 'Komondor', 'Bouvier des Flandres', 'Silky Terrier', 'Pekinese', 'Dandi Dinmont', 'Kuvasz', 'Australian Terrier', 'Keeshond']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:41:39] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:41:42] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Old English Sheepdog (置信度: 0.1329)
总耗时: 6.52秒
succ. pred cate:Old English Sheepdog, true cate:078.Old English Sheepdog, used_slow:True, confidence:0.1329
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/048.Scotch_Terrier/048.Scotch_Terrier_n02097298_2443.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/048.Scotch_Terrier/048.Scotch_Terrier_n02097298_2443.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Giant Schnauzer', 'Standard Schnauzer', 'Flat-coated Retriever', 'Kerry Blue Terrier', 'Scotch Terrier', 'Curly-coater Retriever', 'Miniature Schnauzer', 'Cairn', 'Bouvier des Flandres', 'Briard', 'Great Dane', 'German Short-haired Pointer', 'Groenendael', 'Tibetan Mastiff', 'Boston Bull', 'Kuvasz', 'Otterhound', 'Old English Sheepdog', 'Cardigan']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
Processing fast and slow thinking:  12%|█▏        | 14/120 [01:20<12:04,  6.84s/it]Processing fast and slow thinking:  12%|█▎        | 15/120 [01:32<14:21,  8.20s/it]Processing fast and slow thinking:  13%|█▎        | 16/120 [01:37<12:55,  7.45s/it]Processing fast and slow thinking:  14%|█▍        | 17/120 [01:45<12:39,  7.38s/it]Processing fast and slow thinking:  15%|█▌        | 18/120 [01:50<11:33,  6.80s/it]Processing fast and slow thinking:  16%|█▌        | 19/120 [01:56<10:51,  6.45s/it][2025-11-22 12:41:45] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:41:48] [显存监控] 已分配=16.99GB, 已保留=17.60GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:41:51] [显存监控] 已分配=16.95GB, 已保留=17.46GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Scotch Terrier (置信度: 0.8500)
总耗时: 10.03秒
succ. pred cate:Scotch Terrier, true cate:048.Scotch Terrier, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/051.Soft_coated_Wheaten_Terrier/051.Soft_coated_Wheaten_Terrier_n02098105_838.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/051.Soft_coated_Wheaten_Terrier/051.Soft_coated_Wheaten_Terrier_n02098105_838.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Otterhound', 'Soft-coated Wheaten Terrier', 'Dandi Dinmont', 'Tibetan Terrier', 'Norfolk Terrier', 'Briard', 'Lakeland Terrier', 'Irish Terrier', 'Lhasa', 'Airedale', 'Silky Terrier', 'Maltese Dog', 'Australian Terrier', 'Yorkshire Terrier', 'Redbone', 'Brittany', 'Golden Retriever']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:41:54] [显存监控] 已分配=16.99GB, 已保留=17.33GB, 空闲=30.42GB
[2025-11-22 12:41:57] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:42:00] [显存监控] 已分配=16.94GB, 已保留=17.45GB, 空闲=30.46GB
[2025-11-22 12:42:03] [显存监控] 已分配=16.95GB, 已保留=17.47GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Soft-coated Wheaten Terrier (置信度: 0.8500)
总耗时: 11.36秒
succ. pred cate:Soft-coated Wheaten Terrier, true cate:051.Soft coated Wheaten Terrier, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/061.English_Setter/061.English_Setter_n02100735_3595.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/061.English_Setter/061.English_Setter_n02100735_3595.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['English Setter', 'Brittany', 'Welsh Springer Spaniel', 'Irish Setter', 'Clumber', 'German Short-haired Pointer', 'Cocker Spaniel', 'English Springer Spaniel', 'Sussex Spaniel', 'Golden Retriever', 'Silky Terrier', 'Malinois', 'Redbone', 'Bloodhound', 'Vizsla', 'Bull Mastiff', 'Australian Terrier', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:42:06] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:42:09] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: English Setter (置信度: 0.1490)
总耗时: 5.72秒
succ. pred cate:English Setter, true cate:061.English Setter, used_slow:True, confidence:0.1490
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/087.Greater_Swiss_Mountain_Dog/087.Greater_Swiss_Mountain_Dog_n02107574_2436.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/087.Greater_Swiss_Mountain_Dog/087.Greater_Swiss_Mountain_Dog_n02107574_2436.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Greater Swiss Mountain Dog', 'EntleBucher', 'Rottweiler', 'Bernese Mountain Dog', 'Appenzeller', 'Black-and-tan Coonhound', 'Bluetick', 'Beagle', 'Saint Bernard', 'English Foxhound', 'Redbone', 'Bull Mastiff', 'Maltese Dog', 'Silky Terrier', 'Basset Hound', 'Yorkshire Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:42:12] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:42:15] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:42:18] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Greater Swiss Mountain Dog (置信度: 0.1783)
总耗时: 7.19秒
succ. pred cate:Greater Swiss Mountain Dog, true cate:087.Greater Swiss Mountain Dog, used_slow:True, confidence:0.1783
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/009.Afghan_Hound/009.Afghan_Hound_n02088094_6035.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/009.Afghan_Hound/009.Afghan_Hound_n02088094_6035.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Afghan Hound', 'Briard', 'Groenendael', 'Flat-coated Retriever', 'Saluki', 'Otterhound', 'Black-and-tan Coonhound', 'Curly-coater Retriever', 'Scotch Terrier', 'Scottish Deerhound', 'Tibetan Terrier', 'EntleBucher', 'Bernese Mountain Dog', 'Kerry Blue Terrier', 'Greater Swiss Mountain Dog', 'Keeshond']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:42:21] [显存监控] 已分配=16.96GB, 已保留=17.63GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Afghan Hound (置信度: 0.2012)
总耗时: 5.46秒
succ. pred cate:Afghan Hound, true cate:009.Afghan Hound, used_slow:True, confidence:0.2012
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/006.Papillon/006.Papillon_n02086910_4388.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/006.Papillon/006.Papillon_n02086910_4388.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Papillon', 'Japanese Spaniel', 'Pekinese', 'Shetland Sheepdog', 'Blenheim Spaniel', 'Shih-Tzu', 'Tibetan Terrier', 'Collie', 'Lhasa', 'Pomeranian', 'Maltese Dog', 'Dandi Dinmont', 'Silky Terrier', 'Afghan Hound', 'Keeshond', 'Australian Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:42:24] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:42:27] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Papillon (置信度: 0.1566)
总耗时: 5.62秒
succ. pred cate:Papillon, true cate:006.Papillon, used_slow:True, confidence:0.1566
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/013.Bluetick/013.Bluetick_n02088632_4058.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/013.Bluetick/013.Bluetick_n02088632_4058.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Bluetick', 'Black-and-tan Coonhound', 'Beagle', 'English Foxhound', 'Basset Hound', 'Walker Hound', 'German Short-haired Pointer', 'Bloodhound', 'Appenzeller', 'English Setter', 'Greater Swiss Mountain Dog', 'Redbone', 'Great Dane', 'Kelpie', 'Scotch Terrier', 'Otterhound', 'Soft-coated Wheaten Terrier', 'Bull Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:42:30] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
[2025-11-22 12:42:33] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
Processing fast and slow thinking:  17%|█▋        | 20/120 [02:01<09:58,  5.99s/it]Processing fast and slow thinking:  18%|█▊        | 21/120 [02:11<11:52,  7.20s/it]Processing fast and slow thinking:  18%|█▊        | 22/120 [02:16<10:42,  6.56s/it]Processing fast and slow thinking:  19%|█▉        | 23/120 [02:25<12:04,  7.47s/it]Processing fast and slow thinking:  20%|██        | 24/120 [02:35<12:59,  8.12s/it]Processing fast and slow thinking:  21%|██        | 25/120 [02:40<11:38,  7.36s/it]推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bluetick (置信度: 0.1579)
总耗时: 4.92秒
succ. pred cate:Bluetick, true cate:013.Bluetick, used_slow:True, confidence:0.1579
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/063.Gordon_Setter/063.Gordon_Setter_n02101006_2540.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/063.Gordon_Setter/063.Gordon_Setter_n02101006_2540.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Cocker Spaniel', 'Curly-coater Retriever', 'Irish Water Spaniel', 'Flat-coated Retriever', 'Gordon Setter', 'Clumber', 'Sussex Spaniel', 'Irish Setter', 'Groenendael', 'English Springer Spaniel', 'Tibetan Terrier', 'Kuvasz', 'Bernese Mountain Dog', 'Great Dane', 'Redbone', 'Silky Terrier', 'Greater Swiss Mountain Dog', 'Walker Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:42:36] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
[2025-11-22 12:42:39] [显存监控] 已分配=16.99GB, 已保留=17.59GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:42:42] [显存监控] 已分配=16.95GB, 已保留=17.48GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Gordon Setter (置信度: 0.9500)
总耗时: 10.03秒
succ. pred cate:Gordon Setter, true cate:063.Gordon Setter, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/066.English_Springer_Spaniel/066.English_Springer_Spaniel_n02102040_5096.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/066.English_Springer_Spaniel/066.English_Springer_Spaniel_n02102040_5096.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['English Springer Spaniel', 'Clumber', 'Cocker Spaniel', 'Welsh Springer Spaniel', 'Brittany', 'English Setter', 'Blenheim Spaniel', 'Irish Water Spaniel', 'Sussex Spaniel', 'Gordon Setter', 'Tibetan Terrier', 'Kuvasz', 'Great Dane', 'Golden Retriever', 'Otterhound', 'Bernese Mountain Dog', 'Soft-coated Wheaten Terrier', 'Irish Setter']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:42:45] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
[2025-11-22 12:42:48] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: English Springer Spaniel (置信度: 0.1475)
总耗时: 5.05秒
succ. pred cate:English Springer Spaniel, true cate:066.English Springer Spaniel, used_slow:True, confidence:0.1475
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/012.Bloodhound/012.Bloodhound_n02088466_4731.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/012.Bloodhound/012.Bloodhound_n02088466_4731.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Rhodesian Ridgeback', 'Vizsla', 'Bull Mastiff', 'Redbone', 'Bloodhound', 'Malinois', 'Irish Setter', 'Clumber', 'Weimaraner', 'Irish Terrier', 'Otterhound', 'Great Dane', 'Miniature Poodle', 'Golden Retriever', 'Kerry Blue Terrier', 'Chesapeake Bay Retriever', 'Saint Bernard', 'Staffordshire Bullterrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:42:51] [显存监控] 已分配=16.97GB, 已保留=17.61GB, 空闲=30.43GB
[2025-11-22 12:42:54] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:42:57] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bloodhound (置信度: 0.8500)
总耗时: 9.60秒
succ. pred cate:Bloodhound, true cate:012.Bloodhound, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/069.Sussex_Spaniel/069.Sussex_Spaniel_n02102480_5703.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/069.Sussex_Spaniel/069.Sussex_Spaniel_n02102480_5703.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Airedale', 'Otterhound', 'Irish Terrier', 'Soft-coated Wheaten Terrier', 'Lakeland Terrier', 'Cocker Spaniel', 'Toy Poodle', 'Briard', 'Clumber', 'Miniature Poodle', 'Kerry Blue Terrier', 'Sealyham Terrier', 'Kuvasz', 'Silky Terrier', 'Redbone', 'Bedlington Terrier', 'Maltese Dog', 'Golden Retriever']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:00] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:43:03] [显存监控] 已分配=16.99GB, 已保留=17.60GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:06] [显存监控] 已分配=16.95GB, 已保留=17.47GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Cocker Spaniel (置信度: 0.9500)
总耗时: 9.65秒
succ. pred cate:Cocker Spaniel, true cate:069.Sussex Spaniel, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/059.German_Short_haired_Pointer/059.German_Short_haired_Pointer_n02100236_4198.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/059.German_Short_haired_Pointer/059.German_Short_haired_Pointer_n02100236_4198.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['German Short-haired Pointer', 'English Setter', 'Labrador Retriever', 'English Springer Spaniel', 'Great Dane', 'Brittany', 'Bluetick', 'Groenendael', 'Welsh Springer Spaniel', 'Appenzeller', 'Redbone', 'Otterhound', 'Greater Swiss Mountain Dog', 'Bull Mastiff', 'Tibetan Terrier', 'Rottweiler', 'Black-and-tan Coonhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:43:09] [显存监控] 已分配=17.00GB, 已保留=17.99GB, 空闲=30.40GB
[2025-11-22 12:43:12] [显存监控] 已分配=17.00GB, 已保留=17.99GB, 空闲=30.40GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: German Short-haired Pointer (置信度: 0.2387)
总耗时: 5.57秒
succ. pred cate:German Short-haired Pointer, true cate:059.German Short haired Pointer, used_slow:True, confidence:0.2387
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/100.Affenpinscher/100.Affenpinscher_n02110627_10439.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/100.Affenpinscher/100.Affenpinscher_n02110627_10439.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Tibetan Terrier', 'Affenpinscher', 'Japanese Spaniel', 'Pekinese', 'Shih-Tzu', 'Lhasa', 'Briard', 'Brabancon Griffon', 'Cairn', 'Yorkshire Terrier', 'Silky Terrier', 'Maltese Dog', 'Australian Terrier', 'Dandi Dinmont', 'Brittany', 'English Setter', 'Malinois']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:15] [显存监控] 已分配=16.96GB, 已保留=17.56GB, 空闲=30.45GB
Processing fast and slow thinking:  22%|██▏       | 26/120 [02:52<13:25,  8.56s/it]Processing fast and slow thinking:  22%|██▎       | 27/120 [02:57<11:43,  7.56s/it]Processing fast and slow thinking:  23%|██▎       | 28/120 [03:09<13:32,  8.83s/it]Processing fast and slow thinking:  24%|██▍       | 29/120 [03:19<14:00,  9.23s/it]Processing fast and slow thinking:  25%|██▌       | 30/120 [03:29<14:09,  9.44s/it]Processing fast and slow thinking:  26%|██▌       | 31/120 [03:34<12:06,  8.16s/it][2025-11-22 12:43:18] [显存监控] 已分配=16.96GB, 已保留=17.56GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:21] [显存监控] 已分配=16.94GB, 已保留=17.43GB, 空闲=30.46GB
[2025-11-22 12:43:24] [显存监控] 已分配=16.95GB, 已保留=17.45GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Affenpinscher (置信度: 0.8500)
总耗时: 11.38秒
succ. pred cate:Affenpinscher, true cate:100.Affenpinscher, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/103.Leonberg/103.Leonberg_n02111129_1197.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/103.Leonberg/103.Leonberg_n02111129_1197.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Leonberg', 'Clumber', 'Brabancon Griffon', 'Bull Mastiff', 'Saint Bernard', 'Tibetan Mastiff', 'Norwegian Elkhound', 'Pekinese', 'Border Terrier', 'Keeshond', 'Golden Retriever', 'Malinois', 'Greater Swiss Mountain Dog', 'Groenendael', 'Boston Bull', 'Bernese Mountain Dog', 'Beagle', 'Kelpie', 'Irish Setter']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:27] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:43:30] [显存监控] 已分配=16.99GB, 已保留=17.59GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Leonberg (置信度: 0.2954)
总耗时: 5.22秒
succ. pred cate:Leonberg, true cate:103.Leonberg, used_slow:True, confidence:0.2954
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/025.Saluki/025.Saluki_n02091831_11021.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/025.Saluki/025.Saluki_n02091831_11021.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Irish Wolfhound', 'Bedlington Terrier', 'Saluki', 'Rhodesian Ridgeback', 'Chow', 'Weimaraner', 'Great Dane', 'Borzoi', 'Whippet', 'English Setter', 'Siberian Husky', 'Kerry Blue Terrier', 'Otterhound', 'Norfolk Terrier', 'Vizsla', 'Lhasa', 'Italian Greyhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:33] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:43:36] [显存监控] 已分配=16.99GB, 已保留=17.60GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:39] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
[2025-11-22 12:43:42] [显存监控] 已分配=16.96GB, 已保留=17.49GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Saluki (置信度: 0.9500)
总耗时: 11.80秒
succ. pred cate:Saluki, true cate:025.Saluki, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/043.Dandi_Dinmont/043.Dandi_Dinmont_n02096437_730.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/043.Dandi_Dinmont/043.Dandi_Dinmont_n02096437_730.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Clumber', 'Cocker Spaniel', 'Dandi Dinmont', 'Otterhound', 'English Setter', 'Cairn', 'Sussex Spaniel', 'Brittany', 'Miniature Poodle', 'Welsh Springer Spaniel', 'Kuvasz', 'Soft-coated Wheaten Terrier', 'Newfoundland', 'Pekinese', 'Golden Retriever', 'Mexican Hairless']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:45] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:48] [显存监控] 已分配=16.94GB, 已保留=17.48GB, 空闲=30.46GB
[2025-11-22 12:43:51] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Dandi Dinmont (置信度: 0.8000)
总耗时: 10.16秒
succ. pred cate:Dandi Dinmont, true cate:043.Dandi Dinmont, used_slow:True, confidence:0.8000
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/000.Chihuaha/000.Chihuaha_n02085620_3488.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/000.Chihuaha/000.Chihuaha_n02085620_3488.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Toy Terrier', 'Mexican Hairless', 'Miniature Pinscher', 'Italian Greyhound', 'Chihuaha', 'Basenji', 'Weimaraner', 'Border Terrier', 'Pomeranian', 'Kelpie', 'Yorkshire Terrier', 'Doberman', 'Japanese Spaniel', 'Australian Terrier', 'Maltese Dog', 'Silky Terrier', 'Bluetick', 'Lakeland Terrier', 'Vizsla']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:43:54] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:43:57] [显存监控] 已分配=16.99GB, 已保留=17.62GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
模糊匹配类别修正: 'Chihuahua' -> 'Chihuaha'
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:00] [显存监控] 已分配=16.95GB, 已保留=17.48GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Chihuahua (置信度: 0.9500)
总耗时: 9.94秒
succ. pred cate:Chihuahua, true cate:000.Chihuaha, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/113.Toy_Poodle/113.Toy_Poodle_n02113624_665.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/113.Toy_Poodle/113.Toy_Poodle_n02113624_665.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Toy Poodle', 'Miniature Poodle', 'Lakeland Terrier', 'Airedale', 'Soft-coated Wheaten Terrier', 'Irish Water Spaniel', 'Dandi Dinmont', 'Cocker Spaniel', 'Irish Terrier', 'Bedlington Terrier', 'Maltese Dog', 'Yorkshire Terrier', 'Silky Terrier', 'Japanese Spaniel', 'Australian Terrier', 'Basset Hound', 'Labrador Retriever', 'Miniature Schnauzer']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:03] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:44:06] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Toy Poodle (置信度: 0.2140)
总耗时: 5.18秒
succ. pred cate:Toy Poodle, true cate:113.Toy Poodle, used_slow:True, confidence:0.2140
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/058.Chesapeake_Bay_Retriever/058.Chesapeake_Bay_Retriever_n02099849_513.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Chesapeake Bay Retriever (置信度: 0.6937)
总耗时: 0.02秒
succ. pred cate:Chesapeake Bay Retriever, true cate:058.Chesapeake Bay Retriever, used_slow:False, confidence:0.6937
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/052.West_Highland_White_Terrier/052.West_Highland_White_Terrier_n02098286_1632.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  28%|██▊       | 33/120 [03:43<09:26,  6.52s/it]Processing fast and slow thinking:  28%|██▊       | 34/120 [03:49<09:11,  6.41s/it]Processing fast and slow thinking:  29%|██▉       | 35/120 [03:54<08:24,  5.93s/it]Processing fast and slow thinking:  30%|███       | 36/120 [04:06<10:30,  7.51s/it]Processing fast and slow thinking:  31%|███       | 37/120 [04:11<09:41,  7.01s/it]Processing fast and slow thinking:  32%|███▏      | 38/120 [04:21<10:41,  7.82s/it]开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/052.West_Highland_White_Terrier/052.West_Highland_White_Terrier_n02098286_1632.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Chow', 'Eskimo Dog', 'Malamute', 'Samoyed', 'Shetland Sheepdog', 'West Highland White Terrier', 'Kuvasz', 'Siberian Husky', 'Keeshond', 'Sealyham Terrier', 'Bouvier des Flandres', 'Miniature Schnauzer', 'Lhasa', 'Airedale', 'Standard Schnauzer', 'Maltese Dog', 'Japanese Spaniel', 'Yorkshire Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:09] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:44:12] [显存监控] 已分配=16.99GB, 已保留=17.59GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:15] [显存监控] 已分配=16.95GB, 已保留=17.46GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: West Highland White Terrier (置信度: 0.8000)
总耗时: 9.17秒
succ. pred cate:West Highland White Terrier, true cate:052.West Highland White Terrier, used_slow:True, confidence:0.8000
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/082.Bouvier_des_Flandres/082.Bouvier_des_Flandres_n02106382_1151.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/082.Bouvier_des_Flandres/082.Bouvier_des_Flandres_n02106382_1151.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Bouvier des Flandres', 'Kerry Blue Terrier', 'Giant Schnauzer', 'Tibetan Terrier', 'Miniature Poodle', 'Irish Water Spaniel', 'Newfoundland', 'Soft-coated Wheaten Terrier', 'Briard', 'Affenpinscher', 'Maltese Dog', 'Yorkshire Terrier', 'Silky Terrier', 'Toy Poodle', 'Otterhound', 'German Short-haired Pointer', 'Keeshond']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:18] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:44:21] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bouvier des Flandres (置信度: 0.1344)
总耗时: 6.10秒
succ. pred cate:Bouvier des Flandres, true cate:082.Bouvier des Flandres, used_slow:True, confidence:0.1344
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/021.Whippet/021.Whippet_n02091134_15784.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/021.Whippet/021.Whippet_n02091134_15784.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Whippet', 'Great Dane', 'Saluki', 'Scottish Deerhound', 'African Hunting Dog', 'Borzoi', 'Malinois', 'Italian Greyhound', 'Walker Hound', 'Dingo', 'Bull Mastiff', 'Redbone', 'Kelpie', 'American Staffordshire Terrier', 'Cardigan', 'Boston Bull', 'Irish Setter']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:24] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:44:27] [显存监控] 已分配=16.98GB, 已保留=17.60GB, 空闲=30.42GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Whippet (置信度: 0.1189)
总耗时: 4.58秒
succ. pred cate:Whippet, true cate:021.Whippet, used_slow:True, confidence:0.1189
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/046.Giant_Schnauzer/046.Giant_Schnauzer_n02097130_5907.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/046.Giant_Schnauzer/046.Giant_Schnauzer_n02097130_5907.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Kerry Blue Terrier', 'Standard Poodle', 'Clumber', 'Giant Schnauzer', 'Standard Schnauzer', 'Miniature Schnauzer', 'Tibetan Terrier', 'Bouvier des Flandres', 'Scotch Terrier', 'Scottish Deerhound', 'Old English Sheepdog', 'Irish Wolfhound', 'Pekinese', 'Otterhound', 'Kuvasz', 'Irish Setter', 'Great Dane', 'Shetland Sheepdog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:30] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:44:33] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:36] [显存监控] 已分配=16.95GB, 已保留=17.48GB, 空闲=30.46GB
[2025-11-22 12:44:39] [显存监控] 已分配=16.95GB, 已保留=17.50GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Standard Schnauzer (置信度: 0.8500)
总耗时: 11.71秒
succ. pred cate:Standard Schnauzer, true cate:046.Giant Schnauzer, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/088.Bernese_Mountain_Dog/088.Bernese_Mountain_Dog_n02107683_6301.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/088.Bernese_Mountain_Dog/088.Bernese_Mountain_Dog_n02107683_6301.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Bernese Mountain Dog', 'Clumber', 'Gordon Setter', 'English Springer Spaniel', 'Greater Swiss Mountain Dog', 'EntleBucher', 'Flat-coated Retriever', 'Irish Setter', 'Tibetan Mastiff', 'Curly-coater Retriever', 'Airedale', 'Brittany', 'Silky Terrier', 'English Setter', 'Doberman', 'Vizsla', 'Yorkshire Terrier', 'Maltese Dog', 'Cocker Spaniel']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:42] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bernese Mountain Dog (置信度: 0.1340)
总耗时: 5.73秒
succ. pred cate:Bernese Mountain Dog, true cate:088.Bernese Mountain Dog, used_slow:True, confidence:0.1340
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/080.Collie/080.Collie_n02106030_10057.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/080.Collie/080.Collie_n02106030_10057.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Shetland Sheepdog', 'Cardigan', 'Malamute', 'Keeshond', 'Appenzeller', 'Eskimo Dog', 'Chow', 'Groenendael', 'Silky Terrier', 'Collie', 'Afghan Hound', 'Old English Sheepdog', 'Saint Bernard', 'Otterhound', 'Papillon', 'Bernese Mountain Dog', 'Pekinese', 'Kerry Blue Terrier', 'EntleBucher']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:45] [显存监控] 已分配=16.93GB, 已保留=17.25GB, 空闲=30.47GB
[2025-11-22 12:44:48] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:51] [显存监控] 已分配=16.94GB, 已保留=17.46GB, 空闲=30.46GB
[2025-11-22 12:44:54] [显存监控] 已分配=16.95GB, 已保留=17.47GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Collie (置信度: 0.9000)
总耗时: 9.87秒
succ. pred cate:Collie, true cate:080.Collie, used_slow:True, confidence:0.9000
Processing fast and slow thinking:  32%|███▎      | 39/120 [04:31<11:29,  8.51s/it]Processing fast and slow thinking:  33%|███▎      | 40/120 [04:36<09:47,  7.35s/it]Processing fast and slow thinking:  34%|███▍      | 41/120 [04:47<11:00,  8.36s/it]Processing fast and slow thinking:  35%|███▌      | 42/120 [04:51<09:14,  7.11s/it]Processing fast and slow thinking:  36%|███▌      | 43/120 [04:56<08:24,  6.55s/it]Processing fast and slow thinking:  37%|███▋      | 44/120 [05:01<07:38,  6.04s/it]开始分类图像: ./datasets/dogs_120/images_discovery_all_1/015.Walker_Hound/015.Walker_Hound_n02089867_24.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/015.Walker_Hound/015.Walker_Hound_n02089867_24.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['German Short-haired Pointer', 'Bluetick', 'English Foxhound', 'Great Dane', 'English Setter', 'Black-and-tan Coonhound', 'Walker Hound', 'Brittany', 'Welsh Springer Spaniel', 'Appenzeller', 'Redbone', 'Whippet', 'Bull Mastiff', 'Basset Hound', 'Toy Terrier', 'Otterhound', 'Greater Swiss Mountain Dog', 'American Staffordshire Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:44:57] [显存监控] 已分配=16.96GB, 已保留=17.53GB, 空闲=30.44GB
[2025-11-22 12:45:00] [显存监控] 已分配=16.96GB, 已保留=17.53GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:45:03] [显存监控] 已分配=16.94GB, 已保留=17.42GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bluetick (置信度: 0.8500)
总耗时: 10.19秒
failed. pred cate:Bluetick, true cate:015.Walker Hound, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/057.Labrador_Retriever/057.Labrador_Retriever_n02099712_3613.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/057.Labrador_Retriever/057.Labrador_Retriever_n02099712_3613.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Labrador Retriever', 'Black-and-tan Coonhound', 'German Short-haired Pointer', 'Flat-coated Retriever', 'Great Dane', 'Mexican Hairless', 'Gordon Setter', 'Weimaraner', 'Kelpie', 'Doberman', 'Redbone', 'Basset Hound', 'Bull Mastiff', 'Beagle', 'Vizsla', 'Golden Retriever']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:45:06] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.45GB
[2025-11-22 12:45:09] [显存监控] 已分配=16.98GB, 已保留=17.57GB, 空闲=30.43GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Labrador Retriever (置信度: 0.1399)
总耗时: 4.54秒
succ. pred cate:Labrador Retriever, true cate:057.Labrador Retriever, used_slow:True, confidence:0.1399
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/040.Airedale/040.Airedale_n02096051_8826.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/040.Airedale/040.Airedale_n02096051_8826.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Otterhound', 'Airedale', 'Soft-coated Wheaten Terrier', 'Irish Terrier', 'Clumber', 'Lakeland Terrier', 'Irish Wolfhound', 'Norfolk Terrier', 'Standard Poodle', 'Briard', 'Silky Terrier', 'Brittany', 'Walker Hound', 'Irish Setter', 'Kuvasz', 'Malinois', 'African Hunting Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:45:12] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:45:15] [显存监控] 已分配=16.96GB, 已保留=17.29GB, 空闲=30.44GB
[2025-11-22 12:45:18] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Airedale (置信度: 0.8500)
总耗时: 10.79秒
succ. pred cate:Airedale, true cate:040.Airedale, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/104.Newfoundland/104.Newfoundland_n02111277_8856.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/104.Newfoundland/104.Newfoundland_n02111277_8856.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Newfoundland', 'Bouvier des Flandres', 'Flat-coated Retriever', 'Giant Schnauzer', 'Briard', 'Curly-coater Retriever', 'Kerry Blue Terrier', 'Tibetan Terrier', 'Tibetan Mastiff', 'Scotch Terrier', 'Bernese Mountain Dog', 'Afghan Hound', 'Old English Sheepdog', 'Groenendael', 'Keeshond', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:45:21] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:45:24] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Newfoundland (置信度: 0.1476)
总耗时: 4.13秒
succ. pred cate:Newfoundland, true cate:104.Newfoundland, used_slow:True, confidence:0.1476
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/032.Kerry_Blue_Terrier/032.Kerry_Blue_Terrier_n02093859_393.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/032.Kerry_Blue_Terrier/032.Kerry_Blue_Terrier_n02093859_393.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Kerry Blue Terrier', 'Giant Schnauzer', 'Standard Schnauzer', 'Bouvier des Flandres', 'Miniature Schnauzer', 'Scotch Terrier', 'Soft-coated Wheaten Terrier', 'Airedale', 'Dandi Dinmont', 'Affenpinscher', 'Tibetan Terrier', 'Maltese Dog', 'Afghan Hound', 'Bedlington Terrier', 'Old English Sheepdog', 'Kuvasz', 'Keeshond', 'Australian Terrier', 'Sealyham Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:45:27] [显存监控] 已分配=16.96GB, 已保留=17.64GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Kerry Blue Terrier (置信度: 0.1535)
总耗时: 5.23秒
succ. pred cate:Kerry Blue Terrier, true cate:032.Kerry Blue Terrier, used_slow:True, confidence:0.1535
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/047.Standard_Schnauzer/047.Standard_Schnauzer_n02097209_2194.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/047.Standard_Schnauzer/047.Standard_Schnauzer_n02097209_2194.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Standard Schnauzer', 'Miniature Schnauzer', 'Scotch Terrier', 'Irish Wolfhound', 'Kerry Blue Terrier', 'Dandi Dinmont', 'Scottish Deerhound', 'Tibetan Terrier', 'Giant Schnauzer', 'Cairn', 'Otterhound', 'Norwich Terrier', 'Komondor', 'Maltese Dog', 'Afghan Hound', 'Lhasa', 'Keeshond']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:45:30] [显存监控] 已分配=16.96GB, 已保留=17.73GB, 空闲=30.44GB
[2025-11-22 12:45:33] [显存监控] 已分配=16.99GB, 已保留=17.75GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Miniature Schnauzer (置信度: 0.1402)
总耗时: 4.84秒
succ. pred cate:Miniature Schnauzer, true cate:047.Standard Schnauzer, used_slow:True, confidence:0.1402
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/117.Dingo/117.Dingo_n02115641_925.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/117.Dingo/117.Dingo_n02115641_925.jpg
步骤1: 提取快思考候选类别...
Processing fast and slow thinking:  38%|███▊      | 45/120 [05:07<07:21,  5.89s/it]Processing fast and slow thinking:  38%|███▊      | 46/120 [05:11<06:53,  5.59s/it]Processing fast and slow thinking:  39%|███▉      | 47/120 [05:16<06:27,  5.31s/it]Processing fast and slow thinking:  40%|████      | 48/120 [05:26<08:12,  6.84s/it]Processing fast and slow thinking:  41%|████      | 49/120 [05:34<08:12,  6.94s/it]Processing fast and slow thinking:  42%|████▏     | 50/120 [05:43<08:54,  7.63s/it]快思考Top-10候选类别: ['Dingo', 'Dhole', 'African Hunting Dog', 'Cardigan', 'Pembroke', 'Basenji', 'Malinois', 'Collie', 'Schipperke', 'Chow', 'Saint Bernard', 'Kelpie', 'Bernese Mountain Dog', 'Keeshond', 'Otterhound', 'Kuvasz', 'Norwich Terrier', 'Toy Terrier', 'Pomeranian']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:45:36] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:45:39] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Dingo (置信度: 0.1246)
总耗时: 5.55秒
succ. pred cate:Dingo, true cate:117.Dingo, used_slow:True, confidence:0.1246
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/055.Curly_coater_Retriever/055.Curly_coater_Retriever_n02099429_618.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/055.Curly_coater_Retriever/055.Curly_coater_Retriever_n02099429_618.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Curly-coater Retriever', 'Flat-coated Retriever', 'Irish Water Spaniel', 'Newfoundland', 'Kerry Blue Terrier', 'Giant Schnauzer', 'Clumber', 'Cocker Spaniel', 'Scotch Terrier', 'Groenendael', 'Sealyham Terrier', 'Afghan Hound', 'Tibetan Terrier', 'Bedlington Terrier', 'Otterhound', 'Great Dane', 'Kuvasz']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:45:42] [显存监控] 已分配=16.95GB, 已保留=17.55GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
模糊匹配类别修正: 'Curly-coated Retriever' -> 'Curly-coater Retriever'
分类完成: Curly-coater Retriever (置信度: 0.1364)
总耗时: 4.87秒
succ. pred cate:Curly-coater Retriever, true cate:055.Curly coater Retriever, used_slow:True, confidence:0.1364
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/089.Appenzeller/089.Appenzeller_n02107908_7236.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/089.Appenzeller/089.Appenzeller_n02107908_7236.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['EntleBucher', 'Miniature Pinscher', 'Greater Swiss Mountain Dog', 'Basenji', 'Beagle', 'Kelpie', 'Appenzeller', 'Cardigan', 'Toy Terrier', 'Rottweiler', 'Norwich Terrier', 'Bull Mastiff', 'Great Dane', 'Bernese Mountain Dog', 'Maltese Dog', 'Saint Bernard', 'Redbone', 'Dandi Dinmont']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:45:45] [显存监控] 已分配=16.94GB, 已保留=17.26GB, 空闲=30.47GB
[2025-11-22 12:45:48] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: EntleBucher (置信度: 0.1339)
总耗时: 4.67秒
succ. pred cate:EntleBucher, true cate:089.Appenzeller, used_slow:True, confidence:0.1339
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/101.Basenji/101.Basenji_n02110806_4876.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/101.Basenji/101.Basenji_n02110806_4876.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Walker Hound', 'Beagle', 'Basenji', 'Miniature Pinscher', 'Clumber', 'Bluetick', 'Cardigan', 'Toy Terrier', 'EntleBucher', 'Border Terrier', 'Standard Poodle', 'Mexican Hairless', 'Brabancon Griffon', 'English Foxhound', 'Basset Hound', 'Greater Swiss Mountain Dog', 'Shetland Sheepdog', 'Pekinese']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:45:51] [显存监控] 已分配=16.98GB, 已保留=17.66GB, 空闲=30.43GB
[2025-11-22 12:45:54] [显存监控] 已分配=16.99GB, 已保留=17.66GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:45:57] [显存监控] 已分配=16.95GB, 已保留=17.56GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Basenji (置信度: 0.8500)
总耗时: 10.41秒
succ. pred cate:Basenji, true cate:101.Basenji, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/077.Komondor/077.Komondor_n02105505_3933.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/077.Komondor/077.Komondor_n02105505_3933.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Komondor', 'Afghan Hound', 'Briard', 'Tibetan Terrier', 'Lhasa', 'Otterhound', 'Maltese Dog', 'Old English Sheepdog', 'Dandi Dinmont', 'Soft-coated Wheaten Terrier', 'Sealyham Terrier', 'Saluki', 'Kerry Blue Terrier', 'Silky Terrier', 'Papillon', 'Bedlington Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:46:00] [显存监控] 已分配=16.92GB, 已保留=17.12GB, 空闲=30.48GB
[2025-11-22 12:46:03] [显存监控] 已分配=16.96GB, 已保留=17.56GB, 空闲=30.44GB
[2025-11-22 12:46:06] [显存监控] 已分配=16.99GB, 已保留=17.56GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Komondor (置信度: 0.1980)
总耗时: 7.18秒
succ. pred cate:Komondor, true cate:077.Komondor, used_slow:True, confidence:0.1980
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/115.Standard_Poodle/115.Standard_Poodle_n02113799_1537.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/115.Standard_Poodle/115.Standard_Poodle_n02113799_1537.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Kerry Blue Terrier', 'Miniature Poodle', 'Curly-coater Retriever', 'Bedlington Terrier', 'Irish Water Spaniel', 'Toy Poodle', 'Bouvier des Flandres', 'Giant Schnauzer', 'Standard Poodle', 'Flat-coated Retriever', 'Silky Terrier', 'Maltese Dog', 'Dandi Dinmont', 'Great Dane', 'Kuvasz', 'Tibetan Terrier', 'Australian Terrier', 'Groenendael']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:46:09] [显存监控] 已分配=16.98GB, 已保留=17.66GB, 空闲=30.42GB
[2025-11-22 12:46:12] [显存监控] 已分配=16.99GB, 已保留=17.66GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:46:15] [显存监控] 已分配=16.95GB, 已保留=17.56GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Standard Poodle (置信度: 0.8500)
总耗时: 9.25秒
succ. pred cate:Standard Poodle, true cate:115.Standard Poodle, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/045.Miniature_Schnauzer/045.Miniature_Schnauzer_n02097047_724.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/045.Miniature_Schnauzer/045.Miniature_Schnauzer_n02097047_724.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Miniature Schnauzer', 'Standard Schnauzer', 'Affenpinscher', 'Giant Schnauzer', 'Scotch Terrier', 'Australian Terrier', 'Cairn', 'Kerry Blue Terrier', 'Schipperke', 'Briard', 'Maltese Dog', 'Yorkshire Terrier', 'Silky Terrier', 'Great Dane', 'Tibetan Mastiff', 'Tibetan Terrier', 'Toy Terrier', 'Bull Mastiff', 'Groenendael']
Processing fast and slow thinking:  42%|████▎     | 51/120 [05:48<07:55,  6.89s/it]Processing fast and slow thinking:  43%|████▎     | 52/120 [05:59<09:10,  8.10s/it]Processing fast and slow thinking:  44%|████▍     | 53/120 [06:04<08:01,  7.19s/it]Processing fast and slow thinking:  45%|████▌     | 54/120 [06:09<07:11,  6.54s/it]Processing fast and slow thinking:  46%|████▌     | 55/120 [06:19<08:03,  7.44s/it]Processing fast and slow thinking:  47%|████▋     | 56/120 [06:24<07:08,  6.70s/it]Processing fast and slow thinking:  48%|████▊     | 57/120 [06:30<06:47,  6.47s/it]步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:46:18] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:46:21] [显存监控] 已分配=16.99GB, 已保留=17.62GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Standard Schnauzer (置信度: 0.1206)
总耗时: 5.15秒
succ. pred cate:Standard Schnauzer, true cate:045.Miniature Schnauzer, used_slow:True, confidence:0.1206
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/095.Great_Dane/095.Great_Dane_n02109047_34175.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/095.Great_Dane/095.Great_Dane_n02109047_34175.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Great Dane', 'Black-and-tan Coonhound', 'Groenendael', 'German Short-haired Pointer', 'Standard Schnauzer', 'Weimaraner', 'Bloodhound', 'Bluetick', 'Giant Schnauzer', 'Rhodesian Ridgeback', 'Kerry Blue Terrier', 'EntleBucher', 'Redbone', 'Flat-coated Retriever', 'Rottweiler', 'Greater Swiss Mountain Dog', 'Afghan Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.92GB, 已保留=17.11GB
[2025-11-22 12:46:24] [显存监控] 已分配=17.00GB, 已保留=18.22GB, 空闲=30.40GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.92GB, 已保留=17.11GB
[2025-11-22 12:46:27] [显存监控] 已分配=16.99GB, 已保留=18.22GB, 空闲=30.42GB
[2025-11-22 12:46:30] [显存监控] 已分配=17.00GB, 已保留=18.22GB, 空闲=30.40GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Weimaraner (置信度: 0.9500)
总耗时: 10.92秒
succ. pred cate:Weimaraner, true cate:095.Great Dane, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/092.Bull_Mastiff/092.Bull_Mastiff_n02108422_5221.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/092.Bull_Mastiff/092.Bull_Mastiff_n02108422_5221.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Bull Mastiff', 'Bloodhound', 'Pug', 'Boxer', 'French Bulldog', 'Staffordshire Bullterrier', 'Great Dane', 'American Staffordshire Terrier', 'Saint Bernard', 'Rhodesian Ridgeback', 'Vizsla', 'Golden Retriever', 'Redbone', 'Brabancon Griffon', 'Silky Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:46:33] [显存监控] 已分配=16.97GB, 已保留=17.56GB, 空闲=30.44GB
[2025-11-22 12:46:36] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bull Mastiff (置信度: 0.2046)
总耗时: 5.08秒
succ. pred cate:Bull Mastiff, true cate:092.Bull Mastiff, used_slow:True, confidence:0.2046
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/018.Borzoi/018.Borzoi_n02090622_6976.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/018.Borzoi/018.Borzoi_n02090622_6976.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Borzoi', 'Saluki', 'Irish Wolfhound', 'Groenendael', 'Scottish Deerhound', 'Whippet', 'Afghan Hound', 'Great Pyrenees', 'English Setter', 'Ibizian Hound', 'Kuvasz', 'Pekinese', 'Otterhound', 'Tibetan Mastiff', 'Siberian Husky', 'Norwegian Elkhound', 'Keeshond', 'Dandi Dinmont', 'Irish Setter']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:46:39] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:46:42] [显存监控] 已分配=16.99GB, 已保留=17.62GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Borzoi (置信度: 0.2078)
总耗时: 5.03秒
succ. pred cate:Borzoi, true cate:018.Borzoi, used_slow:True, confidence:0.2078
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/022.Ibizian_Hound/022.Ibizian_Hound_n02091244_5818.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/022.Ibizian_Hound/022.Ibizian_Hound_n02091244_5818.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Welsh Springer Spaniel', 'Brittany', 'Redbone', 'English Foxhound', 'Bull Mastiff', 'Walker Hound', 'Rhodesian Ridgeback', 'Malinois', 'German Short-haired Pointer', 'English Springer Spaniel', 'Blenheim Spaniel', 'Doberman', 'Bluetick', 'English Setter', 'Airedale', 'Vizsla', 'Silky Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:46:45] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:46:48] [显存监控] 已分配=16.94GB, 已保留=17.48GB, 空闲=30.46GB
[2025-11-22 12:46:51] [显存监控] 已分配=16.96GB, 已保留=17.50GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Welsh Springer Spaniel (置信度: 0.8500)
总耗时: 9.52秒
failed. pred cate:Welsh Springer Spaniel, true cate:022.Ibizian Hound, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/044.Boston_Bull/044.Boston_Bull_n02096585_5260.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/044.Boston_Bull/044.Boston_Bull_n02096585_5260.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Boston Bull', 'American Staffordshire Terrier', 'Staffordshire Bullterrier', 'French Bulldog', 'Appenzeller', 'Clumber', 'Basenji', 'Toy Terrier', 'Japanese Spaniel', 'Miniature Pinscher', 'Bluetick', 'Shetland Sheepdog', 'Basset Hound', 'Maltese Dog', 'Bull Mastiff', 'Silky Terrier', 'EntleBucher']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:46:54] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Boston Bull (置信度: 0.2011)
总耗时: 4.96秒
succ. pred cate:Boston Bull, true cate:044.Boston Bull, used_slow:True, confidence:0.2011
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/110.Brabancon_Griffon/110.Brabancon_Griffon_n02112706_1554.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/110.Brabancon_Griffon/110.Brabancon_Griffon_n02112706_1554.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Brabancon Griffon', 'Pug', 'Border Terrier', 'Pekinese', 'Japanese Spaniel', 'Affenpinscher', 'French Bulldog', 'Shih-Tzu', 'Miniature Pinscher', 'Chihuaha', 'Maltese Dog', 'Bloodhound', 'Yorkshire Terrier', 'Silky Terrier', 'Bull Mastiff', 'Redbone', 'Labrador Retriever']
步骤3: 使用MLLM进行最终推理（基于经验库）...
[2025-11-22 12:46:57] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:47:00] [显存监控] 已分配=16.96GB, 已保留=17.55GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Brabancon Griffon (置信度: 0.1874)
总耗时: 5.93秒
succ. pred cate:Brabancon Griffon, true cate:110.Brabancon Griffon, used_slow:True, confidence:0.1874
Processing fast and slow thinking:  48%|████▊     | 58/120 [06:40<07:55,  7.68s/it]Processing fast and slow thinking:  49%|████▉     | 59/120 [06:45<06:57,  6.84s/it]Processing fast and slow thinking:  50%|█████     | 60/120 [06:55<07:48,  7.81s/it]Processing fast and slow thinking:  51%|█████     | 61/120 [07:06<08:31,  8.66s/it]Processing fast and slow thinking:  52%|█████▏    | 62/120 [07:17<09:15,  9.58s/it]开始分类图像: ./datasets/dogs_120/images_discovery_all_1/067.Welsh_Springer_Spaniel/067.Welsh_Springer_Spaniel_n02102177_1128.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/067.Welsh_Springer_Spaniel/067.Welsh_Springer_Spaniel_n02102177_1128.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Clumber', 'Brittany', 'Welsh Springer Spaniel', 'English Setter', 'English Springer Spaniel', 'Cocker Spaniel', 'German Short-haired Pointer', 'Irish Setter', 'Japanese Spaniel', 'Basset Hound', 'Silky Terrier', 'Dandi Dinmont', 'Australian Terrier', 'Bluetick', 'Malinois', 'Maltese Dog', 'Italian Greyhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
[2025-11-22 12:47:03] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:47:06] [显存监控] 已分配=17.02GB, 已保留=18.24GB, 空闲=30.39GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:47:09] [显存监控] 已分配=16.97GB, 已保留=17.98GB, 空闲=30.44GB
[2025-11-22 12:47:12] [显存监控] 已分配=17.01GB, 已保留=17.98GB, 空闲=30.39GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Welsh Springer Spaniel (置信度: 0.8000)
总耗时: 10.50秒
succ. pred cate:Welsh Springer Spaniel, true cate:067.Welsh Springer Spaniel, used_slow:True, confidence:0.8000
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/076.Kelpie/076.Kelpie_n02105412_5288.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/076.Kelpie/076.Kelpie_n02105412_5288.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Kelpie', 'German Shepard', 'EntleBucher', 'Miniature Pinscher', 'Collie', 'Greater Swiss Mountain Dog', 'Doberman', 'Basenji', 'Black-and-tan Coonhound', 'Eskimo Dog', 'Great Dane', 'Groenendael', 'Whippet', 'Norwich Terrier', 'Toy Terrier', 'Bull Mastiff', 'Bernese Mountain Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:47:15] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
[2025-11-22 12:47:18] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Kelpie (置信度: 0.1378)
总耗时: 4.89秒
succ. pred cate:Kelpie, true cate:076.Kelpie, used_slow:True, confidence:0.1378
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/072.Schipperke/072.Schipperke_n02104365_6140.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/072.Schipperke/072.Schipperke_n02104365_6140.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Miniature Pinscher', 'Chihuaha', 'Kelpie', 'Toy Terrier', 'Schipperke', 'Italian Greyhound', 'Mexican Hairless', 'Collie', 'Basenji', 'Cardigan', 'Norwich Terrier', 'Dandi Dinmont', 'Australian Terrier', 'Maltese Dog', 'American Staffordshire Terrier', 'Malinois', 'Lhasa']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:47:21] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
模糊匹配类别修正: 'Chihuahua' -> 'Chihuaha'
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:47:24] [显存监控] 已分配=16.94GB, 已保留=17.46GB, 空闲=30.46GB
[2025-11-22 12:47:27] [显存监控] 已分配=16.95GB, 已保留=17.47GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Schipperke (置信度: 0.8500)
总耗时: 10.06秒
succ. pred cate:Schipperke, true cate:072.Schipperke, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/065.Clumber/065.Clumber_n02101556_4514.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/065.Clumber/065.Clumber_n02101556_4514.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Welsh Springer Spaniel', 'Brittany', 'English Setter', 'Sussex Spaniel', 'Clumber', 'Blenheim Spaniel', 'English Foxhound', 'Irish Setter', 'English Springer Spaniel', 'Bloodhound', 'Otterhound', 'Great Dane', 'Tibetan Terrier', 'Cocker Spaniel', 'Bouvier des Flandres', 'Chow', 'Bernese Mountain Dog', 'Redbone', 'Saint Bernard', 'Greater Swiss Mountain Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:47:30] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:47:33] [显存监控] 已分配=16.99GB, 已保留=17.59GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:47:36] [显存监控] 已分配=16.94GB, 已保留=17.44GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Clumber (置信度: 0.9500)
总耗时: 10.66秒
succ. pred cate:Clumber, true cate:065.Clumber, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/049.Tibetan_Terrier/049.Tibetan_Terrier_n02097474_5841.jpg
执行快思考...
[2025-11-22 12:47:39] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/049.Tibetan_Terrier/049.Tibetan_Terrier_n02097474_5841.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Dandi Dinmont', 'Soft-coated Wheaten Terrier', 'Maltese Dog', 'Lhasa', 'Miniature Poodle', 'Tibetan Terrier', 'Shih-Tzu', 'West Highland White Terrier', 'Sealyham Terrier', 'Old English Sheepdog', 'Kuvasz', 'Otterhound', 'Silky Terrier', 'Pekinese', 'Greater Swiss Mountain Dog', 'Cairn']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:47:42] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:47:45] [显存监控] 已分配=17.01GB, 已保留=17.60GB, 空闲=30.39GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:47:48] [显存监控] 已分配=16.95GB, 已保留=17.50GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: West Highland White Terrier (置信度: 0.8500)
总耗时: 11.71秒
succ. pred cate:West Highland White Terrier, true cate:049.Tibetan Terrier, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/114.Miniature_Poodle/114.Miniature_Poodle_n02113712_2274.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/114.Miniature_Poodle/114.Miniature_Poodle_n02113712_2274.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Miniature Poodle', 'Bedlington Terrier', 'Kerry Blue Terrier', 'Dandi Dinmont', 'Toy Poodle', 'Maltese Dog', 'Standard Poodle', 'Standard Schnauzer', 'Komondor', 'Miniature Schnauzer', 'Kuvasz', 'Otterhound', 'Soft-coated Wheaten Terrier', 'Pekinese', 'Irish Setter', 'Old English Sheepdog', 'Cairn']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
Processing fast and slow thinking:  52%|█████▎    | 63/120 [07:23<07:50,  8.26s/it]Processing fast and slow thinking:  53%|█████▎    | 64/120 [07:28<06:51,  7.35s/it]Processing fast and slow thinking:  54%|█████▍    | 65/120 [07:33<06:02,  6.60s/it]Processing fast and slow thinking:  55%|█████▌    | 66/120 [07:44<07:07,  7.92s/it]Processing fast and slow thinking:  56%|█████▌    | 67/120 [07:49<06:22,  7.22s/it]Processing fast and slow thinking:  57%|█████▋    | 68/120 [07:55<05:58,  6.89s/it]Processing fast and slow thinking:  57%|█████▊    | 69/120 [08:01<05:33,  6.54s/it][2025-11-22 12:47:51] [显存监控] 已分配=16.94GB, 已保留=17.38GB, 空闲=30.46GB
[2025-11-22 12:47:54] [显存监控] 已分配=16.99GB, 已保留=17.73GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Standard Poodle (置信度: 0.0781)
总耗时: 5.19秒
succ. pred cate:Standard Poodle, true cate:114.Miniature Poodle, used_slow:True, confidence:0.0781
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/111.Pembroke/111.Pembroke_n02113023_6140.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/111.Pembroke/111.Pembroke_n02113023_6140.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Pembroke', 'Cardigan', 'German Shepard', 'Appenzeller', 'Chihuaha', 'Basenji', 'EntleBucher', 'Bernese Mountain Dog', 'Miniature Pinscher', 'Kelpie', 'Samoyed', 'Malamute', 'Toy Poodle', 'Lakeland Terrier', 'Basset Hound', 'Labrador Retriever', 'Doberman']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:47:57] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:48:00] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Pembroke (置信度: 0.1622)
总耗时: 5.24秒
succ. pred cate:Pembroke, true cate:111.Pembroke, used_slow:True, confidence:0.1622
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/036.Yorkshire_Terrier/036.Yorkshire_Terrier_n02094433_730.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/036.Yorkshire_Terrier/036.Yorkshire_Terrier_n02094433_730.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Yorkshire Terrier', 'Silky Terrier', 'Australian Terrier', 'Cairn', 'Shih-Tzu', 'Affenpinscher', 'Norwich Terrier', 'Norfolk Terrier', 'Japanese Spaniel', 'Miniature Schnauzer', 'Maltese Dog', 'Dandi Dinmont', 'Lhasa', 'Tibetan Terrier', 'Papillon']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:03] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Yorkshire Terrier (置信度: 0.1561)
总耗时: 4.83秒
succ. pred cate:Yorkshire Terrier, true cate:036.Yorkshire Terrier, used_slow:True, confidence:0.1561
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/068.Cocker_Spaniel/068.Cocker_Spaniel_n02102318_6612.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/068.Cocker_Spaniel/068.Cocker_Spaniel_n02102318_6612.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Curly-coater Retriever', 'Cocker Spaniel', 'Irish Water Spaniel', 'Clumber', 'Flat-coated Retriever', 'Sussex Spaniel', 'English Springer Spaniel', 'Irish Setter', 'Welsh Springer Spaniel', 'Gordon Setter', 'Airedale', 'Golden Retriever', 'Otterhound', 'Collie', 'Great Dane', 'Groenendael', 'Bernese Mountain Dog', 'Old English Sheepdog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
[2025-11-22 12:48:06] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:09] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:48:12] [显存监控] 已分配=17.01GB, 已保留=17.59GB, 空闲=30.39GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:15] [显存监控] 已分配=16.95GB, 已保留=17.47GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Clumber (置信度: 0.8500)
总耗时: 11.02秒
failed. pred cate:Clumber, true cate:068.Cocker Spaniel, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/086.Miniature_Pinscher/086.Miniature_Pinscher_n02107312_3227.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/086.Miniature_Pinscher/086.Miniature_Pinscher_n02107312_3227.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Miniature Pinscher', 'Doberman', 'Kelpie', 'Toy Terrier', 'Chihuaha', 'EntleBucher', 'Rottweiler', 'Appenzeller', 'Basenji', 'Mexican Hairless', 'Yorkshire Terrier', 'Maltese Dog', 'Silky Terrier', 'Redbone', 'Bull Mastiff', 'Australian Terrier', 'Schipperke']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:18] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:48:21] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Miniature Pinscher (置信度: 0.1788)
总耗时: 5.56秒
succ. pred cate:Miniature Pinscher, true cate:086.Miniature Pinscher, used_slow:True, confidence:0.1788
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/071.Kuvasz/071.Kuvasz_n02104029_662.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/071.Kuvasz/071.Kuvasz_n02104029_662.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Great Pyrenees', 'Golden Retriever', 'Kuvasz', 'Maltese Dog', 'Chow', 'Eskimo Dog', 'Komondor', 'Curly-coater Retriever', 'Old English Sheepdog', 'Samoyed', 'Pekinese', 'Otterhound', 'Soft-coated Wheaten Terrier', 'Borzoi', 'Malinois', 'Keeshond', 'Silky Terrier', 'Groenendael']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:48:24] [显存监控] 已分配=16.96GB, 已保留=17.71GB, 空闲=30.44GB
[2025-11-22 12:48:27] [显存监控] 已分配=16.99GB, 已保留=17.71GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Great Pyrenees (置信度: 0.1440)
总耗时: 6.12秒
failed. pred cate:Great Pyrenees, true cate:071.Kuvasz, used_slow:True, confidence:0.1440
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/112.Cardigan/112.Cardigan_n02113186_5833.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/112.Cardigan/112.Cardigan_n02113186_5833.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Pembroke', 'Cardigan', 'Basenji', 'Collie', 'Shetland Sheepdog', 'Japanese Spaniel', 'Beagle', 'Appenzeller', 'Brittany', 'Dhole', 'Greater Swiss Mountain Dog', 'Golden Retriever', 'Boston Bull', 'Old English Sheepdog', 'Otterhound', 'German Shepard', 'Toy Poodle']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:30] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:48:33] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Pembroke (置信度: 0.2082)
总耗时: 5.72秒
failed. pred cate:Pembroke, true cate:112.Cardigan, used_slow:True, confidence:0.2082
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/070.Irish_Water_Spaniel/070.Irish_Water_Spaniel_n02102973_2642.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/070.Irish_Water_Spaniel/070.Irish_Water_Spaniel_n02102973_2642.jpg
步骤1: 提取快思考候选类别...
Processing fast and slow thinking:  58%|█████▊    | 70/120 [08:07<05:19,  6.39s/it]Processing fast and slow thinking:  59%|█████▉    | 71/120 [08:17<06:00,  7.36s/it]Processing fast and slow thinking:  60%|██████    | 72/120 [08:22<05:16,  6.60s/it]Processing fast and slow thinking:  61%|██████    | 73/120 [08:28<05:13,  6.67s/it]Processing fast and slow thinking:  62%|██████▏   | 74/120 [08:34<04:49,  6.28s/it]Processing fast and slow thinking:  62%|██████▎   | 75/120 [08:38<04:19,  5.78s/it]快思考Top-10候选类别: ['Toy Poodle', 'Miniature Poodle', 'Irish Water Spaniel', 'Curly-coater Retriever', 'Standard Poodle', 'Labrador Retriever', 'Cocker Spaniel', 'Gordon Setter', 'Kerry Blue Terrier', 'Flat-coated Retriever', 'Basset Hound', 'Lakeland Terrier', 'Silky Terrier', 'Collie', 'German Short-haired Pointer', 'Maltese Dog', 'Briard', 'Appenzeller']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:36] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:48:39] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Standard Poodle (置信度: 0.0845)
总耗时: 6.06秒
failed. pred cate:Standard Poodle, true cate:070.Irish Water Spaniel, used_slow:True, confidence:0.0845
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/020.Italian_Greyhound/020.Italian_Greyhound_n02091032_490.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/020.Italian_Greyhound/020.Italian_Greyhound_n02091032_490.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Italian Greyhound', 'Whippet', 'Mexican Hairless', 'African Hunting Dog', 'Great Dane', 'Basenji', 'Bedlington Terrier', 'Miniature Pinscher', 'Appenzeller', 'Scottish Deerhound', 'English Springer Spaniel', 'Siberian Husky', 'Rhodesian Ridgeback', 'Irish Setter', 'Borzoi', 'Black-and-tan Coonhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:42] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.44GB
[2025-11-22 12:48:45] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:48] [显存监控] 已分配=16.95GB, 已保留=17.46GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Whippet (置信度: 0.9500)
总耗时: 9.61秒
failed. pred cate:Whippet, true cate:020.Italian Greyhound, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/034.Norfolk_Terrier/034.Norfolk_Terrier_n02094114_99.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/034.Norfolk_Terrier/034.Norfolk_Terrier_n02094114_99.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Irish Terrier', 'Norfolk Terrier', 'Border Terrier', 'Australian Terrier', 'Airedale', 'Lakeland Terrier', 'Soft-coated Wheaten Terrier', 'Norwich Terrier', 'Cairn', 'Dandi Dinmont', 'Silky Terrier', 'Otterhound', 'Sealyham Terrier', 'Kuvasz', 'Tibetan Terrier', 'Maltese Dog', 'Cardigan']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:51] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:48:54] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Border Terrier (置信度: 0.1109)
总耗时: 4.84秒
succ. pred cate:Border Terrier, true cate:034.Norfolk Terrier, used_slow:True, confidence:0.1109
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/002.Maltese_Dog/002.Maltese_Dog_n02085936_16355.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/002.Maltese_Dog/002.Maltese_Dog_n02085936_16355.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['West Highland White Terrier', 'Dandi Dinmont', 'Sealyham Terrier', 'Maltese Dog', 'Miniature Poodle', 'Shih-Tzu', 'Miniature Schnauzer', 'Norwich Terrier', 'Wirehaired Fox Terrier', 'Cairn', 'Kuvasz', 'Pekinese', 'Cardigan', 'Otterhound', 'Silky Terrier', 'Yorkshire Terrier', 'Toy Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:48:57] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:49:00] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: West Highland White Terrier (置信度: 0.1352)
总耗时: 6.84秒
failed. pred cate:West Highland White Terrier, true cate:002.Maltese Dog, used_slow:True, confidence:0.1352
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/119.African_Hunting_Dog/119.African_Hunting_Dog_n02116738_8653.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/119.African_Hunting_Dog/119.African_Hunting_Dog_n02116738_8653.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['African Hunting Dog', 'Appenzeller', 'Dingo', 'Groenendael', 'Collie', 'Malinois', 'Kelpie', 'English Setter', 'Toy Terrier', 'Bluetick', 'Whippet', 'Dhole', 'Scotch Terrier', 'German Shepard', 'Great Dane', 'EntleBucher', 'Otterhound', 'Keeshond']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:03] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:49:06] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: African Hunting Dog (置信度: 0.2376)
总耗时: 5.37秒
succ. pred cate:African Hunting Dog, true cate:119.African Hunting Dog, used_slow:True, confidence:0.2376
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/084.German_Shepard/084.German_Shepard_n02106662_9625.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/084.German_Shepard/084.German_Shepard_n02106662_9625.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['German Shepard', 'Malinois', 'Norwegian Elkhound', 'Groenendael', 'Appenzeller', 'Malamute', 'Kelpie', 'African Hunting Dog', 'Eskimo Dog', 'Scotch Terrier', 'Bull Mastiff', 'Keeshond', 'Redbone', 'Great Dane', 'Kuvasz', 'Basset Hound', 'Rottweiler']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:09] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: German Shepard (置信度: 0.1433)
总耗时: 4.59秒
succ. pred cate:German Shepard, true cate:084.German Shepard, used_slow:True, confidence:0.1433
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/038.Lakeland_Terrier/038.Lakeland_Terrier_n02095570_4782.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/038.Lakeland_Terrier/038.Lakeland_Terrier_n02095570_4782.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Curly-coater Retriever', 'Kerry Blue Terrier', 'Giant Schnauzer', 'Flat-coated Retriever', 'Miniature Poodle', 'Scotch Terrier', 'Standard Schnauzer', 'Miniature Schnauzer', 'Toy Poodle', 'Cocker Spaniel', 'Kuvasz', 'Tibetan Mastiff', 'Silky Terrier', 'Irish Setter', 'Groenendael', 'Cardigan', 'Boston Bull', 'Great Dane', 'Pekinese']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:12] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:49:15] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
Processing fast and slow thinking:  63%|██████▎   | 76/120 [08:44<04:17,  5.85s/it]Processing fast and slow thinking:  64%|██████▍   | 77/120 [08:49<03:57,  5.53s/it]Processing fast and slow thinking:  65%|██████▌   | 78/120 [08:54<03:48,  5.43s/it]Processing fast and slow thinking:  66%|██████▌   | 79/120 [08:59<03:31,  5.17s/it]Processing fast and slow thinking:  67%|██████▋   | 80/120 [09:09<04:28,  6.72s/it]Processing fast and slow thinking:  68%|██████▊   | 81/120 [09:16<04:19,  6.64s/it]Processing fast and slow thinking:  68%|██████▊   | 82/120 [09:21<03:53,  6.14s/it]推理后显存: 已分配=16.91GB, 已保留=17.10GB
模糊匹配类别修正: 'Curly-coated Retriever' -> 'Curly-coater Retriever'
分类完成: Curly-coater Retriever (置信度: 0.1188)
总耗时: 6.01秒
succ. pred cate:Curly-coater Retriever, true cate:038.Lakeland Terrier, used_slow:True, confidence:0.1188
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/099.Siberian_Husky/099.Siberian_Husky_n02110185_12380.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/099.Siberian_Husky/099.Siberian_Husky_n02110185_12380.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Siberian Husky', 'Eskimo Dog', 'Malamute', 'Norwegian Elkhound', 'Appenzeller', 'Basenji', 'Cardigan', 'Collie', 'Samoyed', 'Pembroke', 'Keeshond', 'Bull Mastiff', 'Doberman', 'Schipperke', 'German Shepard', 'Maltese Dog', 'Whippet', 'Basset Hound', 'Yorkshire Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:18] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:49:21] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Siberian Husky (置信度: 0.1547)
总耗时: 4.79秒
succ. pred cate:Siberian Husky, true cate:099.Siberian Husky, used_slow:True, confidence:0.1547
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/109.Keeshond/109.Keeshond_n02112350_7087.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/109.Keeshond/109.Keeshond_n02112350_7087.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Keeshond', 'Chow', 'Schipperke', 'Pomeranian', 'Eskimo Dog', 'Pekinese', 'Norwegian Elkhound', 'Malamute', 'Samoyed', 'Tibetan Mastiff', 'Afghan Hound', 'Papillon', 'Maltese Dog', 'Tibetan Terrier', 'Groenendael', 'Australian Terrier', 'Japanese Spaniel', 'Old English Sheepdog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:24] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
[2025-11-22 12:49:27] [显存监控] 已分配=16.99GB, 已保留=17.59GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Keeshond (置信度: 0.2207)
总耗时: 5.20秒
succ. pred cate:Keeshond, true cate:109.Keeshond, used_slow:True, confidence:0.2207
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/017.Redbone/017.Redbone_n02090379_3996.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/017.Redbone/017.Redbone_n02090379_3996.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Vizsla', 'Kelpie', 'Irish Setter', 'Malinois', 'Irish Terrier', 'Redbone', 'Chesapeake Bay Retriever', 'Rhodesian Ridgeback', 'Doberman', 'Dingo', 'Giant Schnauzer', 'Cardigan', 'Brabancon Griffon', 'Boston Bull', 'Mexican Hairless', 'Golden Retriever', 'German Short-haired Pointer', 'Bull Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:30] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Vizsla (置信度: 0.1430)
总耗时: 4.55秒
failed. pred cate:Vizsla, true cate:017.Redbone, used_slow:True, confidence:0.1430
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/106.Samoyed/106.Samoyed_n02111889_6592.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/106.Samoyed/106.Samoyed_n02111889_6592.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Chow', 'Eskimo Dog', 'Malamute', 'Shetland Sheepdog', 'Soft-coated Wheaten Terrier', 'Keeshond', 'West Highland White Terrier', 'Samoyed', 'Irish Wolfhound', 'Cairn', 'Lhasa', 'Toy Terrier', 'Australian Terrier', 'Weimaraner', 'Yorkshire Terrier', 'Tibetan Terrier', 'Otterhound', 'Maltese Dog', 'Bouvier des Flandres']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:33] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:49:36] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:39] [显存监控] 已分配=16.94GB, 已保留=17.46GB, 空闲=30.46GB
[2025-11-22 12:49:42] [显存监控] 已分配=16.95GB, 已保留=17.48GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Samoyed (置信度: 0.8500)
总耗时: 10.35秒
succ. pred cate:Samoyed, true cate:106.Samoyed, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/028.Staffordshire_Bullterrier/028.Staffordshire_Bullterrier_n02093256_11732.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/028.Staffordshire_Bullterrier/028.Staffordshire_Bullterrier_n02093256_11732.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Staffordshire Bullterrier', 'Bull Mastiff', 'American Staffordshire Terrier', 'Clumber', 'Leonberg', 'Brabancon Griffon', 'Great Dane', 'French Bulldog', 'Border Terrier', 'Groenendael', 'Rottweiler', 'Kelpie', 'Redbone', 'Pekinese', 'Bloodhound', 'Tibetan Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:45] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:49:48] [显存监控] 已分配=16.99GB, 已保留=17.60GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Staffordshire Bullterrier (置信度: 0.1481)
总耗时: 6.46秒
succ. pred cate:Staffordshire Bullterrier, true cate:028.Staffordshire Bullterrier, used_slow:True, confidence:0.1481
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/062.Irish_Setter/062.Irish_Setter_n02100877_5286.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/062.Irish_Setter/062.Irish_Setter_n02100877_5286.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Irish Setter', 'Golden Retriever', 'Sussex Spaniel', 'Otterhound', 'Afghan Hound', 'Clumber', 'Briard', 'Cocker Spaniel', 'Bloodhound', 'Vizsla', 'Redbone', 'Kuvasz', 'Tibetan Terrier', 'Flat-coated Retriever', 'Silky Terrier', 'Malinois']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:51] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Irish Setter (置信度: 0.1232)
总耗时: 4.96秒
succ. pred cate:Irish Setter, true cate:062.Irish Setter, used_slow:True, confidence:0.1232
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/010.Basset_Hound/010.Basset_Hound_n02088238_7181.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/010.Basset_Hound/010.Basset_Hound_n02088238_7181.jpg
步骤1: 提取快思考候选类别...
Processing fast and slow thinking:  69%|██████▉   | 83/120 [09:31<04:35,  7.44s/it]Processing fast and slow thinking:  70%|███████   | 84/120 [09:36<03:59,  6.64s/it]Processing fast and slow thinking:  71%|███████   | 85/120 [09:47<04:35,  7.86s/it]Processing fast and slow thinking:  72%|███████▏  | 86/120 [09:52<04:00,  7.06s/it]Processing fast and slow thinking:  72%|███████▎  | 87/120 [09:58<03:41,  6.71s/it]Processing fast and slow thinking:  73%|███████▎  | 88/120 [10:03<03:19,  6.23s/it]快思考Top-10候选类别: ['Beagle', 'Basset Hound', 'Redbone', 'Walker Hound', 'English Foxhound', 'EntleBucher', 'Vizsla', 'Black-and-tan Coonhound', 'Bloodhound', 'Welsh Springer Spaniel', 'Irish Setter', 'Greater Swiss Mountain Dog', 'Kelpie', 'Boston Bull', 'Soft-coated Wheaten Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
[2025-11-22 12:49:54] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:49:57] [显存监控] 已分配=16.97GB, 已保留=17.59GB, 空闲=30.43GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:50:00] [显存监控] 已分配=16.93GB, 已保留=17.26GB, 空闲=30.47GB
[2025-11-22 12:50:03] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Basset Hound (置信度: 0.9500)
总耗时: 10.47秒
succ. pred cate:Basset Hound, true cate:010.Basset Hound, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/041.Cairn/041.Cairn_n02096177_5206.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/041.Cairn/041.Cairn_n02096177_5206.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Yorkshire Terrier', 'Cairn', 'Silky Terrier', 'Norwich Terrier', 'Affenpinscher', 'Norfolk Terrier', 'Australian Terrier', 'Dandi Dinmont', 'Shih-Tzu', 'Border Terrier', 'Maltese Dog', 'Lhasa', 'Japanese Spaniel', 'Toy Terrier', 'Lakeland Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:50:06] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:50:09] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Norwich Terrier (置信度: 0.1027)
总耗时: 4.78秒
failed. pred cate:Norwich Terrier, true cate:041.Cairn, used_slow:True, confidence:0.1027
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/004.Shih_Tzu/004.Shih_Tzu_n02086240_1011.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/004.Shih_Tzu/004.Shih_Tzu_n02086240_1011.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Lhasa', 'Shih-Tzu', 'Tibetan Terrier', 'Dandi Dinmont', 'Yorkshire Terrier', 'Norfolk Terrier', 'Pekinese', 'Soft-coated Wheaten Terrier', 'Cairn', 'Affenpinscher', 'Maltese Dog', 'Silky Terrier', 'Australian Terrier', 'Japanese Spaniel', 'Norwich Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:50:12] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:50:15] [显存监控] 已分配=16.92GB, 已保留=17.26GB, 空闲=30.48GB
[2025-11-22 12:50:18] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Shih-Tzu (置信度: 0.9000)
总耗时: 10.71秒
succ. pred cate:Shih-Tzu, true cate:004.Shih Tzu, used_slow:True, confidence:0.9000
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/090.EntleBucher/090.EntleBucher_n02108000_716.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/090.EntleBucher/090.EntleBucher_n02108000_716.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['EntleBucher', 'Greater Swiss Mountain Dog', 'Cardigan', 'Beagle', 'Walker Hound', 'Bernese Mountain Dog', 'Collie', 'Appenzeller', 'English Foxhound', 'Eskimo Dog', 'Otterhound', 'Saint Bernard', 'Kerry Blue Terrier', 'Maltese Dog', 'Basset Hound', 'Redbone']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:50:21] [显存监控] 已分配=16.96GB, 已保留=17.74GB, 空闲=30.44GB
[2025-11-22 12:50:24] [显存监控] 已分配=16.99GB, 已保留=17.74GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: EntleBucher (置信度: 0.1637)
总耗时: 5.20秒
succ. pred cate:EntleBucher, true cate:090.EntleBucher, used_slow:True, confidence:0.1637
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/042.Australian_Terrier/042.Australian_Terrier_n02096294_3554.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/042.Australian_Terrier/042.Australian_Terrier_n02096294_3554.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Yorkshire Terrier', 'Silky Terrier', 'Affenpinscher', 'Cairn', 'Norwich Terrier', 'Briard', 'Norfolk Terrier', 'Australian Terrier', 'Dandi Dinmont', 'Shih-Tzu', 'Maltese Dog', 'Pekinese', 'Lhasa', 'Otterhound', 'Standard Schnauzer']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:50:27] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:50:30] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Yorkshire Terrier (置信度: 0.1423)
总耗时: 5.87秒
succ. pred cate:Yorkshire Terrier, true cate:042.Australian Terrier, used_slow:True, confidence:0.1423
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/008.Rhodesian_Ridgeback/008.Rhodesian_Ridgeback_n02087394_3795.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/008.Rhodesian_Ridgeback/008.Rhodesian_Ridgeback_n02087394_3795.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Rhodesian Ridgeback', 'Vizsla', 'Redbone', 'Black-and-tan Coonhound', 'Malinois', 'Walker Hound', 'Doberman', 'Irish Setter', 'Rottweiler', 'Great Dane', 'Brabancon Griffon', 'Bull Mastiff', 'Bloodhound', 'German Short-haired Pointer', 'Golden Retriever', 'Boston Bull', 'Greater Swiss Mountain Dog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:50:33] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
[2025-11-22 12:50:36] [显存监控] 已分配=16.99GB, 已保留=17.58GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Rhodesian Ridgeback (置信度: 0.1511)
总耗时: 5.13秒
succ. pred cate:Rhodesian Ridgeback, true cate:008.Rhodesian Ridgeback, used_slow:True, confidence:0.1511
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/029.American_Staffordshire_Terrier/029.American_Staffordshire_Terrier_n02093428_3353.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/029.American_Staffordshire_Terrier/029.American_Staffordshire_Terrier_n02093428_3353.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Staffordshire Bullterrier', 'American Staffordshire Terrier', 'Boxer', 'Bull Mastiff', 'Clumber', 'Boston Bull', 'Great Dane', 'French Bulldog', 'Appenzeller', 'Basenji', 'Yorkshire Terrier', 'Vizsla', 'Bluetick', 'Maltese Dog', 'Doberman', 'Silky Terrier', 'Toy Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
Processing fast and slow thinking:  74%|███████▍  | 89/120 [10:10<03:18,  6.40s/it]Processing fast and slow thinking:  75%|███████▌  | 90/120 [10:15<02:59,  6.00s/it]Processing fast and slow thinking:  76%|███████▌  | 91/120 [10:25<03:31,  7.30s/it]Processing fast and slow thinking:  77%|███████▋  | 92/120 [10:35<03:45,  8.04s/it]Processing fast and slow thinking:  78%|███████▊  | 93/120 [10:40<03:12,  7.14s/it]Processing fast and slow thinking:  78%|███████▊  | 94/120 [10:45<02:51,  6.60s/it]Processing fast and slow thinking:  79%|███████▉  | 95/120 [10:50<02:32,  6.11s/it][2025-11-22 12:50:39] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:50:42] [显存监控] 已分配=16.99GB, 已保留=17.60GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: American Staffordshire Terrier (置信度: 0.1427)
总耗时: 6.78秒
succ. pred cate:American Staffordshire Terrier, true cate:029.American Staffordshire Terrier, used_slow:True, confidence:0.1427
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/094.French_Bulldog/094.French_Bulldog_n02108915_7608.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/094.French_Bulldog/094.French_Bulldog_n02108915_7608.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['French Bulldog', 'Staffordshire Bullterrier', 'American Staffordshire Terrier', 'Boston Bull', 'Appenzeller', 'Pug', 'Cardigan', 'Japanese Spaniel', 'Bull Mastiff', 'West Highland White Terrier', 'Soft-coated Wheaten Terrier', 'Cairn', 'Lhasa', 'Otterhound', 'Italian Greyhound', 'Greater Swiss Mountain Dog', 'Maltese Dog', 'Beagle']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:50:45] [显存监控] 已分配=16.96GB, 已保留=17.66GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: French Bulldog (置信度: 0.1525)
总耗时: 5.07秒
succ. pred cate:French Bulldog, true cate:094.French Bulldog, used_slow:True, confidence:0.1525
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/085.Doberman/085.Doberman_n02107142_4763.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/085.Doberman/085.Doberman_n02107142_4763.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Mexican Hairless', 'Kelpie', 'Great Dane', 'Scotch Terrier', 'Doberman', 'Italian Greyhound', 'Malinois', 'Whippet', 'Boston Bull', 'Staffordshire Bullterrier', 'Cardigan', 'Black-and-tan Coonhound', 'Irish Setter', 'Basset Hound', 'Siberian Husky', 'West Highland White Terrier', 'American Staffordshire Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
[2025-11-22 12:50:48] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:50:51] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:50:54] [显存监控] 已分配=16.94GB, 已保留=17.48GB, 空闲=30.46GB
[2025-11-22 12:50:57] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Doberman (置信度: 0.8500)
总耗时: 10.35秒
succ. pred cate:Doberman, true cate:085.Doberman, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/053.Lhasa/053.Lhasa_n02098413_3033.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/053.Lhasa/053.Lhasa_n02098413_3033.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Lhasa', 'Shih-Tzu', 'Maltese Dog', 'Tibetan Terrier', 'Pekinese', 'Japanese Spaniel', 'Dandi Dinmont', 'Affenpinscher', 'Old English Sheepdog', 'Miniature Schnauzer', 'Silky Terrier', 'Yorkshire Terrier', 'Pug', 'Brittany', 'French Bulldog', 'Australian Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:00] [显存监控] 已分配=16.97GB, 已保留=17.59GB, 空闲=30.43GB
[2025-11-22 12:51:03] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:06] [显存监控] 已分配=16.95GB, 已保留=17.50GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Shih-Tzu (置信度: 0.8500)
总耗时: 9.74秒
failed. pred cate:Shih-Tzu, true cate:053.Lhasa, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/030.Bedlington_Terrier/030.Bedlington_Terrier_n02093647_79.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/030.Bedlington_Terrier/030.Bedlington_Terrier_n02093647_79.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Miniature Poodle', 'Bedlington Terrier', 'Old English Sheepdog', 'Kerry Blue Terrier', 'Soft-coated Wheaten Terrier', 'Maltese Dog', 'Dandi Dinmont', 'Lakeland Terrier', 'Airedale', 'Toy Poodle', 'Silky Terrier', 'Malinois', 'Otterhound', 'Australian Terrier', 'Redbone', 'Brittany', 'Kuvasz']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:09] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:51:12] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Miniature Poodle (置信度: 0.1365)
总耗时: 5.04秒
failed. pred cate:Miniature Poodle, true cate:030.Bedlington Terrier, used_slow:True, confidence:0.1365
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/016.English_Foxhound/016.English_Foxhound_n02089973_1907.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/016.English_Foxhound/016.English_Foxhound_n02089973_1907.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Bluetick', 'Walker Hound', 'Clumber', 'English Foxhound', 'Beagle', 'Basset Hound', 'Welsh Springer Spaniel', 'Brittany', 'English Springer Spaniel', 'German Short-haired Pointer', 'Standard Poodle', 'Cardigan', 'Black-and-tan Coonhound', 'Greater Swiss Mountain Dog', 'West Highland White Terrier', 'Irish Setter', 'Shetland Sheepdog']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:15] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:51:18] [显存监控] 已分配=16.99GB, 已保留=17.60GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bluetick (置信度: 0.1280)
总耗时: 5.34秒
failed. pred cate:Bluetick, true cate:016.English Foxhound, used_slow:True, confidence:0.1280
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/108.Chow/108.Chow_n02112137_14448.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/108.Chow/108.Chow_n02112137_14448.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Chow', 'Pomeranian', 'Keeshond', 'Pekinese', 'Tibetan Mastiff', 'Samoyed', 'Schipperke', 'Toy Poodle', 'Lhasa', 'Norfolk Terrier', 'Pembroke', 'Maltese Dog', 'Japanese Spaniel', 'Silky Terrier', 'Yorkshire Terrier', 'Appenzeller']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:21] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Chow (置信度: 0.1625)
总耗时: 4.98秒
succ. pred cate:Chow, true cate:108.Chow, used_slow:True, confidence:0.1625
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/001.Japanese_Spaniel/001.Japanese_Spaniel_n02085782_1691.jpg
执行快思考...
Processing fast and slow thinking:  80%|████████  | 96/120 [10:54<02:13,  5.57s/it]Processing fast and slow thinking:  81%|████████  | 97/120 [11:05<02:42,  7.07s/it]Processing fast and slow thinking:  82%|████████▏ | 98/120 [11:11<02:28,  6.75s/it]Processing fast and slow thinking:  82%|████████▎ | 99/120 [11:16<02:11,  6.26s/it]Processing fast and slow thinking:  83%|████████▎ | 100/120 [11:20<01:53,  5.69s/it]Processing fast and slow thinking:  84%|████████▍ | 101/120 [11:26<01:44,  5.51s/it]快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/001.Japanese_Spaniel/001.Japanese_Spaniel_n02085782_1691.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Japanese Spaniel', 'Blenheim Spaniel', 'Tibetan Terrier', 'Pekinese', 'Shih-Tzu', 'Lhasa', 'Papillon', 'English Springer Spaniel', 'Appenzeller', 'Maltese Dog', 'Afghan Hound', 'Sealyham Terrier', 'Bernese Mountain Dog', 'Old English Sheepdog', 'EntleBucher', 'Otterhound', 'Keeshond']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:24] [显存监控] 已分配=16.95GB, 已保留=17.50GB, 空闲=30.45GB
[2025-11-22 12:51:27] [显存监控] 已分配=16.95GB, 已保留=17.50GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Japanese Spaniel (置信度: 0.1231)
总耗时: 4.31秒
succ. pred cate:Japanese Spaniel, true cate:001.Japanese Spaniel, used_slow:True, confidence:0.1231
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/073.Groenendael/073.Groenendael_n02105056_7068.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/073.Groenendael/073.Groenendael_n02105056_7068.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Schipperke', 'Gordon Setter', 'Scotch Terrier', 'Groenendael', 'Malinois', 'Collie', 'Kelpie', 'German Shepard', 'Flat-coated Retriever', 'African Hunting Dog', 'Great Dane', 'Keeshond', 'Black-and-tan Coonhound', 'Tibetan Mastiff', 'Bull Mastiff', 'Kuvasz', 'Walker Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:30] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:51:33] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:36] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Schipperke (置信度: 0.9500)
总耗时: 10.58秒
failed. pred cate:Schipperke, true cate:073.Groenendael, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/083.Rottweiler/083.Rottweiler_n02106550_2197.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/083.Rottweiler/083.Rottweiler_n02106550_2197.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Rottweiler', 'Bernese Mountain Dog', 'Black-and-tan Coonhound', 'Greater Swiss Mountain Dog', 'Doberman', 'Kelpie', 'Groenendael', 'Gordon Setter', 'Tibetan Mastiff', 'EntleBucher', 'Giant Schnauzer', 'Redbone', 'Bull Mastiff', 'Malinois', 'Kuvasz', 'Golden Retriever']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:39] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:51:42] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Rottweiler (置信度: 0.1605)
总耗时: 6.00秒
succ. pred cate:Rottweiler, true cate:083.Rottweiler, used_slow:True, confidence:0.1605
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/024.Otterhound/024.Otterhound_n02091635_2068.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/024.Otterhound/024.Otterhound_n02091635_2068.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Otterhound', 'Briard', 'Dandi Dinmont', 'Soft-coated Wheaten Terrier', 'Tibetan Terrier', 'Lhasa', 'Norfolk Terrier', 'Australian Terrier', 'Irish Terrier', 'Irish Wolfhound', 'Maltese Dog', 'Silky Terrier', 'Sealyham Terrier', 'Kerry Blue Terrier', 'Papillon', 'Afghan Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:51:45] [显存监控] 已分配=17.00GB, 已保留=18.04GB, 空闲=30.40GB
[2025-11-22 12:51:48] [显存监控] 已分配=17.00GB, 已保留=18.04GB, 空闲=30.40GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Otterhound (置信度: 0.1329)
总耗时: 5.11秒
succ. pred cate:Otterhound, true cate:024.Otterhound, used_slow:True, confidence:0.1329
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/050.Silky_Terrier/050.Silky_Terrier_n02097658_2329.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/050.Silky_Terrier/050.Silky_Terrier_n02097658_2329.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Silky Terrier', 'Australian Terrier', 'Yorkshire Terrier', 'Norwich Terrier', 'Cairn', 'Airedale', 'Norfolk Terrier', 'Miniature Schnauzer', 'Scotch Terrier', 'Lakeland Terrier', 'Dandi Dinmont', 'Maltese Dog', 'Toy Terrier', 'Lhasa', 'Otterhound', 'Groenendael']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:51:51] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Australian Terrier (置信度: 0.1301)
总耗时: 4.37秒
succ. pred cate:Australian Terrier, true cate:050.Silky Terrier, used_slow:True, confidence:0.1301
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/033.Irish_Terrier/033.Irish_Terrier_n02093991_1276.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/033.Irish_Terrier/033.Irish_Terrier_n02093991_1276.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Irish Terrier', 'Airedale', 'Norwich Terrier', 'Soft-coated Wheaten Terrier', 'Norfolk Terrier', 'Vizsla', 'Otterhound', 'Lakeland Terrier', 'Border Terrier', 'Australian Terrier', 'Miniature Poodle', 'Lhasa', 'Kelpie', 'Cairn', 'Bluetick', 'Cocker Spaniel', 'Saint Bernard']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:51:54] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:51:57] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Irish Terrier (置信度: 0.1345)
总耗时: 5.07秒
succ. pred cate:Irish Terrier, true cate:033.Irish Terrier, used_slow:True, confidence:0.1345
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/074.Malinois/074.Malinois_n02105162_6106.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/074.Malinois/074.Malinois_n02105162_6106.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Malinois', 'German Shepard', 'Groenendael', 'Norwegian Elkhound', 'Leonberg', 'Kelpie', 'Irish Terrier', 'African Hunting Dog', 'Scotch Terrier', 'Dingo', 'Bull Mastiff', 'Redbone', 'Great Dane', 'Schipperke', 'Keeshond', 'Whippet', 'Rottweiler']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:52:00] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
[2025-11-22 12:52:03] [显存监控] 已分配=16.96GB, 已保留=17.60GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Malinois (置信度: 0.1902)
总耗时: 5.02秒
Processing fast and slow thinking:  85%|████████▌ | 102/120 [11:31<01:36,  5.36s/it]Processing fast and slow thinking:  86%|████████▌ | 103/120 [11:35<01:25,  5.03s/it]Processing fast and slow thinking:  87%|████████▋ | 104/120 [11:40<01:21,  5.12s/it]Processing fast and slow thinking:  88%|████████▊ | 105/120 [11:50<01:37,  6.50s/it]Processing fast and slow thinking:  88%|████████▊ | 106/120 [11:56<01:28,  6.30s/it]Processing fast and slow thinking:  89%|████████▉ | 107/120 [12:05<01:34,  7.25s/it]Processing fast and slow thinking:  90%|█████████ | 108/120 [12:15<01:36,  8.04s/it]succ. pred cate:Malinois, true cate:074.Malinois, used_slow:True, confidence:0.1902
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/060.Vizsla/060.Vizsla_n02100583_6521.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/060.Vizsla/060.Vizsla_n02100583_6521.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Bloodhound', 'Redbone', 'Vizsla', 'Black-and-tan Coonhound', 'Basset Hound', 'Rhodesian Ridgeback', 'German Short-haired Pointer', 'Labrador Retriever', 'Irish Setter', 'Chesapeake Bay Retriever', 'Silky Terrier', 'Brittany', 'Bull Mastiff', 'Italian Greyhound', 'English Setter', 'Malinois']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:52:06] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bloodhound (置信度: 0.1408)
总耗时: 4.25秒
failed. pred cate:Bloodhound, true cate:060.Vizsla, used_slow:True, confidence:0.1408
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/118.Dhole/118.Dhole_n02115913_1142.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/118.Dhole/118.Dhole_n02115913_1142.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Dhole', 'Dingo', 'Kelpie', 'African Hunting Dog', 'Basenji', 'Irish Setter', 'Schipperke', 'Groenendael', 'Miniature Pinscher', 'Collie', 'Gordon Setter', 'Cardigan', 'Pomeranian', 'Great Dane', 'Keeshond']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:52:09] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.45GB
[2025-11-22 12:52:12] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Dhole (置信度: 0.2521)
总耗时: 5.33秒
succ. pred cate:Dhole, true cate:118.Dhole, used_slow:True, confidence:0.2521
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/064.Brittany/064.Brittany_n02101388_4229.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/064.Brittany/064.Brittany_n02101388_4229.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Borzoi', 'Appenzeller', 'English Setter', 'Saluki', 'Shetland Sheepdog', 'English Foxhound', 'Cardigan', 'Welsh Springer Spaniel', 'Brittany', 'Collie', 'Sealyham Terrier', 'Staffordshire Bullterrier', 'Tibetan Terrier', 'Otterhound', 'Kerry Blue Terrier', 'Papillon', 'Italian Greyhound', 'Flat-coated Retriever', 'EntleBucher']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:52:15] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
[2025-11-22 12:52:18] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:52:21] [显存监控] 已分配=16.94GB, 已保留=17.40GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: English Setter (置信度: 0.9000)
总耗时: 9.71秒
failed. pred cate:English Setter, true cate:064.Brittany, used_slow:True, confidence:0.9000
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/096.Saint_Bernard/096.Saint_Bernard_n02109525_18948.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/096.Saint_Bernard/096.Saint_Bernard_n02109525_18948.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Saint Bernard', 'Bernese Mountain Dog', 'Basset Hound', 'Bloodhound', 'Clumber', 'Greater Swiss Mountain Dog', 'Bull Mastiff', 'English Foxhound', 'EntleBucher', 'Welsh Springer Spaniel', 'Golden Retriever', 'Redbone', 'Airedale', 'Otterhound', 'Silky Terrier', 'Beagle', 'Walker Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:52:24] [显存监控] 已分配=16.96GB, 已保留=17.64GB, 空闲=30.44GB
[2025-11-22 12:52:27] [显存监控] 已分配=16.97GB, 已保留=17.64GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Saint Bernard (置信度: 0.1466)
总耗时: 5.84秒
succ. pred cate:Saint Bernard, true cate:096.Saint Bernard, used_slow:True, confidence:0.1466
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/007.Toy_Terrier/007.Toy_Terrier_n02087046_4402.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/007.Toy_Terrier/007.Toy_Terrier_n02087046_4402.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Mexican Hairless', 'Toy Terrier', 'Italian Greyhound', 'Whippet', 'Scotch Terrier', 'Clumber', 'German Short-haired Pointer', 'Malinois', 'Borzoi', 'Saluki', 'Otterhound', 'Shih-Tzu', 'Papillon', 'Rottweiler', 'Dandi Dinmont', 'Soft-coated Wheaten Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:52:30] [显存监控] 已分配=16.96GB, 已保留=17.67GB, 空闲=30.44GB
[2025-11-22 12:52:33] [显存监控] 已分配=17.01GB, 已保留=17.68GB, 空闲=30.39GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:52:36] [显存监控] 已分配=16.95GB, 已保留=17.60GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Toy Terrier (置信度: 0.8000)
总耗时: 9.45秒
succ. pred cate:Toy Terrier, true cate:007.Toy Terrier, used_slow:True, confidence:0.8000
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/093.Tibetan_Mastiff/093.Tibetan_Mastiff_n02108551_7523.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/093.Tibetan_Mastiff/093.Tibetan_Mastiff_n02108551_7523.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['English Springer Spaniel', 'Japanese Spaniel', 'Clumber', 'Bernese Mountain Dog', 'Collie', 'Maltese Dog', 'Cocker Spaniel', 'Blenheim Spaniel', 'Eskimo Dog', 'Miniature Poodle', 'Scotch Terrier', 'Lhasa', 'English Foxhound', 'Great Pyrenees', 'Soft-coated Wheaten Terrier', 'Otterhound', 'Golden Retriever', 'Airedale']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:52:39] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:52:42] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:52:45] [显存监控] 已分配=16.95GB, 已保留=17.46GB, 空闲=30.46GB
[2025-11-22 12:52:48] [显存监控] 已分配=16.95GB, 已保留=17.47GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bernese Mountain Dog (置信度: 0.9000)
总耗时: 9.90秒
succ. pred cate:Bernese Mountain Dog, true cate:093.Tibetan Mastiff, used_slow:True, confidence:0.9000
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/027.Weimaraner/027.Weimaraner_n02092339_4003.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  91%|█████████ | 109/120 [12:21<01:20,  7.31s/it]Processing fast and slow thinking:  92%|█████████▏| 110/120 [12:26<01:07,  6.78s/it]Processing fast and slow thinking:  92%|█████████▎| 111/120 [12:38<01:13,  8.13s/it]Processing fast and slow thinking:  93%|█████████▎| 112/120 [12:43<00:59,  7.39s/it]Processing fast and slow thinking:  94%|█████████▍| 113/120 [12:54<00:58,  8.35s/it]Processing fast and slow thinking:  95%|█████████▌| 114/120 [12:59<00:44,  7.38s/it]开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/027.Weimaraner/027.Weimaraner_n02092339_4003.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Weimaraner', 'Basset Hound', 'German Short-haired Pointer', 'Italian Greyhound', 'Vizsla', 'Groenendael', 'Whippet', 'Bedlington Terrier', 'Black-and-tan Coonhound', 'Irish Setter', 'Redbone', 'English Setter', 'Sussex Spaniel', 'Tibetan Terrier', 'Saluki', 'Bloodhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:52:51] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Weimaraner (置信度: 0.1840)
总耗时: 5.60秒
succ. pred cate:Weimaraner, true cate:027.Weimaraner, used_slow:True, confidence:0.1840
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/031.Border_Terrier/031.Border_Terrier_n02093754_7403.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/031.Border_Terrier/031.Border_Terrier_n02093754_7403.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Border Terrier', 'Norfolk Terrier', 'Cairn', 'Airedale', 'Irish Terrier', 'Miniature Schnauzer', 'Dandi Dinmont', 'Lakeland Terrier', 'Soft-coated Wheaten Terrier', 'Standard Schnauzer', 'Silky Terrier', 'Australian Terrier', 'Brittany', 'Maltese Dog', 'Yorkshire Terrier', 'Kuvasz', 'Pekinese', 'Bull Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
[2025-11-22 12:52:54] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:52:57] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Border Terrier (置信度: 0.2049)
总耗时: 5.54秒
succ. pred cate:Border Terrier, true cate:031.Border Terrier, used_slow:True, confidence:0.2049
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/037.Wirehaired_Fox_Terrier/037.Wirehaired_Fox_Terrier_n02095314_3512.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/037.Wirehaired_Fox_Terrier/037.Wirehaired_Fox_Terrier_n02095314_3512.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Miniature Schnauzer', 'Bedlington Terrier', 'Dandi Dinmont', 'Appenzeller', 'Standard Schnauzer', 'Japanese Spaniel', 'Tibetan Terrier', 'Miniature Poodle', 'Scotch Terrier', 'West Highland White Terrier', 'Sealyham Terrier', 'Kerry Blue Terrier', 'Maltese Dog', 'Pekinese', 'Saluki', 'Keeshond', 'Otterhound', 'Afghan Hound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:00] [显存监控] 已分配=16.96GB, 已保留=17.56GB, 空闲=30.44GB
[2025-11-22 12:53:03] [显存监控] 已分配=16.96GB, 已保留=17.56GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:06] [显存监控] 已分配=16.94GB, 已保留=17.40GB, 空闲=30.46GB
[2025-11-22 12:53:09] [显存监控] 已分配=16.94GB, 已保留=17.40GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Bedlington Terrier (置信度: 0.8500)
总耗时: 11.30秒
succ. pred cate:Bedlington Terrier, true cate:037.Wirehaired Fox Terrier, used_slow:True, confidence:0.8500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/054.Flat_coated_Retriever/054.Flat_coated_Retriever_n02099267_5540.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/054.Flat_coated_Retriever/054.Flat_coated_Retriever_n02099267_5540.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Flat-coated Retriever', 'Curly-coater Retriever', 'Clumber', 'Giant Schnauzer', 'Cocker Spaniel', 'Newfoundland', 'Labrador Retriever', 'Sussex Spaniel', 'Irish Water Spaniel', 'Scotch Terrier', 'Great Dane', 'Tibetan Mastiff', 'Kuvasz', 'Otterhound', 'German Short-haired Pointer', 'English Springer Spaniel', 'Groenendael', 'Kerry Blue Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:12] [显存监控] 已分配=16.96GB, 已保留=17.61GB, 空闲=30.44GB
[2025-11-22 12:53:15] [显存监控] 已分配=16.99GB, 已保留=17.61GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Flat-coated Retriever (置信度: 0.1782)
总耗时: 5.64秒
succ. pred cate:Flat-coated Retriever, true cate:054.Flat coated Retriever, used_slow:True, confidence:0.1782
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/097.Eskimo_Dog/097.Eskimo_Dog_n02109961_9973.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/097.Eskimo_Dog/097.Eskimo_Dog_n02109961_9973.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Collie', 'Siberian Husky', 'Eskimo Dog', 'English Springer Spaniel', 'Brittany', 'Kelpie', 'English Setter', 'Welsh Springer Spaniel', 'Borzoi', 'Great Pyrenees', 'Malinois', 'Maltese Dog', 'Silky Terrier', 'Redbone', 'Pomeranian', 'Kuvasz', 'Otterhound', 'Scotch Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:18] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
[2025-11-22 12:53:21] [显存监控] 已分配=16.99GB, 已保留=17.59GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:24] [显存监控] 已分配=16.94GB, 已保留=17.46GB, 空闲=30.46GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Siberian Husky (置信度: 0.9500)
总耗时: 10.60秒
failed. pred cate:Siberian Husky, true cate:097.Eskimo Dog, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/079.Shetland_Sheepdog/079.Shetland_Sheepdog_n02105855_5719.jpg
执行快思考...
[2025-11-22 12:53:27] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/079.Shetland_Sheepdog/079.Shetland_Sheepdog_n02105855_5719.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Shetland Sheepdog', 'Australian Terrier', 'Collie', 'Silky Terrier', 'Scotch Terrier', 'Afghan Hound', 'Basenji', 'Borzoi', 'Appenzeller', 'Saluki', 'Tibetan Terrier', 'Papillon', 'Golden Retriever', 'Maltese Dog', 'Italian Greyhound', 'Malinois', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.12GB
[2025-11-22 12:53:30] [显存监控] 已分配=16.96GB, 已保留=17.63GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Shetland Sheepdog (置信度: 0.1661)
总耗时: 5.10秒
succ. pred cate:Shetland Sheepdog, true cate:079.Shetland Sheepdog, used_slow:True, confidence:0.1661
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/091.Boxer/091.Boxer_n02108089_14719.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/091.Boxer/091.Boxer_n02108089_14719.jpg
步骤1: 提取快思考候选类别...
Processing fast and slow thinking:  96%|█████████▌| 115/120 [13:09<00:40,  8.15s/it]Processing fast and slow thinking:  97%|█████████▋| 116/120 [13:13<00:28,  7.07s/it]Processing fast and slow thinking:  98%|█████████▊| 117/120 [13:18<00:18,  6.28s/it]Processing fast and slow thinking:  98%|█████████▊| 118/120 [13:23<00:11,  5.93s/it]Processing fast and slow thinking:  99%|█████████▉| 119/120 [13:28<00:05,  5.71s/it]Processing fast and slow thinking: 100%|██████████| 120/120 [13:40<00:00,  7.58s/it]Processing fast and slow thinking: 100%|██████████| 120/120 [13:40<00:00,  6.84s/it]
快思考Top-10候选类别: ['Bull Mastiff', 'Boxer', 'Saint Bernard', 'Staffordshire Bullterrier', 'Appenzeller', 'American Staffordshire Terrier', 'French Bulldog', 'Pug', 'Boston Bull', 'Brabancon Griffon', 'Redbone', 'Greater Swiss Mountain Dog', 'Beagle', 'Bloodhound', 'Cairn', 'Vizsla']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:33] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:53:36] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:39] [显存监控] 已分配=16.95GB, 已保留=17.48GB, 空闲=30.46GB
[2025-11-22 12:53:42] [显存监控] 已分配=16.95GB, 已保留=17.49GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Boxer (置信度: 0.9500)
总耗时: 9.94秒
succ. pred cate:Boxer, true cate:091.Boxer, used_slow:True, confidence:0.9500
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/026.Scottish_Deerhound/026.Scottish_Deerhound_n02092002_1727.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/026.Scottish_Deerhound/026.Scottish_Deerhound_n02092002_1727.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Scottish Deerhound', 'Irish Wolfhound', 'Groenendael', 'Standard Schnauzer', 'Norwegian Elkhound', 'Bedlington Terrier', 'Miniature Schnauzer', 'Irish Terrier', 'African Hunting Dog', 'Cairn', 'Borzoi', 'Dingo', 'Great Dane', 'Siberian Husky', 'West Highland White Terrier', 'Tibetan Mastiff']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:45] [显存监控] 已分配=16.96GB, 已保留=17.57GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Scottish Deerhound (置信度: 0.2000)
总耗时: 4.55秒
succ. pred cate:Scottish Deerhound, true cate:026.Scottish Deerhound, used_slow:True, confidence:0.2000
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/005.Blenheim_Spaniel/005.Blenheim_Spaniel_n02086646_3986.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/005.Blenheim_Spaniel/005.Blenheim_Spaniel_n02086646_3986.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Blenheim Spaniel', 'Japanese Spaniel', 'Clumber', 'Shih-Tzu', 'Brittany', 'Papillon', 'Pekinese', 'Cocker Spaniel', 'English Springer Spaniel', 'Welsh Springer Spaniel', 'Silky Terrier', 'Maltese Dog', 'Australian Terrier', 'Yorkshire Terrier', 'Dandi Dinmont', 'Tibetan Terrier', 'Otterhound']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:48] [显存监控] 已分配=16.96GB, 已保留=17.58GB, 空闲=30.44GB
[2025-11-22 12:53:51] [显存监控] 已分配=16.91GB, 已保留=17.10GB, 空闲=30.50GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Blenheim Spaniel (置信度: 0.1659)
总耗时: 4.45秒
succ. pred cate:Blenheim Spaniel, true cate:005.Blenheim Spaniel, used_slow:True, confidence:0.1659
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/011.Beagle/011.Beagle_n02088364_4052.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/011.Beagle/011.Beagle_n02088364_4052.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Beagle', 'Basset Hound', 'Appenzeller', 'EntleBucher', 'English Foxhound', 'Blenheim Spaniel', 'Japanese Spaniel', 'Greater Swiss Mountain Dog', 'Walker Hound', 'Pembroke', 'Labrador Retriever', 'Toy Poodle', 'Maltese Dog', 'Silky Terrier', 'Yorkshire Terrier']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.92GB, 已保留=17.11GB
[2025-11-22 12:53:54] [显存监控] 已分配=17.00GB, 已保留=18.14GB, 空闲=30.40GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Beagle (置信度: 0.1475)
总耗时: 5.11秒
succ. pred cate:Beagle, true cate:011.Beagle, used_slow:True, confidence:0.1475
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/035.Norwich_Terrier/035.Norwich_Terrier_n02094258_2911.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/035.Norwich_Terrier/035.Norwich_Terrier_n02094258_2911.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Yorkshire Terrier', 'Norfolk Terrier', 'Norwich Terrier', 'Silky Terrier', 'Australian Terrier', 'Cairn', 'Soft-coated Wheaten Terrier', 'Border Terrier', 'Irish Terrier', 'Lakeland Terrier', 'Maltese Dog', 'Airedale', 'Dandi Dinmont', 'Miniature Schnauzer', 'Japanese Spaniel']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:53:57] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.45GB
[2025-11-22 12:54:00] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Norfolk Terrier (置信度: 0.1093)
总耗时: 5.19秒
succ. pred cate:Norfolk Terrier, true cate:035.Norwich Terrier, used_slow:True, confidence:0.1093
开始分类图像: ./datasets/dogs_120/images_discovery_all_1/098.Malamute/098.Malamute_n02110063_12514.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: ./datasets/dogs_120/images_discovery_all_1/098.Malamute/098.Malamute_n02110063_12514.jpg
步骤1: 提取快思考候选类别...
快思考Top-10候选类别: ['Eskimo Dog', 'Siberian Husky', 'Collie', 'Malamute', 'Keeshond', 'Greater Swiss Mountain Dog', 'Groenendael', 'Norwegian Elkhound', 'Samoyed', 'Standard Schnauzer', 'Leonberg', 'Boston Bull', 'Whippet', 'Old English Sheepdog', 'Chesapeake Bay Retriever', 'Giant Schnauzer', 'Bernese Mountain Dog', 'Great Dane', 'Malinois']
步骤3: 使用MLLM进行最终推理（基于经验库）...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:54:03] [显存监控] 已分配=16.96GB, 已保留=17.59GB, 空闲=30.44GB
[2025-11-22 12:54:06] [显存监控] 已分配=16.99GB, 已保留=17.60GB, 空闲=30.41GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
快慢思考结果不一致，进行最终融合决策...
推理前显存: 已分配=16.91GB, 已保留=17.10GB
[2025-11-22 12:54:09] [显存监控] 已分配=16.94GB, 已保留=17.46GB, 空闲=30.46GB
[2025-11-22 12:54:12] [显存监控] 已分配=16.95GB, 已保留=17.47GB, 空闲=30.45GB
推理后显存: 已分配=16.91GB, 已保留=17.10GB
分类完成: Siberian Husky (置信度: 0.8500)
总耗时: 11.95秒
failed. pred cate:Siberian Husky, true cate:098.Malamute, used_slow:True, confidence:0.8500
✅ 正确预测总数: 101
  - 其中仅快思考正确: 1
  - 其中慢思考触发且正确: 100
❌ 错误预测总数: 19
📊 慢思考触发数量: 119
[fast and slow] 总体准确率: 0.8417 (101/120)
[fast and slow] 快思考准确率: 1.0000
[fast and slow] 慢思考触发比例: 0.9917
[fast and slow] 慢思考准确率: 0.8403

=== Experiment End Time: 2025-11-22 12:54:13 ===
=== Total Runtime: 0小时 14分 39.06秒 ===

