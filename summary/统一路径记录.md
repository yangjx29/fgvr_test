# 统一路径记录

## 概述
本文档记录了项目中所有使用绝对路径的位置，用于统一配置管理。所有绝对路径应该移至 `config.yaml` 配置文件中进行统一管理。

## 需要配置化的绝对路径

### 1. 模型路径配置

#### 1.1 CLIP模型路径
**当前绝对路径**: `/home/Dataset/Models/Clip/clip-vit-base-patch32`

**使用位置**:
- `fast_slow_thinking_system.py` (第36-37行)
- `knowledge_base_builder.py` (第34-35行) 
- `retrieval/multimodal_retrieval.py` (第29行, 第499行)
- `cvd/cdv_captioner.py` (第23行)

**建议配置项**: `models.clip.path`

#### 1.2 Qwen模型路径
**当前绝对路径**: `/home/Dataset/Models/Qwen`

**使用位置**:
- `agents/mllm_bot.py` (第70行)

**建议配置项**: `models.qwen.base_path`

#### 1.3 BLIP模型路径
**当前绝对路径**: `/home/Dataset/Models/blip`

**使用位置**:
- `agents/vqa_bot.py` (第54行)
- `retrieval/multimodal_retrieval.py` (第75-76行，已注释)

**建议配置项**: `models.blip.base_path`

### 2. 数据集路径配置

#### 2.1 基础数据集路径
**当前绝对路径**: `/home/miu/GoldsGym/global_datasets/`

**使用位置**:
- `data/bird200.py` (第475行): `CUB_200_2011/CUB_200_2011`
- `data/car196.py` (第471行): `car_196`
- `data/flower102.py` (第523行): `flowers_102`
- `data/pet37.py` (第585行): `pet_37`
- `data/dog120.py` (第477行): `dogs_120`

**建议配置项**: 
- `datasets.base_path`: `/home/miu/GoldsGym/global_datasets`
- `datasets.bird200.path`: `CUB_200_2011/CUB_200_2011`
- `datasets.car196.path`: `car_196`
- `datasets.flower102.path`: `flowers_102`
- `datasets.pet37.path`: `pet_37`
- `datasets.dog120.path`: `dogs_120`

### 3. 实验数据路径配置

#### 3.1 实验基础路径
**当前绝对路径**: `/data/yjx/MLLM/`

**使用位置**:
- `discovering.py` (注释中的示例命令，第371, 405, 483, 561, 631行)
- `retrieval/multimodal_retrieval.py` (第513-521行，已注释)

**建议配置项**: `experiments.base_path`

#### 3.2 知识库路径
**当前路径模式**: 
- `/data/yjx/MLLM/Try_again/experiments/dog120/knowledge_base`
- `/data/yjx/MLLM/Try/experiments/dog120/knowledge_base`

**建议配置项**: `experiments.knowledge_base_dir`

#### 3.3 测试数据路径
**当前路径模式**:
- `/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_10`
- `/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1`

**建议配置项**: `experiments.test_data_base_path`

### 4. 已注释的路径（需要清理）

以下路径在代码中已被注释，建议完全移除：
- `agents/mllm_bot.py` (第11行): `/data/yjx/MLLM/UniFGVR`
- `utils/configuration.py` (第14, 18行): `/data/yjx/MLLM/UniFGVR/configs/`
- `retrieval/multimodal_retrieval.py` (第9行): `/data/yjx/MLLM/UniFGVR`

## 配置文件结构建议

建议在 `config.yaml` 中添加以下配置结构：

```yaml
# 模型路径配置
models:
  clip:
    path: "/home/Dataset/Models/Clip/clip-vit-base-patch32"
  qwen:
    base_path: "/home/Dataset/Models/Qwen"
    model_name: "Qwen2.5-VL-7B-Instruct"
  blip:
    base_path: "/home/Dataset/Models/blip"

# 数据集路径配置
datasets:
  base_path: "/home/miu/GoldsGym/global_datasets"
  bird200:
    path: "CUB_200_2011/CUB_200_2011"
  car196:
    path: "car_196"
  flower102:
    path: "flowers_102"
  pet37:
    path: "pet_37"
  dog120:
    path: "dogs_120"

# 实验路径配置
experiments:
  base_path: "/data/yjx/MLLM"
  knowledge_base_dir: "experiments/{dataset}/knowledge_base"
  test_data_base_path: "/data/yjx/MLLM/UniFGVR/datasets"
```

## 修改优先级

### 高优先级（核心功能）
1. 模型路径配置 - 影响所有推理功能
2. 数据集路径配置 - 影响数据加载

### 中优先级（实验功能）
1. 实验路径配置 - 主要影响实验和示例

### 低优先级（清理工作）
1. 移除已注释的绝对路径引用

## 注意事项

1. **路径分隔符**: 使用 `os.path.join()` 或 `pathlib.Path` 确保跨平台兼容性
2. **环境变量**: 考虑支持环境变量覆盖配置文件中的路径
3. **相对路径**: 优先使用相对路径，仅在必要时使用绝对路径
4. **路径验证**: 在加载配置时验证路径是否存在
5. **默认值**: 为每个路径配置提供合理的默认值

## 影响的主要文件

需要修改以使用配置化路径的文件：
- `fast_slow_thinking_system.py`
- `knowledge_base_builder.py`
- `agents/mllm_bot.py`
- `agents/vqa_bot.py`
- `retrieval/multimodal_retrieval.py`
- `cvd/cdv_captioner.py`
- `data/bird200.py`
- `data/car196.py`
- `data/flower102.py`
- `data/pet37.py`
- `data/dog120.py`
