/data/yjx/cache/conda/envs/finer/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/data/yjx/cache/conda/envs/finer/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.48, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
Namespace(mode='fast_slow', config_file_env='./configs/env_machine.yml', config_file_expt='./configs/expts/dog120_all.yml', num_per_category='3', kshot=None, region_num=None, superclass=None, gallery_out=None, fusion_method='concat', knowledge_base_dir='/data/yjx/MLLM/Try_again/experiments/dog120/knowledge_base', query_image=None, test_data_dir='/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1', results_out='./logs/fast_and_slow_eval.json', use_slow_thinking=None, confidence_threshold=0.8, similarity_threshold=0.7)
{'setup': 'ours', 'experiment': 5.0, 'dataset_name': 'dog', 'num_classes': 120, 'num_base': 60, 'num_novel': 60, 'seed': 1, 'batch_size': 256, 'clustering_method': 'multi_clip_voting', 'model_size': 'ViT-B/16', 'model_size_vqa': 'OPT6.7B-COCO', 'model_size_mllm': 'Qwen2.5-VL-7B', 'model_type_llm': 'gpt-3.5-turbo', 'image_size': 224, 'verbose': False, 'host': 'xiao', 'num_workers': 16, 'device': 'cuda', 'device_count': '1', 'device_id': '0', 'data_dir': './datasets/dogs_120', 'expt_dir': './experiments/dog120', 'expt_dir_describe': './experiments/dog120/describe', 'path_vqa_questions': './experiments/dog120/describe/dog_vqa_questions_ours', 'path_vqa_answers': './experiments/dog120/describe/dog_attributes_pairs', 'path_llm_prompts': './experiments/dog120/describe/dog_llm_prompts', 'path_identify_answers': './experiments/dog120/identify', 'expt_dir_guess': './experiments/dog120/guess', 'path_llm_replies_raw': './experiments/dog120/guess/dog_llm_replies_raw', 'path_llm_replies_jsoned': './experiments/dog120/guess/dog_llm_replies_jsoned', 'path_llm_gussed_names': './experiments/dog120/guess/dog_llm_gussed_names', 'expt_dir_gallery': './experiments/dog120/gallery', 'path_references': './experiments/dog120/gallery/dog_image_references', 'path_regions': './experiments/dog120/gallery/dog_image_regions', 'path_descriptions': './experiments/dog120/gallery/dog_image_descriptions_attn', 'expt_dir_grouping': './experiments/dog120/grouping'}
初始化MLLM模型...
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:02<00:10,  2.60s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:05<00:08,  2.91s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:08<00:06,  3.04s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:12<00:03,  3.08s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:12<00:00,  2.24s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:12<00:00,  2.56s/it]
local_model_path: /data/yjx/MLLM/models/Qwen2.5-VL-7B-Instruct
初始化知识库构建器...
初始化快思考模块...
已加载历史统计量: 4976 次预测
初始化慢思考模块...
快慢思考系统初始化完成!
从 /data/yjx/MLLM/Try_again/experiments/dog120/knowledge_base 加载知识库...
知识库已从 /data/yjx/MLLM/Try_again/experiments/dog120/knowledge_base 加载
知识库加载完成!
test sample:{'014.Black and tan Coonhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/014.Black_and_tan_Coonhound/014.Black_and_tan_Coonhound_n02089078_1275.jpg'], '044.Boston Bull': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/044.Boston_Bull/044.Boston_Bull_n02096585_5260.jpg'], '043.Dandi Dinmont': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/043.Dandi_Dinmont/043.Dandi_Dinmont_n02096437_730.jpg'], '002.Maltese Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/002.Maltese_Dog/002.Maltese_Dog_n02085936_16355.jpg'], '010.Basset Hound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/010.Basset_Hound/010.Basset_Hound_n02088238_7181.jpg'], '094.French Bulldog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/094.French_Bulldog/094.French_Bulldog_n02108915_7608.jpg'], '009.Afghan Hound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/009.Afghan_Hound/009.Afghan_Hound_n02088094_6035.jpg'], '029.American Staffordshire Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/029.American_Staffordshire_Terrier/029.American_Staffordshire_Terrier_n02093428_3353.jpg'], '035.Norwich Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/035.Norwich_Terrier/035.Norwich_Terrier_n02094258_2911.jpg'], '086.Miniature Pinscher': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/086.Miniature_Pinscher/086.Miniature_Pinscher_n02107312_3227.jpg'], '118.Dhole': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/118.Dhole/118.Dhole_n02115913_1142.jpg'], '072.Schipperke': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/072.Schipperke/072.Schipperke_n02104365_6140.jpg'], '028.Staffordshire Bullterrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/028.Staffordshire_Bullterrier/028.Staffordshire_Bullterrier_n02093256_11732.jpg'], '077.Komondor': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/077.Komondor/077.Komondor_n02105505_3933.jpg'], '079.Shetland Sheepdog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/079.Shetland_Sheepdog/079.Shetland_Sheepdog_n02105855_5719.jpg'], '111.Pembroke': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/111.Pembroke/111.Pembroke_n02113023_6140.jpg'], '058.Chesapeake Bay Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/058.Chesapeake_Bay_Retriever/058.Chesapeake_Bay_Retriever_n02099849_513.jpg'], '003.Pekinese': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/003.Pekinese/003.Pekinese_n02086079_8902.jpg'], '025.Saluki': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/025.Saluki/025.Saluki_n02091831_11021.jpg'], '102.Pug': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/102.Pug/102.Pug_n02110958_1975.jpg'], '062.Irish Setter': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/062.Irish_Setter/062.Irish_Setter_n02100877_5286.jpg'], '066.English Springer Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/066.English_Springer_Spaniel/066.English_Springer_Spaniel_n02102040_5096.jpg'], '057.Labrador Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/057.Labrador_Retriever/057.Labrador_Retriever_n02099712_3613.jpg'], '007.Toy Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/007.Toy_Terrier/007.Toy_Terrier_n02087046_4402.jpg'], '084.German Shepard': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/084.German_Shepard/084.German_Shepard_n02106662_9625.jpg'], '048.Scotch Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/048.Scotch_Terrier/048.Scotch_Terrier_n02097298_2443.jpg'], '090.EntleBucher': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/090.EntleBucher/090.EntleBucher_n02108000_716.jpg'], '059.German Short haired Pointer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/059.German_Short_haired_Pointer/059.German_Short_haired_Pointer_n02100236_4198.jpg'], '047.Standard Schnauzer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/047.Standard_Schnauzer/047.Standard_Schnauzer_n02097209_2194.jpg'], '045.Miniature Schnauzer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/045.Miniature_Schnauzer/045.Miniature_Schnauzer_n02097047_724.jpg'], '004.Shih Tzu': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/004.Shih_Tzu/004.Shih_Tzu_n02086240_1011.jpg'], '064.Brittany': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/064.Brittany/064.Brittany_n02101388_4229.jpg'], '053.Lhasa': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/053.Lhasa/053.Lhasa_n02098413_3033.jpg'], '042.Australian Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/042.Australian_Terrier/042.Australian_Terrier_n02096294_3554.jpg'], '039.Sealyham Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/039.Sealyham_Terrier/039.Sealyham_Terrier_n02095889_610.jpg'], '067.Welsh Springer Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/067.Welsh_Springer_Spaniel/067.Welsh_Springer_Spaniel_n02102177_1128.jpg'], '068.Cocker Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/068.Cocker_Spaniel/068.Cocker_Spaniel_n02102318_6612.jpg'], '089.Appenzeller': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/089.Appenzeller/089.Appenzeller_n02107908_7236.jpg'], '017.Redbone': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/017.Redbone/017.Redbone_n02090379_3996.jpg'], '119.African Hunting Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/119.African_Hunting_Dog/119.African_Hunting_Dog_n02116738_8653.jpg'], '113.Toy Poodle': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/113.Toy_Poodle/113.Toy_Poodle_n02113624_665.jpg'], '027.Weimaraner': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/027.Weimaraner/027.Weimaraner_n02092339_4003.jpg'], '041.Cairn': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/041.Cairn/041.Cairn_n02096177_5206.jpg'], '117.Dingo': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/117.Dingo/117.Dingo_n02115641_925.jpg'], '034.Norfolk Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/034.Norfolk_Terrier/034.Norfolk_Terrier_n02094114_99.jpg'], '114.Miniature Poodle': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/114.Miniature_Poodle/114.Miniature_Poodle_n02113712_2274.jpg'], '085.Doberman': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/085.Doberman/085.Doberman_n02107142_4763.jpg'], '116.Mexican Hairless': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/116.Mexican_Hairless/116.Mexican_Hairless_n02113978_2888.jpg'], '073.Groenendael': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/073.Groenendael/073.Groenendael_n02105056_7068.jpg'], '012.Bloodhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/012.Bloodhound/012.Bloodhound_n02088466_4731.jpg'], '088.Bernese Mountain Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/088.Bernese_Mountain_Dog/088.Bernese_Mountain_Dog_n02107683_6301.jpg'], '095.Great Dane': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/095.Great_Dane/095.Great_Dane_n02109047_34175.jpg'], '040.Airedale': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/040.Airedale/040.Airedale_n02096051_8826.jpg'], '107.Pomeranian': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/107.Pomeranian/107.Pomeranian_n02112018_1577.jpg'], '082.Bouvier des Flandres': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/082.Bouvier_des_Flandres/082.Bouvier_des_Flandres_n02106382_1151.jpg'], '019.Irish Wolfhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/019.Irish_Wolfhound/019.Irish_Wolfhound_n02090721_537.jpg'], '087.Greater Swiss Mountain Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/087.Greater_Swiss_Mountain_Dog/087.Greater_Swiss_Mountain_Dog_n02107574_2436.jpg'], '099.Siberian Husky': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/099.Siberian_Husky/099.Siberian_Husky_n02110185_12380.jpg'], '075.Briard': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/075.Briard/075.Briard_n02105251_2591.jpg'], '033.Irish Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/033.Irish_Terrier/033.Irish_Terrier_n02093991_1276.jpg'], '013.Bluetick': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/013.Bluetick/013.Bluetick_n02088632_4058.jpg'], '061.English Setter': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/061.English_Setter/061.English_Setter_n02100735_3595.jpg'], '020.Italian Greyhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/020.Italian_Greyhound/020.Italian_Greyhound_n02091032_490.jpg'], '112.Cardigan': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/112.Cardigan/112.Cardigan_n02113186_5833.jpg'], '063.Gordon Setter': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/063.Gordon_Setter/063.Gordon_Setter_n02101006_2540.jpg'], '083.Rottweiler': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/083.Rottweiler/083.Rottweiler_n02106550_2197.jpg'], '018.Borzoi': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/018.Borzoi/018.Borzoi_n02090622_6976.jpg'], '008.Rhodesian Ridgeback': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/008.Rhodesian_Ridgeback/008.Rhodesian_Ridgeback_n02087394_3795.jpg'], '050.Silky Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/050.Silky_Terrier/050.Silky_Terrier_n02097658_2329.jpg'], '098.Malamute': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/098.Malamute/098.Malamute_n02110063_12514.jpg'], '070.Irish Water Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/070.Irish_Water_Spaniel/070.Irish_Water_Spaniel_n02102973_2642.jpg'], '100.Affenpinscher': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/100.Affenpinscher/100.Affenpinscher_n02110627_10439.jpg'], '078.Old English Sheepdog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/078.Old_English_Sheepdog/078.Old_English_Sheepdog_n02105641_3531.jpg'], '106.Samoyed': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/106.Samoyed/106.Samoyed_n02111889_6592.jpg'], '022.Ibizian Hound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/022.Ibizian_Hound/022.Ibizian_Hound_n02091244_5818.jpg'], '000.Chihuaha': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/000.Chihuaha/000.Chihuaha_n02085620_3488.jpg'], '023.Norwegian Elkhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/023.Norwegian_Elkhound/023.Norwegian_Elkhound_n02091467_4362.jpg'], '036.Yorkshire Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/036.Yorkshire_Terrier/036.Yorkshire_Terrier_n02094433_730.jpg'], '037.Wirehaired Fox Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/037.Wirehaired_Fox_Terrier/037.Wirehaired_Fox_Terrier_n02095314_3512.jpg'], '011.Beagle': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/011.Beagle/011.Beagle_n02088364_4052.jpg'], '109.Keeshond': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/109.Keeshond/109.Keeshond_n02112350_7087.jpg'], '015.Walker Hound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/015.Walker_Hound/015.Walker_Hound_n02089867_24.jpg'], '101.Basenji': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/101.Basenji/101.Basenji_n02110806_4876.jpg'], '105.Great Pyrenees': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/105.Great_Pyrenees/105.Great_Pyrenees_n02111500_5052.jpg'], '046.Giant Schnauzer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/046.Giant_Schnauzer/046.Giant_Schnauzer_n02097130_5907.jpg'], '006.Papillon': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/006.Papillon/006.Papillon_n02086910_4388.jpg'], '024.Otterhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/024.Otterhound/024.Otterhound_n02091635_2068.jpg'], '031.Border Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/031.Border_Terrier/031.Border_Terrier_n02093754_7403.jpg'], '030.Bedlington Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/030.Bedlington_Terrier/030.Bedlington_Terrier_n02093647_79.jpg'], '051.Soft coated Wheaten Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/051.Soft_coated_Wheaten_Terrier/051.Soft_coated_Wheaten_Terrier_n02098105_838.jpg'], '071.Kuvasz': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/071.Kuvasz/071.Kuvasz_n02104029_662.jpg'], '110.Brabancon Griffon': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/110.Brabancon_Griffon/110.Brabancon_Griffon_n02112706_1554.jpg'], '060.Vizsla': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/060.Vizsla/060.Vizsla_n02100583_6521.jpg'], '026.Scottish Deerhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/026.Scottish_Deerhound/026.Scottish_Deerhound_n02092002_1727.jpg'], '080.Collie': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/080.Collie/080.Collie_n02106030_10057.jpg'], '096.Saint Bernard': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/096.Saint_Bernard/096.Saint_Bernard_n02109525_18948.jpg'], '081.Border Collie': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/081.Border_Collie/081.Border_Collie_n02106166_3882.jpg'], '005.Blenheim Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/005.Blenheim_Spaniel/005.Blenheim_Spaniel_n02086646_3986.jpg'], '038.Lakeland Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/038.Lakeland_Terrier/038.Lakeland_Terrier_n02095570_4782.jpg'], '092.Bull Mastiff': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/092.Bull_Mastiff/092.Bull_Mastiff_n02108422_5221.jpg'], '104.Newfoundland': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/104.Newfoundland/104.Newfoundland_n02111277_8856.jpg'], '076.Kelpie': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/076.Kelpie/076.Kelpie_n02105412_5288.jpg'], '074.Malinois': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/074.Malinois/074.Malinois_n02105162_6106.jpg'], '052.West Highland White Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/052.West_Highland_White_Terrier/052.West_Highland_White_Terrier_n02098286_1632.jpg'], '069.Sussex Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/069.Sussex_Spaniel/069.Sussex_Spaniel_n02102480_5703.jpg'], '091.Boxer': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/091.Boxer/091.Boxer_n02108089_14719.jpg'], '108.Chow': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/108.Chow/108.Chow_n02112137_14448.jpg'], '049.Tibetan Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/049.Tibetan_Terrier/049.Tibetan_Terrier_n02097474_5841.jpg'], '056.Golden Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/056.Golden_Retriever/056.Golden_Retriever_n02099601_3360.jpg'], '097.Eskimo Dog': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/097.Eskimo_Dog/097.Eskimo_Dog_n02109961_9973.jpg'], '001.Japanese Spaniel': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/001.Japanese_Spaniel/001.Japanese_Spaniel_n02085782_1691.jpg'], '115.Standard Poodle': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/115.Standard_Poodle/115.Standard_Poodle_n02113799_1537.jpg'], '065.Clumber': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/065.Clumber/065.Clumber_n02101556_4514.jpg'], '016.English Foxhound': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/016.English_Foxhound/016.English_Foxhound_n02089973_1907.jpg'], '103.Leonberg': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/103.Leonberg/103.Leonberg_n02111129_1197.jpg'], '021.Whippet': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/021.Whippet/021.Whippet_n02091134_15784.jpg'], '032.Kerry Blue Terrier': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/032.Kerry_Blue_Terrier/032.Kerry_Blue_Terrier_n02093859_393.jpg'], '055.Curly coater Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/055.Curly_coater_Retriever/055.Curly_coater_Retriever_n02099429_618.jpg'], '054.Flat coated Retriever': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/054.Flat_coated_Retriever/054.Flat_coated_Retriever_n02099267_5540.jpg'], '093.Tibetan Mastiff': ['/data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/093.Tibetan_Mastiff/093.Tibetan_Mastiff_n02108551_7523.jpg']}
[fast and slow] 测试数据集包含 120 个类别
Processing fast and slow thinking:   0%|          | 0/120 [00:00<?, ?it/s]Processing fast and slow thinking:   1%|          | 1/120 [00:04<09:43,  4.90s/it]Processing fast and slow thinking:   2%|▏         | 2/120 [00:10<10:42,  5.44s/it]Processing fast and slow thinking:   2%|▎         | 3/120 [00:20<14:38,  7.51s/it]Processing fast and slow thinking:   3%|▎         | 4/120 [00:30<16:13,  8.40s/it]Processing fast and slow thinking:   4%|▍         | 5/120 [00:40<17:15,  9.00s/it]Processing fast and slow thinking:   5%|▌         | 6/120 [00:45<14:26,  7.60s/it]Processing fast and slow thinking:   7%|▋         | 8/120 [00:54<11:31,  6.18s/it]Processing fast and slow thinking:   8%|▊         | 9/120 [01:00<11:13,  6.06s/it]Processing fast and slow thinking:   8%|▊         | 10/120 [01:05<10:21,  5.65s/it]Processing fast and slow thinking:  10%|█         | 12/120 [01:15<09:43,  5.40s/it]开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/014.Black_and_tan_Coonhound/014.Black_and_tan_Coonhound_n02089078_1275.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/014.Black_and_tan_Coonhound/014.Black_and_tan_Coonhound_n02089078_1275.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Black-and-tan Coonhound, 置信度=0.475, LCB=0.086, 一致性=True, 更新m=False
分类完成: Black-and-tan Coonhound (置信度: 0.4750)
总耗时: 4.90秒
succ. pred cate:Black-and-tan Coonhound, true cate:014.Black and tan Coonhound, used_slow:True, confidence:0.4750
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/044.Boston_Bull/044.Boston_Bull_n02096585_5260.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/044.Boston_Bull/044.Boston_Bull_n02096585_5260.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Boston Bull, 置信度=0.640, LCB=0.000, 一致性=True, 更新m=False
分类完成: Boston Bull (置信度: 0.6400)
总耗时: 5.82秒
succ. pred cate:Boston Bull, true cate:044.Boston Bull, used_slow:True, confidence:0.6400
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/043.Dandi_Dinmont/043.Dandi_Dinmont_n02096437_730.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/043.Dandi_Dinmont/043.Dandi_Dinmont_n02096437_730.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Cairn, 置信度=0.526, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Cairn (置信度: 0.8000)
总耗时: 9.97秒
failed. pred cate:Cairn, true cate:043.Dandi Dinmont, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/002.Maltese_Dog/002.Maltese_Dog_n02085936_16355.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/002.Maltese_Dog/002.Maltese_Dog_n02085936_16355.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Norwich Terrier, 置信度=0.545, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Silky Terrier (置信度: 0.8000)
总耗时: 9.75秒
failed. pred cate:Silky Terrier, true cate:002.Maltese Dog, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/010.Basset_Hound/010.Basset_Hound_n02088238_7181.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/010.Basset_Hound/010.Basset_Hound_n02088238_7181.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=EntleBucher, 置信度=0.559, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Basset Hound (置信度: 0.8000)
总耗时: 10.08秒
succ. pred cate:Basset Hound, true cate:010.Basset Hound, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/094.French_Bulldog/094.French_Bulldog_n02108915_7608.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/094.French_Bulldog/094.French_Bulldog_n02108915_7608.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=French Bulldog, 置信度=0.364, LCB=0.000, 一致性=True, 更新m=False
分类完成: French Bulldog (置信度: 0.3640)
总耗时: 4.88秒
succ. pred cate:French Bulldog, true cate:094.French Bulldog, used_slow:True, confidence:0.3640
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/009.Afghan_Hound/009.Afghan_Hound_n02088094_6035.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Afghan Hound (置信度: 0.7355)
总耗时: 0.02秒
succ. pred cate:Afghan Hound, true cate:009.Afghan Hound, used_slow:False, confidence:0.7355
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/029.American_Staffordshire_Terrier/029.American_Staffordshire_Terrier_n02093428_3353.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/029.American_Staffordshire_Terrier/029.American_Staffordshire_Terrier_n02093428_3353.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=French Bulldog, 置信度=0.532, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: American Staffordshire Terrier (置信度: 0.8000)
总耗时: 9.40秒
succ. pred cate:American Staffordshire Terrier, true cate:029.American Staffordshire Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/035.Norwich_Terrier/035.Norwich_Terrier_n02094258_2911.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/035.Norwich_Terrier/035.Norwich_Terrier_n02094258_2911.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Lakeland Terrier, 置信度=0.547, LCB=0.500, 一致性=True, 更新m=False
分类完成: Lakeland Terrier (置信度: 0.5473)
总耗时: 5.75秒
failed. pred cate:Lakeland Terrier, true cate:035.Norwich Terrier, used_slow:True, confidence:0.5473
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/086.Miniature_Pinscher/086.Miniature_Pinscher_n02107312_3227.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/086.Miniature_Pinscher/086.Miniature_Pinscher_n02107312_3227.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Miniature Pinscher, 置信度=0.523, LCB=0.000, 一致性=True, 更新m=False
分类完成: Miniature Pinscher (置信度: 0.5230)
总耗时: 4.53秒
succ. pred cate:Miniature Pinscher, true cate:086.Miniature Pinscher, used_slow:True, confidence:0.5230
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/118.Dhole/118.Dhole_n02115913_1142.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Dhole (置信度: 0.7569)
总耗时: 0.02秒
succ. pred cate:Dhole, true cate:118.Dhole, used_slow:False, confidence:0.7569
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/072.Schipperke/072.Schipperke_n02104365_6140.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/072.Schipperke/072.Schipperke_n02104365_6140.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Italian Greyhound, 置信度=0.533, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Schipperke (置信度: 0.7000)
总耗时: 10.15秒
succ. pred cate:Schipperke, true cate:072.Schipperke, used_slow:True, confidence:0.7000
Processing fast and slow thinking:  11%|█         | 13/120 [01:20<09:24,  5.28s/it]Processing fast and slow thinking:  12%|█▏        | 14/120 [01:24<08:54,  5.04s/it]Processing fast and slow thinking:  12%|█▎        | 15/120 [01:34<10:59,  6.28s/it]Processing fast and slow thinking:  13%|█▎        | 16/120 [01:38<09:57,  5.74s/it]Processing fast and slow thinking:  15%|█▌        | 18/120 [01:49<09:43,  5.72s/it]Processing fast and slow thinking:  16%|█▌        | 19/120 [01:59<11:16,  6.69s/it]Processing fast and slow thinking:  17%|█▋        | 20/120 [02:05<10:53,  6.53s/it]Processing fast and slow thinking:  18%|█▊        | 21/120 [02:15<12:08,  7.36s/it]Processing fast and slow thinking:  18%|█▊        | 22/120 [02:25<13:07,  8.04s/it]Processing fast and slow thinking:  19%|█▉        | 23/120 [02:34<13:26,  8.32s/it]开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/028.Staffordshire_Bullterrier/028.Staffordshire_Bullterrier_n02093256_11732.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/028.Staffordshire_Bullterrier/028.Staffordshire_Bullterrier_n02093256_11732.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Staffordshire Bullterrier, 置信度=0.312, LCB=0.000, 一致性=True, 更新m=False
分类完成: Staffordshire Bullterrier (置信度: 0.3120)
总耗时: 4.88秒
succ. pred cate:Staffordshire Bullterrier, true cate:028.Staffordshire Bullterrier, used_slow:True, confidence:0.3120
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/077.Komondor/077.Komondor_n02105505_3933.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/077.Komondor/077.Komondor_n02105505_3933.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Komondor, 置信度=0.665, LCB=0.000, 一致性=True, 更新m=False
分类完成: Komondor (置信度: 0.6650)
总耗时: 4.33秒
succ. pred cate:Komondor, true cate:077.Komondor, used_slow:True, confidence:0.6650
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/079.Shetland_Sheepdog/079.Shetland_Sheepdog_n02105855_5719.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/079.Shetland_Sheepdog/079.Shetland_Sheepdog_n02105855_5719.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Silky Terrier, 置信度=0.566, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Collie (置信度: 0.8000)
总耗时: 9.71秒
failed. pred cate:Collie, true cate:079.Shetland Sheepdog, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/111.Pembroke/111.Pembroke_n02113023_6140.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/111.Pembroke/111.Pembroke_n02113023_6140.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Pembroke, 置信度=0.465, LCB=0.000, 一致性=True, 更新m=False
分类完成: Pembroke (置信度: 0.4650)
总耗时: 4.32秒
succ. pred cate:Pembroke, true cate:111.Pembroke, used_slow:True, confidence:0.4650
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/058.Chesapeake_Bay_Retriever/058.Chesapeake_Bay_Retriever_n02099849_513.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Chesapeake Bay Retriever (置信度: 0.9613)
总耗时: 0.02秒
succ. pred cate:Chesapeake Bay Retriever, true cate:058.Chesapeake Bay Retriever, used_slow:False, confidence:0.9613
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/003.Pekinese/003.Pekinese_n02086079_8902.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/003.Pekinese/003.Pekinese_n02086079_8902.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Papillon, 置信度=0.551, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Pekingese (置信度: 0.8000)
总耗时: 11.36秒
succ. pred cate:Pekingese, true cate:003.Pekinese, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/025.Saluki/025.Saluki_n02091831_11021.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/025.Saluki/025.Saluki_n02091831_11021.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Saluki, 置信度=0.197, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Saluki (置信度: 0.8000)
总耗时: 9.79秒
succ. pred cate:Saluki, true cate:025.Saluki, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/102.Pug/102.Pug_n02110958_1975.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/102.Pug/102.Pug_n02110958_1975.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Pug, 置信度=0.574, LCB=0.000, 一致性=True, 更新m=False
分类完成: Pug (置信度: 0.5740)
总耗时: 6.06秒
succ. pred cate:Pug, true cate:102.Pug, used_slow:True, confidence:0.5740
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/062.Irish_Setter/062.Irish_Setter_n02100877_5286.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/062.Irish_Setter/062.Irish_Setter_n02100877_5286.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Briard, 置信度=0.586, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Irish Setter (置信度: 0.8000)
总耗时: 9.64秒
succ. pred cate:Irish Setter, true cate:062.Irish Setter, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/066.English_Springer_Spaniel/066.English_Springer_Spaniel_n02102040_5096.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/066.English_Springer_Spaniel/066.English_Springer_Spaniel_n02102040_5096.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=English Springer Spaniel, 置信度=0.232, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: English Springer Spaniel (置信度: 0.9000)
总耗时: 9.80秒
succ. pred cate:English Springer Spaniel, true cate:066.English Springer Spaniel, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/057.Labrador_Retriever/057.Labrador_Retriever_n02099712_3613.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/057.Labrador_Retriever/057.Labrador_Retriever_n02099712_3613.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Mexican Hairless, 置信度=0.562, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Labrador Retriever (置信度: 0.8000)
总耗时: 9.03秒
succ. pred cate:Labrador Retriever, true cate:057.Labrador Retriever, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/007.Toy_Terrier/007.Toy_Terrier_n02087046_4402.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/007.Toy_Terrier/007.Toy_Terrier_n02087046_4402.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
Processing fast and slow thinking:  20%|██        | 24/120 [02:46<14:55,  9.33s/it]Processing fast and slow thinking:  21%|██        | 25/120 [02:51<12:46,  8.07s/it]Processing fast and slow thinking:  22%|██▏       | 26/120 [03:00<13:21,  8.52s/it]Processing fast and slow thinking:  22%|██▎       | 27/120 [03:12<14:30,  9.36s/it]Processing fast and slow thinking:  24%|██▍       | 29/120 [03:23<11:39,  7.69s/it]Processing fast and slow thinking:  25%|██▌       | 30/120 [03:33<12:34,  8.38s/it]Processing fast and slow thinking:  26%|██▌       | 31/120 [03:44<13:06,  8.84s/it]Processing fast and slow thinking:  27%|██▋       | 32/120 [03:53<13:14,  9.03s/it]Processing fast and slow thinking:  28%|██▊       | 33/120 [03:58<11:31,  7.95s/it]Processing fast and slow thinking:  28%|██▊       | 34/120 [04:09<12:24,  8.65s/it]统计更新: 类别=Scotch Terrier, 置信度=0.538, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Toy Terrier (置信度: 0.8000)
总耗时: 11.83秒
succ. pred cate:Toy Terrier, true cate:007.Toy Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/084.German_Shepard/084.German_Shepard_n02106662_9625.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/084.German_Shepard/084.German_Shepard_n02106662_9625.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
模糊匹配类别修正: 'German Shepherd' -> 'German Shepard'
统计更新: 类别=German Shepard, 置信度=0.328, LCB=0.000, 一致性=True, 更新m=False
分类完成: German Shepard (置信度: 0.3280)
总耗时: 5.00秒
succ. pred cate:German Shepard, true cate:084.German Shepard, used_slow:True, confidence:0.3280
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/048.Scotch_Terrier/048.Scotch_Terrier_n02097298_2443.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/048.Scotch_Terrier/048.Scotch_Terrier_n02097298_2443.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Cairn, 置信度=0.521, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Scotch Terrier (置信度: 0.8000)
总耗时: 9.62秒
succ. pred cate:Scotch Terrier, true cate:048.Scotch Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/090.EntleBucher/090.EntleBucher_n02108000_716.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/090.EntleBucher/090.EntleBucher_n02108000_716.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Basset Hound, 置信度=0.568, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: EntleBucher (置信度: 0.9000)
总耗时: 11.35秒
succ. pred cate:EntleBucher, true cate:090.EntleBucher, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/059.German_Short_haired_Pointer/059.German_Short_haired_Pointer_n02100236_4198.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: German Short-haired Pointer (置信度: 0.8649)
总耗时: 0.02秒
succ. pred cate:German Short-haired Pointer, true cate:059.German Short haired Pointer, used_slow:False, confidence:0.8649
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/047.Standard_Schnauzer/047.Standard_Schnauzer_n02097209_2194.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/047.Standard_Schnauzer/047.Standard_Schnauzer_n02097209_2194.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Tibetan Terrier, 置信度=0.522, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Miniature Schnauzer (置信度: 0.8000)
总耗时: 11.38秒
succ. pred cate:Miniature Schnauzer, true cate:047.Standard Schnauzer, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/045.Miniature_Schnauzer/045.Miniature_Schnauzer_n02097047_724.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/045.Miniature_Schnauzer/045.Miniature_Schnauzer_n02097047_724.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Tibetan Terrier, 置信度=0.563, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Standard Schnauzer (置信度: 0.8000)
总耗时: 10.51秒
succ. pred cate:Standard Schnauzer, true cate:045.Miniature Schnauzer, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/004.Shih_Tzu/004.Shih_Tzu_n02086240_1011.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/004.Shih_Tzu/004.Shih_Tzu_n02086240_1011.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Pekinese, 置信度=0.553, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Shih-Tzu (置信度: 0.8000)
总耗时: 10.12秒
succ. pred cate:Shih-Tzu, true cate:004.Shih Tzu, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/064.Brittany/064.Brittany_n02101388_4229.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/064.Brittany/064.Brittany_n02101388_4229.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Afghan Hound, 置信度=0.500, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: English Setter (置信度: 0.8000)
总耗时: 9.56秒
failed. pred cate:English Setter, true cate:064.Brittany, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/053.Lhasa/053.Lhasa_n02098413_3033.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/053.Lhasa/053.Lhasa_n02098413_3033.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Lhasa, 置信度=0.363, LCB=0.000, 一致性=True, 更新m=False
分类完成: Lhasa (置信度: 0.3630)
总耗时: 5.15秒
succ. pred cate:Lhasa, true cate:053.Lhasa, used_slow:True, confidence:0.3630
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/042.Australian_Terrier/042.Australian_Terrier_n02096294_3554.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/042.Australian_Terrier/042.Australian_Terrier_n02096294_3554.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Dandi Dinmont, 置信度=0.568, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Yorkshire Terrier (置信度: 0.9000)
总耗时: 10.42秒
succ. pred cate:Yorkshire Terrier, true cate:042.Australian Terrier, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/039.Sealyham_Terrier/039.Sealyham_Terrier_n02095889_610.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/039.Sealyham_Terrier/039.Sealyham_Terrier_n02095889_610.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Sealyham Terrier, 置信度=0.440, LCB=0.000, 一致性=True, 更新m=False
分类完成: Sealyham Terrier (置信度: 0.4400)
总耗时: 4.16秒
Processing fast and slow thinking:  29%|██▉       | 35/120 [04:13<10:25,  7.35s/it]Processing fast and slow thinking:  30%|███       | 36/120 [04:24<11:54,  8.51s/it]Processing fast and slow thinking:  31%|███       | 37/120 [04:34<12:09,  8.79s/it]Processing fast and slow thinking:  32%|███▏      | 38/120 [04:44<12:40,  9.28s/it]Processing fast and slow thinking:  32%|███▎      | 39/120 [04:55<13:14,  9.80s/it]Processing fast and slow thinking:  34%|███▍      | 41/120 [04:59<08:14,  6.26s/it]Processing fast and slow thinking:  35%|███▌      | 42/120 [05:04<07:38,  5.87s/it]Processing fast and slow thinking:  36%|███▌      | 43/120 [05:14<08:48,  6.87s/it]Processing fast and slow thinking:  37%|███▋      | 44/120 [05:18<07:53,  6.24s/it]Processing fast and slow thinking:  38%|███▊      | 45/120 [05:29<09:20,  7.48s/it]Processing fast and slow thinking:  38%|███▊      | 46/120 [05:34<08:30,  6.91s/it]succ. pred cate:Sealyham Terrier, true cate:039.Sealyham Terrier, used_slow:True, confidence:0.4400
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/067.Welsh_Springer_Spaniel/067.Welsh_Springer_Spaniel_n02102177_1128.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/067.Welsh_Springer_Spaniel/067.Welsh_Springer_Spaniel_n02102177_1128.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Bluetick, 置信度=0.573, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Welsh Springer Spaniel (置信度: 0.9000)
总耗时: 11.31秒
succ. pred cate:Welsh Springer Spaniel, true cate:067.Welsh Springer Spaniel, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/068.Cocker_Spaniel/068.Cocker_Spaniel_n02102318_6612.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/068.Cocker_Spaniel/068.Cocker_Spaniel_n02102318_6612.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=English Springer Spaniel, 置信度=0.500, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Kerry Blue Terrier (置信度: 0.8000)
总耗时: 9.47秒
failed. pred cate:Kerry Blue Terrier, true cate:068.Cocker Spaniel, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/089.Appenzeller/089.Appenzeller_n02107908_7236.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/089.Appenzeller/089.Appenzeller_n02107908_7236.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Bernese Mountain Dog, 置信度=0.550, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: EntleBucher (置信度: 0.8000)
总耗时: 10.43秒
failed. pred cate:EntleBucher, true cate:089.Appenzeller, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/017.Redbone/017.Redbone_n02090379_3996.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/017.Redbone/017.Redbone_n02090379_3996.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Redbone, 置信度=0.530, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Rhodesian Ridgeback (置信度: 0.8000)
总耗时: 11.05秒
failed. pred cate:Rhodesian Ridgeback, true cate:017.Redbone, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/119.African_Hunting_Dog/119.African_Hunting_Dog_n02116738_8653.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: African Hunting Dog (置信度: 0.8386)
总耗时: 0.02秒
succ. pred cate:African Hunting Dog, true cate:119.African Hunting Dog, used_slow:False, confidence:0.8386
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/113.Toy_Poodle/113.Toy_Poodle_n02113624_665.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/113.Toy_Poodle/113.Toy_Poodle_n02113624_665.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Miniature Poodle, 置信度=0.655, LCB=0.500, 一致性=True, 更新m=False
分类完成: Miniature Poodle (置信度: 0.6550)
总耗时: 4.15秒
failed. pred cate:Miniature Poodle, true cate:113.Toy Poodle, used_slow:True, confidence:0.6550
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/027.Weimaraner/027.Weimaraner_n02092339_4003.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/027.Weimaraner/027.Weimaraner_n02092339_4003.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Weimaraner, 置信度=0.638, LCB=0.000, 一致性=True, 更新m=False
分类完成: Weimaraner (置信度: 0.6380)
总耗时: 4.70秒
succ. pred cate:Weimaraner, true cate:027.Weimaraner, used_slow:True, confidence:0.6380
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/041.Cairn/041.Cairn_n02096177_5206.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/041.Cairn/041.Cairn_n02096177_5206.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Lhasa, 置信度=0.577, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Norwich Terrier (置信度: 0.8000)
总耗时: 9.68秒
failed. pred cate:Norwich Terrier, true cate:041.Cairn, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/117.Dingo/117.Dingo_n02115641_925.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/117.Dingo/117.Dingo_n02115641_925.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Dingo, 置信度=0.260, LCB=0.000, 一致性=True, 更新m=False
分类完成: Dingo (置信度: 0.2600)
总耗时: 4.54秒
succ. pred cate:Dingo, true cate:117.Dingo, used_slow:True, confidence:0.2600
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/034.Norfolk_Terrier/034.Norfolk_Terrier_n02094114_99.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/034.Norfolk_Terrier/034.Norfolk_Terrier_n02094114_99.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Dandi Dinmont, 置信度=0.587, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Border Terrier (置信度: 0.8000)
总耗时: 10.69秒
succ. pred cate:Border Terrier, true cate:034.Norfolk Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/114.Miniature_Poodle/114.Miniature_Poodle_n02113712_2274.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/114.Miniature_Poodle/114.Miniature_Poodle_n02113712_2274.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Standard Poodle, 置信度=0.541, LCB=0.500, 一致性=True, 更新m=False
分类完成: Standard Poodle (置信度: 0.5409)
总耗时: 5.47秒
succ. pred cate:Standard Poodle, true cate:114.Miniature Poodle, used_slow:True, confidence:0.5409
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/085.Doberman/085.Doberman_n02107142_4763.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/085.Doberman/085.Doberman_n02107142_4763.jpg
步骤1: 执行增强检索...
Processing fast and slow thinking:  39%|███▉      | 47/120 [05:44<09:24,  7.73s/it]Processing fast and slow thinking:  40%|████      | 48/120 [05:49<08:06,  6.76s/it]Processing fast and slow thinking:  41%|████      | 49/120 [05:59<09:12,  7.78s/it]Processing fast and slow thinking:  42%|████▏     | 50/120 [06:10<10:12,  8.76s/it]Processing fast and slow thinking:  42%|████▎     | 51/120 [06:15<08:58,  7.80s/it]Processing fast and slow thinking:  43%|████▎     | 52/120 [06:27<10:06,  8.91s/it]Processing fast and slow thinking:  44%|████▍     | 53/120 [06:37<10:25,  9.34s/it]Processing fast and slow thinking:  45%|████▌     | 54/120 [06:47<10:18,  9.37s/it]Processing fast and slow thinking:  46%|████▌     | 55/120 [06:56<10:09,  9.38s/it]Processing fast and slow thinking:  47%|████▋     | 56/120 [07:06<10:11,  9.55s/it]Processing fast and slow thinking:  48%|████▊     | 57/120 [07:16<10:11,  9.70s/it]步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Boston Bull, 置信度=0.507, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Doberman (置信度: 0.8000)
总耗时: 9.75秒
succ. pred cate:Doberman, true cate:085.Doberman, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/116.Mexican_Hairless/116.Mexican_Hairless_n02113978_2888.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/116.Mexican_Hairless/116.Mexican_Hairless_n02113978_2888.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Mexican Hairless, 置信度=0.541, LCB=0.000, 一致性=True, 更新m=False
分类完成: Mexican Hairless (置信度: 0.5410)
总耗时: 4.41秒
succ. pred cate:Mexican Hairless, true cate:116.Mexican Hairless, used_slow:True, confidence:0.5410
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/073.Groenendael/073.Groenendael_n02105056_7068.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/073.Groenendael/073.Groenendael_n02105056_7068.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=German Shepard, 置信度=0.536, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Schipperke (置信度: 0.8000)
总耗时: 10.24秒
failed. pred cate:Schipperke, true cate:073.Groenendael, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/012.Bloodhound/012.Bloodhound_n02088466_4731.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/012.Bloodhound/012.Bloodhound_n02088466_4731.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Chesapeake Bay Retriever, 置信度=0.515, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Bloodhound (置信度: 0.8000)
总耗时: 11.07秒
succ. pred cate:Bloodhound, true cate:012.Bloodhound, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/088.Bernese_Mountain_Dog/088.Bernese_Mountain_Dog_n02107683_6301.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/088.Bernese_Mountain_Dog/088.Bernese_Mountain_Dog_n02107683_6301.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Bernese Mountain Dog, 置信度=0.317, LCB=0.000, 一致性=True, 更新m=False
分类完成: Bernese Mountain Dog (置信度: 0.3170)
总耗时: 5.55秒
succ. pred cate:Bernese Mountain Dog, true cate:088.Bernese Mountain Dog, used_slow:True, confidence:0.3170
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/095.Great_Dane/095.Great_Dane_n02109047_34175.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/095.Great_Dane/095.Great_Dane_n02109047_34175.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Bloodhound, 置信度=0.566, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Great Dane (置信度: 0.9000)
总耗时: 11.53秒
succ. pred cate:Great Dane, true cate:095.Great Dane, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/040.Airedale/040.Airedale_n02096051_8826.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/040.Airedale/040.Airedale_n02096051_8826.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Irish Setter, 置信度=0.534, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Airedale (置信度: 0.8000)
总耗时: 10.34秒
succ. pred cate:Airedale, true cate:040.Airedale, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/107.Pomeranian/107.Pomeranian_n02112018_1577.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/107.Pomeranian/107.Pomeranian_n02112018_1577.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Brabancon Griffon, 置信度=0.541, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Pomeranian (置信度: 0.8000)
总耗时: 9.43秒
succ. pred cate:Pomeranian, true cate:107.Pomeranian, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/082.Bouvier_des_Flandres/082.Bouvier_des_Flandres_n02106382_1151.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/082.Bouvier_des_Flandres/082.Bouvier_des_Flandres_n02106382_1151.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Tibetan Terrier, 置信度=0.585, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Tibetan Terrier (置信度: 0.8000)
总耗时: 9.40秒
failed. pred cate:Tibetan Terrier, true cate:082.Bouvier des Flandres, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/019.Irish_Wolfhound/019.Irish_Wolfhound_n02090721_537.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/019.Irish_Wolfhound/019.Irish_Wolfhound_n02090721_537.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Cairn, 置信度=0.545, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Irish Wolfhound (置信度: 0.8000)
总耗时: 9.97秒
succ. pred cate:Irish Wolfhound, true cate:019.Irish Wolfhound, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/087.Greater_Swiss_Mountain_Dog/087.Greater_Swiss_Mountain_Dog_n02107574_2436.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/087.Greater_Swiss_Mountain_Dog/087.Greater_Swiss_Mountain_Dog_n02107574_2436.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Saint Bernard, 置信度=0.577, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: EntleBucher (置信度: 0.8000)
总耗时: 10.06秒
failed. pred cate:EntleBucher, true cate:087.Greater Swiss Mountain Dog, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/099.Siberian_Husky/099.Siberian_Husky_n02110185_12380.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  48%|████▊     | 58/120 [07:20<08:20,  8.08s/it]Processing fast and slow thinking:  49%|████▉     | 59/120 [07:31<08:57,  8.82s/it]Processing fast and slow thinking:  50%|█████     | 60/120 [07:36<07:38,  7.64s/it]Processing fast and slow thinking:  51%|█████     | 61/120 [07:40<06:32,  6.65s/it]Processing fast and slow thinking:  52%|█████▏    | 62/120 [07:50<07:15,  7.51s/it]Processing fast and slow thinking:  52%|█████▎    | 63/120 [07:55<06:28,  6.82s/it]Processing fast and slow thinking:  53%|█████▎    | 64/120 [07:59<05:41,  6.09s/it]Processing fast and slow thinking:  54%|█████▍    | 65/120 [08:09<06:30,  7.10s/it]Processing fast and slow thinking:  55%|█████▌    | 66/120 [08:13<05:38,  6.27s/it]Processing fast and slow thinking:  57%|█████▋    | 68/120 [08:24<05:02,  5.81s/it]Processing fast and slow thinking:  57%|█████▊    | 69/120 [08:30<04:58,  5.85s/it]开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/099.Siberian_Husky/099.Siberian_Husky_n02110185_12380.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Siberian Husky, 置信度=0.336, LCB=0.000, 一致性=True, 更新m=False
分类完成: Siberian Husky (置信度: 0.3360)
总耗时: 4.27秒
succ. pred cate:Siberian Husky, true cate:099.Siberian Husky, used_slow:True, confidence:0.3360
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/075.Briard/075.Briard_n02105251_2591.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/075.Briard/075.Briard_n02105251_2591.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Cairn, 置信度=0.578, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Briard (置信度: 0.8500)
总耗时: 10.55秒
succ. pred cate:Briard, true cate:075.Briard, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/033.Irish_Terrier/033.Irish_Terrier_n02093991_1276.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/033.Irish_Terrier/033.Irish_Terrier_n02093991_1276.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Irish Terrier, 置信度=0.334, LCB=0.000, 一致性=True, 更新m=False
分类完成: Irish Terrier (置信度: 0.3340)
总耗时: 4.88秒
succ. pred cate:Irish Terrier, true cate:033.Irish Terrier, used_slow:True, confidence:0.3340
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/013.Bluetick/013.Bluetick_n02088632_4058.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/013.Bluetick/013.Bluetick_n02088632_4058.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Bluetick, 置信度=0.470, LCB=0.000, 一致性=True, 更新m=False
分类完成: Bluetick (置信度: 0.4700)
总耗时: 4.34秒
succ. pred cate:Bluetick, true cate:013.Bluetick, used_slow:True, confidence:0.4700
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/061.English_Setter/061.English_Setter_n02100735_3595.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/061.English_Setter/061.English_Setter_n02100735_3595.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Bloodhound, 置信度=0.563, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: English Setter (置信度: 0.8000)
总耗时: 9.51秒
succ. pred cate:English Setter, true cate:061.English Setter, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/020.Italian_Greyhound/020.Italian_Greyhound_n02091032_490.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/020.Italian_Greyhound/020.Italian_Greyhound_n02091032_490.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Italian Greyhound, 置信度=0.402, LCB=0.052, 一致性=True, 更新m=False
分类完成: Italian Greyhound (置信度: 0.4020)
总耗时: 5.23秒
succ. pred cate:Italian Greyhound, true cate:020.Italian Greyhound, used_slow:True, confidence:0.4020
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/112.Cardigan/112.Cardigan_n02113186_5833.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/112.Cardigan/112.Cardigan_n02113186_5833.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Pembroke, 置信度=0.615, LCB=0.000, 一致性=True, 更新m=False
分类完成: Pembroke (置信度: 0.6150)
总耗时: 4.39秒
failed. pred cate:Pembroke, true cate:112.Cardigan, used_slow:True, confidence:0.6150
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/063.Gordon_Setter/063.Gordon_Setter_n02101006_2540.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/063.Gordon_Setter/063.Gordon_Setter_n02101006_2540.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Irish Setter, 置信度=0.583, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Gordon Setter (置信度: 0.8500)
总耗时: 9.46秒
succ. pred cate:Gordon Setter, true cate:063.Gordon Setter, used_slow:True, confidence:0.8500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/083.Rottweiler/083.Rottweiler_n02106550_2197.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/083.Rottweiler/083.Rottweiler_n02106550_2197.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Rottweiler, 置信度=0.451, LCB=0.000, 一致性=True, 更新m=False
分类完成: Rottweiler (置信度: 0.4510)
总耗时: 4.32秒
succ. pred cate:Rottweiler, true cate:083.Rottweiler, used_slow:True, confidence:0.4510
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/018.Borzoi/018.Borzoi_n02090622_6976.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Borzoi (置信度: 0.7161)
总耗时: 0.02秒
succ. pred cate:Borzoi, true cate:018.Borzoi, used_slow:False, confidence:0.7161
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/008.Rhodesian_Ridgeback/008.Rhodesian_Ridgeback_n02087394_3795.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/008.Rhodesian_Ridgeback/008.Rhodesian_Ridgeback_n02087394_3795.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Irish Setter, 置信度=0.537, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Rhodesian Ridgeback (置信度: 0.9000)
总耗时: 10.55秒
succ. pred cate:Rhodesian Ridgeback, true cate:008.Rhodesian Ridgeback, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/050.Silky_Terrier/050.Silky_Terrier_n02097658_2329.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/050.Silky_Terrier/050.Silky_Terrier_n02097658_2329.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Toy Terrier, 置信度=0.550, LCB=0.500, 一致性=True, 更新m=False
分类完成: Toy Terrier (置信度: 0.5503)
总耗时: 5.96秒
succ. pred cate:Toy Terrier, true cate:050.Silky Terrier, used_slow:True, confidence:0.5503
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/098.Malamute/098.Malamute_n02110063_12514.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  58%|█████▊    | 70/120 [08:40<05:51,  7.04s/it]Processing fast and slow thinking:  59%|█████▉    | 71/120 [08:45<05:15,  6.44s/it]Processing fast and slow thinking:  60%|██████    | 72/120 [08:56<06:09,  7.70s/it]Processing fast and slow thinking:  61%|██████    | 73/120 [09:06<06:39,  8.51s/it]Processing fast and slow thinking:  62%|██████▏   | 74/120 [09:17<06:55,  9.03s/it]Processing fast and slow thinking:  62%|██████▎   | 75/120 [09:27<07:06,  9.49s/it]Processing fast and slow thinking:  63%|██████▎   | 76/120 [09:37<07:05,  9.68s/it]Processing fast and slow thinking:  64%|██████▍   | 77/120 [09:42<05:56,  8.30s/it]Processing fast and slow thinking:  65%|██████▌   | 78/120 [09:47<04:59,  7.14s/it]Processing fast and slow thinking:  66%|██████▌   | 79/120 [09:58<05:38,  8.25s/it]Processing fast and slow thinking:  67%|██████▋   | 80/120 [10:04<05:11,  7.78s/it]开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/098.Malamute/098.Malamute_n02110063_12514.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Groenendael, 置信度=0.439, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Siberian Husky (置信度: 0.7500)
总耗时: 10.38秒
failed. pred cate:Siberian Husky, true cate:098.Malamute, used_slow:True, confidence:0.7500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/070.Irish_Water_Spaniel/070.Irish_Water_Spaniel_n02102973_2642.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/070.Irish_Water_Spaniel/070.Irish_Water_Spaniel_n02102973_2642.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Standard Poodle, 置信度=0.133, LCB=0.500, 一致性=True, 更新m=False
分类完成: Standard Poodle (置信度: 0.1328)
总耗时: 4.83秒
failed. pred cate:Standard Poodle, true cate:070.Irish Water Spaniel, used_slow:True, confidence:0.1328
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/100.Affenpinscher/100.Affenpinscher_n02110627_10439.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/100.Affenpinscher/100.Affenpinscher_n02110627_10439.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Pekinese, 置信度=0.593, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Affenpinscher (置信度: 0.8000)
总耗时: 10.94秒
succ. pred cate:Affenpinscher, true cate:100.Affenpinscher, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/078.Old_English_Sheepdog/078.Old_English_Sheepdog_n02105641_3531.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/078.Old_English_Sheepdog/078.Old_English_Sheepdog_n02105641_3531.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Dandi Dinmont, 置信度=0.588, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Old English Sheepdog (置信度: 0.9000)
总耗时: 10.55秒
succ. pred cate:Old English Sheepdog, true cate:078.Old English Sheepdog, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/106.Samoyed/106.Samoyed_n02111889_6592.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/106.Samoyed/106.Samoyed_n02111889_6592.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Keeshond, 置信度=0.449, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Eskimo Dog (置信度: 0.8000)
总耗时: 10.30秒
failed. pred cate:Eskimo Dog, true cate:106.Samoyed, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/022.Ibizian_Hound/022.Ibizian_Hound_n02091244_5818.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/022.Ibizian_Hound/022.Ibizian_Hound_n02091244_5818.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Vizsla, 置信度=0.510, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Basset Hound (置信度: 0.8000)
总耗时: 10.59秒
failed. pred cate:Basset Hound, true cate:022.Ibizian Hound, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/000.Chihuaha/000.Chihuaha_n02085620_3488.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/000.Chihuaha/000.Chihuaha_n02085620_3488.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
模糊匹配类别修正: 'Chihuahua' -> 'Chihuaha'
统计更新: 类别=Chihuaha, 置信度=0.175, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Chihuahua (置信度: 0.8000)
总耗时: 10.14秒
succ. pred cate:Chihuahua, true cate:000.Chihuaha, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/023.Norwegian_Elkhound/023.Norwegian_Elkhound_n02091467_4362.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/023.Norwegian_Elkhound/023.Norwegian_Elkhound_n02091467_4362.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Norwegian Elkhound, 置信度=0.442, LCB=0.000, 一致性=True, 更新m=False
分类完成: Norwegian Elkhound (置信度: 0.4420)
总耗时: 5.02秒
succ. pred cate:Norwegian Elkhound, true cate:023.Norwegian Elkhound, used_slow:True, confidence:0.4420
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/036.Yorkshire_Terrier/036.Yorkshire_Terrier_n02094433_730.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/036.Yorkshire_Terrier/036.Yorkshire_Terrier_n02094433_730.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Norwich Terrier, 置信度=0.610, LCB=0.500, 一致性=True, 更新m=False
分类完成: Norwich Terrier (置信度: 0.6100)
总耗时: 4.41秒
succ. pred cate:Norwich Terrier, true cate:036.Yorkshire Terrier, used_slow:True, confidence:0.6100
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/037.Wirehaired_Fox_Terrier/037.Wirehaired_Fox_Terrier_n02095314_3512.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/037.Wirehaired_Fox_Terrier/037.Wirehaired_Fox_Terrier_n02095314_3512.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Tibetan Terrier, 置信度=0.564, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Bedlington Terrier (置信度: 0.8000)
总耗时: 10.84秒
succ. pred cate:Bedlington Terrier, true cate:037.Wirehaired Fox Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/011.Beagle/011.Beagle_n02088364_4052.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/011.Beagle/011.Beagle_n02088364_4052.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Beagle, 置信度=0.306, LCB=0.062, 一致性=True, 更新m=False
分类完成: Beagle (置信度: 0.3060)
总耗时: 6.68秒
succ. pred cate:Beagle, true cate:011.Beagle, used_slow:True, confidence:0.3060
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/109.Keeshond/109.Keeshond_n02112350_7087.jpg
执行快思考...
Processing fast and slow thinking:  68%|██████▊   | 82/120 [10:15<04:09,  6.57s/it]Processing fast and slow thinking:  69%|██████▉   | 83/120 [10:24<04:31,  7.35s/it]Processing fast and slow thinking:  70%|███████   | 84/120 [10:33<04:39,  7.76s/it]Processing fast and slow thinking:  71%|███████   | 85/120 [10:38<04:06,  7.05s/it]Processing fast and slow thinking:  72%|███████▏  | 86/120 [10:43<03:41,  6.50s/it]Processing fast and slow thinking:  72%|███████▎  | 87/120 [10:56<04:26,  8.08s/it]Processing fast and slow thinking:  74%|███████▍  | 89/120 [11:05<03:22,  6.52s/it]Processing fast and slow thinking:  75%|███████▌  | 90/120 [11:14<03:38,  7.29s/it]Processing fast and slow thinking:  76%|███████▌  | 91/120 [11:20<03:18,  6.83s/it]Processing fast and slow thinking:  77%|███████▋  | 92/120 [11:24<02:49,  6.04s/it]快思考结果确定，直接返回...
分类完成: Keeshond (置信度: 0.7897)
总耗时: 0.02秒
succ. pred cate:Keeshond, true cate:109.Keeshond, used_slow:False, confidence:0.7897
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/015.Walker_Hound/015.Walker_Hound_n02089867_24.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/015.Walker_Hound/015.Walker_Hound_n02089867_24.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Black-and-tan Coonhound, 置信度=0.564, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Black-and-tan Coonhound (置信度: 0.8000)
总耗时: 10.29秒
failed. pred cate:Black-and-tan Coonhound, true cate:015.Walker Hound, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/101.Basenji/101.Basenji_n02110806_4876.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/101.Basenji/101.Basenji_n02110806_4876.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=English Foxhound, 置信度=0.516, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Basset Hound (置信度: 0.8000)
总耗时: 9.72秒
failed. pred cate:Basset Hound, true cate:101.Basenji, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/105.Great_Pyrenees/105.Great_Pyrenees_n02111500_5052.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/105.Great_Pyrenees/105.Great_Pyrenees_n02111500_5052.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Standard Poodle, 置信度=0.442, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Standard Poodle (置信度: 0.8000)
总耗时: 8.93秒
failed. pred cate:Standard Poodle, true cate:105.Great Pyrenees, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/046.Giant_Schnauzer/046.Giant_Schnauzer_n02097130_5907.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/046.Giant_Schnauzer/046.Giant_Schnauzer_n02097130_5907.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Scotch Terrier, 置信度=0.541, LCB=0.500, 一致性=True, 更新m=False
分类完成: Scotch Terrier (置信度: 0.5410)
总耗时: 5.13秒
failed. pred cate:Scotch Terrier, true cate:046.Giant Schnauzer, used_slow:True, confidence:0.5410
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/006.Papillon/006.Papillon_n02086910_4388.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/006.Papillon/006.Papillon_n02086910_4388.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Papillon, 置信度=0.422, LCB=0.000, 一致性=True, 更新m=False
分类完成: Papillon (置信度: 0.4220)
总耗时: 5.09秒
succ. pred cate:Papillon, true cate:006.Papillon, used_slow:True, confidence:0.4220
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/024.Otterhound/024.Otterhound_n02091635_2068.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/024.Otterhound/024.Otterhound_n02091635_2068.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Australian Terrier, 置信度=0.594, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Otterhound (置信度: 0.8000)
总耗时: 12.03秒
succ. pred cate:Otterhound, true cate:024.Otterhound, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/031.Border_Terrier/031.Border_Terrier_n02093754_7403.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Border Terrier (置信度: 0.7321)
总耗时: 0.02秒
succ. pred cate:Border Terrier, true cate:031.Border Terrier, used_slow:False, confidence:0.7321
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/030.Bedlington_Terrier/030.Bedlington_Terrier_n02093647_79.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/030.Bedlington_Terrier/030.Bedlington_Terrier_n02093647_79.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Dandi Dinmont, 置信度=0.564, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Bedlington Terrier (置信度: 0.8000)
总耗时: 9.19秒
succ. pred cate:Bedlington Terrier, true cate:030.Bedlington Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/051.Soft_coated_Wheaten_Terrier/051.Soft_coated_Wheaten_Terrier_n02098105_838.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/051.Soft_coated_Wheaten_Terrier/051.Soft_coated_Wheaten_Terrier_n02098105_838.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Lhasa, 置信度=0.583, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Soft-coated Wheaten Terrier (置信度: 0.8000)
总耗时: 9.71秒
succ. pred cate:Soft-coated Wheaten Terrier, true cate:051.Soft coated Wheaten Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/071.Kuvasz/071.Kuvasz_n02104029_662.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/071.Kuvasz/071.Kuvasz_n02104029_662.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Great Pyrenees, 置信度=0.397, LCB=0.000, 一致性=True, 更新m=False
分类完成: Great Pyrenees (置信度: 0.3970)
总耗时: 5.49秒
failed. pred cate:Great Pyrenees, true cate:071.Kuvasz, used_slow:True, confidence:0.3970
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/110.Brabancon_Griffon/110.Brabancon_Griffon_n02112706_1554.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/110.Brabancon_Griffon/110.Brabancon_Griffon_n02112706_1554.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Brabancon Griffon, 置信度=0.637, LCB=0.000, 一致性=True, 更新m=False
分类完成: Brabancon Griffon (置信度: 0.6370)
总耗时: 3.90秒
succ. pred cate:Brabancon Griffon, true cate:110.Brabancon Griffon, used_slow:True, confidence:0.6370
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/060.Vizsla/060.Vizsla_n02100583_6521.jpg
执行快思考...
快思考结果不确定，执行慢思考...
Processing fast and slow thinking:  78%|███████▊  | 93/120 [11:35<03:21,  7.46s/it]Processing fast and slow thinking:  78%|███████▊  | 94/120 [11:40<02:52,  6.64s/it]Processing fast and slow thinking:  79%|███████▉  | 95/120 [11:44<02:33,  6.12s/it]Processing fast and slow thinking:  80%|████████  | 96/120 [11:54<02:49,  7.06s/it]Processing fast and slow thinking:  81%|████████  | 97/120 [12:04<03:01,  7.88s/it]Processing fast and slow thinking:  82%|████████▏ | 98/120 [12:08<02:32,  6.92s/it]Processing fast and slow thinking:  82%|████████▎ | 99/120 [12:19<02:51,  8.15s/it]Processing fast and slow thinking:  84%|████████▍ | 101/120 [12:24<01:43,  5.46s/it]Processing fast and slow thinking:  85%|████████▌ | 102/120 [12:34<01:58,  6.59s/it]Processing fast and slow thinking:  86%|████████▌ | 103/120 [12:39<01:43,  6.07s/it]开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/060.Vizsla/060.Vizsla_n02100583_6521.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Basset Hound, 置信度=0.578, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Redbone Coonhound (置信度: 0.8000)
总耗时: 11.15秒
failed. pred cate:Redbone Coonhound, true cate:060.Vizsla, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/026.Scottish_Deerhound/026.Scottish_Deerhound_n02092002_1727.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/026.Scottish_Deerhound/026.Scottish_Deerhound_n02092002_1727.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Scottish Deerhound, 置信度=0.505, LCB=0.000, 一致性=True, 更新m=False
分类完成: Scottish Deerhound (置信度: 0.5050)
总耗时: 4.56秒
succ. pred cate:Scottish Deerhound, true cate:026.Scottish Deerhound, used_slow:True, confidence:0.5050
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/080.Collie/080.Collie_n02106030_10057.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/080.Collie/080.Collie_n02106030_10057.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Shetland Sheepdog, 置信度=0.592, LCB=0.000, 一致性=True, 更新m=False
分类完成: Shetland Sheepdog (置信度: 0.5920)
总耗时: 4.86秒
failed. pred cate:Shetland Sheepdog, true cate:080.Collie, used_slow:True, confidence:0.5920
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/096.Saint_Bernard/096.Saint_Bernard_n02109525_18948.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/096.Saint_Bernard/096.Saint_Bernard_n02109525_18948.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Bull Mastiff, 置信度=0.526, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Saint Bernard (置信度: 0.9000)
总耗时: 9.35秒
succ. pred cate:Saint Bernard, true cate:096.Saint Bernard, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/081.Border_Collie/081.Border_Collie_n02106166_3882.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/081.Border_Collie/081.Border_Collie_n02106166_3882.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Old English Sheepdog, 置信度=0.576, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Collie (置信度: 0.8000)
总耗时: 9.82秒
succ. pred cate:Collie, true cate:081.Border Collie, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/005.Blenheim_Spaniel/005.Blenheim_Spaniel_n02086646_3986.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/005.Blenheim_Spaniel/005.Blenheim_Spaniel_n02086646_3986.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Blenheim Spaniel, 置信度=0.271, LCB=0.000, 一致性=True, 更新m=False
分类完成: Blenheim Spaniel (置信度: 0.2713)
总耗时: 4.65秒
succ. pred cate:Blenheim Spaniel, true cate:005.Blenheim Spaniel, used_slow:True, confidence:0.2713
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/038.Lakeland_Terrier/038.Lakeland_Terrier_n02095570_4782.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/038.Lakeland_Terrier/038.Lakeland_Terrier_n02095570_4782.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Groenendael, 置信度=0.533, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Kerry Blue Terrier (置信度: 0.8000)
总耗时: 11.04秒
succ. pred cate:Kerry Blue Terrier, true cate:038.Lakeland Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/092.Bull_Mastiff/092.Bull_Mastiff_n02108422_5221.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Bull Mastiff (置信度: 0.7078)
总耗时: 0.02秒
succ. pred cate:Bull Mastiff, true cate:092.Bull Mastiff, used_slow:False, confidence:0.7078
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/104.Newfoundland/104.Newfoundland_n02111277_8856.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/104.Newfoundland/104.Newfoundland_n02111277_8856.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Newfoundland, 置信度=0.359, LCB=0.000, 一致性=True, 更新m=False
分类完成: Newfoundland (置信度: 0.3590)
总耗时: 4.59秒
succ. pred cate:Newfoundland, true cate:104.Newfoundland, used_slow:True, confidence:0.3590
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/076.Kelpie/076.Kelpie_n02105412_5288.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/076.Kelpie/076.Kelpie_n02105412_5288.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Black-and-tan Coonhound, 置信度=0.540, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Black-and-tan Coonhound (置信度: 0.8000)
总耗时: 10.02秒
failed. pred cate:Black-and-tan Coonhound, true cate:076.Kelpie, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/074.Malinois/074.Malinois_n02105162_6106.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/074.Malinois/074.Malinois_n02105162_6106.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Malinois, 置信度=0.624, LCB=0.000, 一致性=True, 更新m=False
分类完成: Malinois (置信度: 0.6240)
总耗时: 4.62秒
succ. pred cate:Malinois, true cate:074.Malinois, used_slow:True, confidence:0.6240
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/052.West_Highland_White_Terrier/052.West_Highland_White_Terrier_n02098286_1632.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/052.West_Highland_White_Terrier/052.West_Highland_White_Terrier_n02098286_1632.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Maltese Dog, 置信度=0.409, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Shetland Sheepdog (置信度: 0.8000)
总耗时: 10.38秒
Processing fast and slow thinking:  87%|████████▋ | 104/120 [12:49<01:55,  7.24s/it]Processing fast and slow thinking:  88%|████████▊ | 105/120 [12:59<02:01,  8.10s/it]Processing fast and slow thinking:  88%|████████▊ | 106/120 [13:09<02:02,  8.72s/it]Processing fast and slow thinking:  89%|████████▉ | 107/120 [13:14<01:37,  7.49s/it]Processing fast and slow thinking:  90%|█████████ | 108/120 [13:24<01:40,  8.37s/it]Processing fast and slow thinking:  91%|█████████ | 109/120 [13:30<01:23,  7.57s/it]Processing fast and slow thinking:  92%|█████████▏| 110/120 [13:39<01:19,  7.94s/it]Processing fast and slow thinking:  92%|█████████▎| 111/120 [13:44<01:04,  7.13s/it]Processing fast and slow thinking:  93%|█████████▎| 112/120 [13:55<01:04,  8.12s/it]Processing fast and slow thinking:  94%|█████████▍| 113/120 [14:05<01:02,  8.91s/it]Processing fast and slow thinking:  95%|█████████▌| 114/120 [14:15<00:55,  9.27s/it]failed. pred cate:Shetland Sheepdog, true cate:052.West Highland White Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/069.Sussex_Spaniel/069.Sussex_Spaniel_n02102480_5703.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/069.Sussex_Spaniel/069.Sussex_Spaniel_n02102480_5703.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Toy Poodle, 置信度=0.575, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Cocker Spaniel (置信度: 0.8000)
总耗时: 10.32秒
succ. pred cate:Cocker Spaniel, true cate:069.Sussex Spaniel, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/091.Boxer/091.Boxer_n02108089_14719.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/091.Boxer/091.Boxer_n02108089_14719.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Boston Bull, 置信度=0.548, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Boxer (置信度: 0.9000)
总耗时: 10.28秒
succ. pred cate:Boxer, true cate:091.Boxer, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/108.Chow/108.Chow_n02112137_14448.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/108.Chow/108.Chow_n02112137_14448.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Chow, 置信度=0.473, LCB=0.000, 一致性=True, 更新m=False
分类完成: Chow (置信度: 0.4730)
总耗时: 4.47秒
succ. pred cate:Chow, true cate:108.Chow, used_slow:True, confidence:0.4730
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/049.Tibetan_Terrier/049.Tibetan_Terrier_n02097474_5841.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/049.Tibetan_Terrier/049.Tibetan_Terrier_n02097474_5841.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Tibetan Terrier, 置信度=0.579, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: West Highland White Terrier (置信度: 0.8000)
总耗时: 10.50秒
succ. pred cate:West Highland White Terrier, true cate:049.Tibetan Terrier, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/056.Golden_Retriever/056.Golden_Retriever_n02099601_3360.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/056.Golden_Retriever/056.Golden_Retriever_n02099601_3360.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Golden Retriever, 置信度=0.575, LCB=0.000, 一致性=True, 更新m=False
分类完成: Golden Retriever (置信度: 0.5750)
总耗时: 5.66秒
succ. pred cate:Golden Retriever, true cate:056.Golden Retriever, used_slow:True, confidence:0.5750
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/097.Eskimo_Dog/097.Eskimo_Dog_n02109961_9973.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/097.Eskimo_Dog/097.Eskimo_Dog_n02109961_9973.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=English Setter, 置信度=0.576, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Siberian Husky (置信度: 0.8000)
总耗时: 8.80秒
failed. pred cate:Siberian Husky, true cate:097.Eskimo Dog, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/001.Japanese_Spaniel/001.Japanese_Spaniel_n02085782_1691.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/001.Japanese_Spaniel/001.Japanese_Spaniel_n02085782_1691.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Japanese Spaniel, 置信度=0.245, LCB=0.000, 一致性=True, 更新m=False
分类完成: Japanese Spaniel (置信度: 0.2450)
总耗时: 5.22秒
succ. pred cate:Japanese Spaniel, true cate:001.Japanese Spaniel, used_slow:True, confidence:0.2450
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/115.Standard_Poodle/115.Standard_Poodle_n02113799_1537.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/115.Standard_Poodle/115.Standard_Poodle_n02113799_1537.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Giant Schnauzer, 置信度=0.551, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Miniature Poodle (置信度: 0.8000)
总耗时: 10.45秒
succ. pred cate:Miniature Poodle, true cate:115.Standard Poodle, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/065.Clumber/065.Clumber_n02101556_4514.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/065.Clumber/065.Clumber_n02101556_4514.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Clumber, 置信度=0.170, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Clumber (置信度: 0.8000)
总耗时: 10.76秒
succ. pred cate:Clumber, true cate:065.Clumber, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/016.English_Foxhound/016.English_Foxhound_n02089973_1907.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/016.English_Foxhound/016.English_Foxhound_n02089973_1907.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=English Springer Spaniel, 置信度=0.516, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: English Foxhound (置信度: 0.8000)
总耗时: 10.10秒
succ. pred cate:English Foxhound, true cate:016.English Foxhound, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/103.Leonberg/103.Leonberg_n02111129_1197.jpg
执行快思考...
快思考结果确定，直接返回...
分类完成: Leonberg (置信度: 0.9518)
总耗时: 0.02秒
succ. pred cate:Leonberg, true cate:103.Leonberg, used_slow:False, confidence:0.9518
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/021.Whippet/021.Whippet_n02091134_15784.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/021.Whippet/021.Whippet_n02091134_15784.jpg
Processing fast and slow thinking:  97%|█████████▋| 116/120 [14:25<00:28,  7.17s/it]Processing fast and slow thinking:  98%|█████████▊| 117/120 [14:37<00:24,  8.27s/it]Processing fast and slow thinking:  98%|█████████▊| 118/120 [14:47<00:17,  8.77s/it]Processing fast and slow thinking:  99%|█████████▉| 119/120 [14:57<00:09,  9.22s/it]Processing fast and slow thinking: 100%|██████████| 120/120 [15:07<00:00,  9.49s/it]Processing fast and slow thinking: 100%|██████████| 120/120 [15:07<00:00,  7.57s/it]
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Italian Greyhound, 置信度=0.553, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Italian Greyhound (置信度: 0.9000)
总耗时: 9.43秒
failed. pred cate:Italian Greyhound, true cate:021.Whippet, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/032.Kerry_Blue_Terrier/032.Kerry_Blue_Terrier_n02093859_393.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/032.Kerry_Blue_Terrier/032.Kerry_Blue_Terrier_n02093859_393.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Dandi Dinmont, 置信度=0.561, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Kerry Blue Terrier (置信度: 0.7500)
总耗时: 11.59秒
succ. pred cate:Kerry Blue Terrier, true cate:032.Kerry Blue Terrier, used_slow:True, confidence:0.7500
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/055.Curly_coater_Retriever/055.Curly_coater_Retriever_n02099429_618.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/055.Curly_coater_Retriever/055.Curly_coater_Retriever_n02099429_618.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Bedlington Terrier, 置信度=0.566, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Curly-coated Retriever (置信度: 0.9000)
总耗时: 10.21秒
succ. pred cate:Curly-coated Retriever, true cate:055.Curly coater Retriever, used_slow:True, confidence:0.9000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/054.Flat_coated_Retriever/054.Flat_coated_Retriever_n02099267_5540.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/054.Flat_coated_Retriever/054.Flat_coated_Retriever_n02099267_5540.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=English Springer Spaniel, 置信度=0.553, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Flat-coated Retriever (置信度: 0.8000)
总耗时: 10.41秒
succ. pred cate:Flat-coated Retriever, true cate:054.Flat coated Retriever, used_slow:True, confidence:0.8000
开始分类图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/093.Tibetan_Mastiff/093.Tibetan_Mastiff_n02108551_7523.jpg
执行快思考...
快思考结果不确定，执行慢思考...
开始优化后的慢思考流程，查询图像: /data/yjx/MLLM/UniFGVR/datasets/dogs_120/images_discovery_all_1/093.Tibetan_Mastiff/093.Tibetan_Mastiff_n02108551_7523.jpg
步骤1: 执行增强检索...
步骤2: 使用MLLM进行最终推理...
统计更新: 类别=Bernese Mountain Dog, 置信度=0.454, LCB=0.500, 一致性=False, 更新m=False
快慢思考结果不一致，进行最终融合决策...
分类完成: Bernese Mountain Dog (置信度: 0.9000)
总耗时: 10.19秒
failed. pred cate:Bernese Mountain Dog, true cate:093.Tibetan Mastiff, used_slow:True, confidence:0.9000
✅ 正确预测总数: 90
  - 其中仅快思考正确: 10
  - 其中慢思考触发且正确: 80
❌ 错误预测总数: 30
📊 慢思考触发数量: 110
[fast and slow] 总体准确率: 0.7500 (90/120)
[fast and slow] 快思考准确率: 1.0000
[fast and slow] 慢思考触发比例: 0.9167
[fast and slow] 慢思考准确率: 0.7273
